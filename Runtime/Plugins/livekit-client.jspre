(function(){var __webpack_modules__={4537:function(e){"use strict";e.exports=function asPromise(e,t){var i=new Array(arguments.length-1),n=0,a=2,o=!0;for(;a<arguments.length;)i[n++]=arguments[a++];return new Promise((function executor(a,s){i[n]=function callback(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),i=0;i<t.length;)t[i++]=arguments[i];a.apply(null,t)}};try{e.apply(t||null,i)}catch(e){o&&(o=!1,s(e))}}))}},7419:function(e,t){"use strict";var i=t;i.length=function length(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var n=new Array(64),a=new Array(123),o=0;o<64;)a[n[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;i.encode=function encode(e,t,i){for(var a,o=null,s=[],c=0,u=0;t<i;){var l=e[t++];switch(u){case 0:s[c++]=n[l>>2],a=(3&l)<<4,u=1;break;case 1:s[c++]=n[a|l>>4],a=(15&l)<<2,u=2;break;case 2:s[c++]=n[a|l>>6],s[c++]=n[63&l],u=0}c>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),c=0)}return u&&(s[c++]=n[a],s[c++]=61,1===u&&(s[c++]=61)),o?(c&&o.push(String.fromCharCode.apply(String,s.slice(0,c))),o.join("")):String.fromCharCode.apply(String,s.slice(0,c))};var s="invalid encoding";i.decode=function decode(e,t,i){for(var n,o=i,c=0,u=0;u<e.length;){var l=e.charCodeAt(u++);if(61===l&&c>1)break;if(void 0===(l=a[l]))throw Error(s);switch(c){case 0:n=l,c=1;break;case 1:t[i++]=n<<2|(48&l)>>4,n=l,c=2;break;case 2:t[i++]=(15&n)<<4|(60&l)>>2,n=l,c=3;break;case 3:t[i++]=(3&n)<<6|l,c=0}}if(1===c)throw Error(s);return i-o},i.test=function test(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},9211:function(e){"use strict";function EventEmitter(){this._listeners={}}e.exports=EventEmitter,EventEmitter.prototype.on=function on(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},EventEmitter.prototype.off=function off(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this},EventEmitter.prototype.emit=function emit(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}},945:function(e){"use strict";function factory(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),i=new Uint8Array(t.buffer),n=128===i[3];function writeFloat_f32_cpy(e,n,a){t[0]=e,n[a]=i[0],n[a+1]=i[1],n[a+2]=i[2],n[a+3]=i[3]}function writeFloat_f32_rev(e,n,a){t[0]=e,n[a]=i[3],n[a+1]=i[2],n[a+2]=i[1],n[a+3]=i[0]}function readFloat_f32_cpy(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],t[0]}function readFloat_f32_rev(e,n){return i[3]=e[n],i[2]=e[n+1],i[1]=e[n+2],i[0]=e[n+3],t[0]}e.writeFloatLE=n?writeFloat_f32_cpy:writeFloat_f32_rev,e.writeFloatBE=n?writeFloat_f32_rev:writeFloat_f32_cpy,e.readFloatLE=n?readFloat_f32_cpy:readFloat_f32_rev,e.readFloatBE=n?readFloat_f32_rev:readFloat_f32_cpy}():function(){function writeFloat_ieee754(e,t,i,n){var a=t<0?1:0;if(a&&(t=-t),0===t)e(1/t>0?0:2147483648,i,n);else if(isNaN(t))e(2143289344,i,n);else if(t>34028234663852886e22)e((a<<31|2139095040)>>>0,i,n);else if(t<11754943508222875e-54)e((a<<31|Math.round(t/1401298464324817e-60))>>>0,i,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((a<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,i,n)}}function readFloat_ieee754(e,t,i){var n=e(t,i),a=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:a*(1/0):0===o?1401298464324817e-60*a*s:a*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=writeFloat_ieee754.bind(null,writeUintLE),e.writeFloatBE=writeFloat_ieee754.bind(null,writeUintBE),e.readFloatLE=readFloat_ieee754.bind(null,readUintLE),e.readFloatBE=readFloat_ieee754.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),i=new Uint8Array(t.buffer),n=128===i[7];function writeDouble_f64_cpy(e,n,a){t[0]=e,n[a]=i[0],n[a+1]=i[1],n[a+2]=i[2],n[a+3]=i[3],n[a+4]=i[4],n[a+5]=i[5],n[a+6]=i[6],n[a+7]=i[7]}function writeDouble_f64_rev(e,n,a){t[0]=e,n[a]=i[7],n[a+1]=i[6],n[a+2]=i[5],n[a+3]=i[4],n[a+4]=i[3],n[a+5]=i[2],n[a+6]=i[1],n[a+7]=i[0]}function readDouble_f64_cpy(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],i[4]=e[n+4],i[5]=e[n+5],i[6]=e[n+6],i[7]=e[n+7],t[0]}function readDouble_f64_rev(e,n){return i[7]=e[n],i[6]=e[n+1],i[5]=e[n+2],i[4]=e[n+3],i[3]=e[n+4],i[2]=e[n+5],i[1]=e[n+6],i[0]=e[n+7],t[0]}e.writeDoubleLE=n?writeDouble_f64_cpy:writeDouble_f64_rev,e.writeDoubleBE=n?writeDouble_f64_rev:writeDouble_f64_cpy,e.readDoubleLE=n?readDouble_f64_cpy:readDouble_f64_rev,e.readDoubleBE=n?readDouble_f64_rev:readDouble_f64_cpy}():function(){function writeDouble_ieee754(e,t,i,n,a,o){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,a,o+t),e(1/n>0?0:2147483648,a,o+i);else if(isNaN(n))e(0,a,o+t),e(2146959360,a,o+i);else if(n>17976931348623157e292)e(0,a,o+t),e((s<<31|2146435072)>>>0,a,o+i);else{var c;if(n<22250738585072014e-324)e((c=n/5e-324)>>>0,a,o+t),e((s<<31|c/4294967296)>>>0,a,o+i);else{var u=Math.floor(Math.log(n)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(c=n*Math.pow(2,-u))>>>0,a,o+t),e((s<<31|u+1023<<20|1048576*c&1048575)>>>0,a,o+i)}}}function readDouble_ieee754(e,t,i,n,a){var o=e(n,a+t),s=e(n,a+i),c=2*(s>>31)+1,u=s>>>20&2047,l=4294967296*(1048575&s)+o;return 2047===u?l?NaN:c*(1/0):0===u?5e-324*c*l:c*Math.pow(2,u-1075)*(l+4503599627370496)}e.writeDoubleLE=writeDouble_ieee754.bind(null,writeUintLE,0,4),e.writeDoubleBE=writeDouble_ieee754.bind(null,writeUintBE,4,0),e.readDoubleLE=readDouble_ieee754.bind(null,readUintLE,0,4),e.readDoubleBE=readDouble_ieee754.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}function writeUintBE(e,t,i){t[i]=e>>>24,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=factory(factory)},7199:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},6662:function(e){"use strict";e.exports=function pool(e,t,i){var n=i||8192,a=n>>>1,o=null,s=n;return function pool_alloc(i){if(i<1||i>a)return e(i);s+i>n&&(o=e(n),s=0);var c=t.call(o,s,s+=i);return 7&s&&(s=1+(7|s)),c}}},4997:function(e,t){"use strict";var i=t;i.length=function utf8_length(e){for(var t=0,i=0,n=0;n<e.length;++n)(i=e.charCodeAt(n))<128?t+=1:i<2048?t+=2:55296==(64512&i)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},i.read=function utf8_read(e,t,i){if(i-t<1)return"";for(var n,a=null,o=[],s=0;t<i;)(n=e[t++])<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,o)),s=0);return a?(s&&a.push(String.fromCharCode.apply(String,o.slice(0,s))),a.join("")):String.fromCharCode.apply(String,o.slice(0,s))},i.write=function utf8_write(e,t,i){for(var n,a,o=i,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[i++]=n:n<2048?(t[i++]=n>>6|192,t[i++]=63&n|128):55296==(64512&n)&&56320==(64512&(a=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&a),++s,t[i++]=n>>18|240,t[i++]=n>>12&63|128,t[i++]=n>>6&63|128,t[i++]=63&n|128):(t[i++]=n>>12|224,t[i++]=n>>6&63|128,t[i++]=63&n|128);return i-o}},7187:function(e){"use strict";var t,i="object"==typeof Reflect?Reflect:null,n=i&&"function"==typeof i.apply?i.apply:function ReflectApply(e,t,i){return Function.prototype.apply.call(e,t,i)};t=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function ReflectOwnKeys(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function ReflectOwnKeys(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function NumberIsNaN(e){return e!=e};function EventEmitter(){EventEmitter.init.call(this)}e.exports=EventEmitter,e.exports.once=function once(e,t){return new Promise((function(i,n){function errorListener(i){e.removeListener(t,resolver),n(i)}function resolver(){"function"==typeof e.removeListener&&e.removeListener("error",errorListener),i([].slice.call(arguments))}eventTargetAgnosticAddListener(e,t,resolver,{once:!0}),"error"!==t&&function addErrorHandlerIfEventEmitter(e,t,i){"function"==typeof e.on&&eventTargetAgnosticAddListener(e,"error",t,i)}(e,errorListener,{once:!0})}))},EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var o=10;function checkListener(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function _getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function _addListener(e,t,i,n){var a,o,s;if(checkListener(i),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),o=e._events),s=o[t]),void 0===s)s=o[t]=i,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[i,s]:[s,i]:n?s.unshift(i):s.push(i),(a=_getMaxListeners(e))>0&&s.length>a&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,function ProcessEmitWarning(e){console&&console.warn&&console.warn(e)}(c)}return e}function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},a=onceWrapper.bind(n);return a.listener=i,n.wrapFn=a,a}function _listeners(e,t,i){var n=e._events;if(void 0===n)return[];var a=n[t];return void 0===a?[]:"function"==typeof a?i?[a.listener||a]:[a]:i?function unwrapListeners(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(a):arrayClone(a,a.length)}function listenerCount(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function arrayClone(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function eventTargetAgnosticAddListener(e,t,i,n){if("function"==typeof e.on)n.once?e.once(t,i):e.on(t,i);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function wrapListener(a){n.once&&e.removeEventListener(t,wrapListener),i(a)}))}}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function setMaxListeners(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},EventEmitter.prototype.getMaxListeners=function getMaxListeners(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function emit(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var a="error"===e,o=this._events;if(void 0!==o)a=a&&void 0===o.error;else if(!a)return!1;if(a){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var c=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw c.context=s,c}var u=o[e];if(void 0===u)return!1;if("function"==typeof u)n(u,this,t);else{var l=u.length,p=arrayClone(u,l);for(i=0;i<l;++i)n(p[i],this,t)}return!0},EventEmitter.prototype.addListener=function addListener(e,t){return _addListener(this,e,t,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function prependListener(e,t){return _addListener(this,e,t,!0)},EventEmitter.prototype.once=function once(e,t){return checkListener(t),this.on(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.prependOnceListener=function prependOnceListener(e,t){return checkListener(t),this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.removeListener=function removeListener(e,t){var i,n,a,o,s;if(checkListener(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(a=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){s=i[o].listener,a=o;break}if(a<0)return this;0===a?i.shift():function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,a),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function removeAllListeners(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var a,o=Object.keys(i);for(n=0;n<o.length;++n)"removeListener"!==(a=o[n])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},EventEmitter.prototype.listeners=function listeners(e){return _listeners(this,e,!0)},EventEmitter.prototype.rawListeners=function rawListeners(e){return _listeners(this,e,!1)},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function eventNames(){return this._eventsCount>0?t(this._events):[]}},4823:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=a(i(2662));t.default=class Queue{constructor(){this.queue=[],this.running=!1}enqueue(e){o.default.trace("enqueuing request to fire later"),this.queue.push(e)}dequeue(){const e=this.queue.shift();e&&e(),o.default.trace("firing request from queue")}run(){return n(this,void 0,void 0,(function*(){if(!this.running){for(o.default.trace("start queue"),this.running=!0;this.running&&this.queue.length>0;)this.dequeue();this.running=!1,o.default.trace("queue finished")}}))}pause(){o.default.trace("pausing queue"),this.running=!1}reset(){o.default.trace("resetting queue"),this.running=!1,this.queue=[]}isRunning(){return this.running}isEmpty(){return 0===this.queue.length}}},9286:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},s=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toProtoSessionDescription=t.SignalClient=void 0;const u=c(i(2662)),l=i(4658),p=i(7650),h=i(1981),m=c(i(4823));h.isWeb()&&Promise.resolve().then((()=>o(i(835))));const v=["syncState","trickle","offer","answer","simulate","leave"];function fromProtoSessionDescription(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function toProtoSessionDescription(e){return{sdp:e.sdp,type:e.type}}t.SignalClient=class SignalClient{constructor(e=!1){this.isConnected=!1,this.isReconnecting=!1,this.useJSON=e,this.requestQueue=new m.default}join(e,t,i){return s(this,void 0,void 0,(function*(){this.isConnected=!1;return yield this.connect(e,t,{autoSubscribe:null==i?void 0:i.autoSubscribe,publishOnly:null==i?void 0:i.publishOnly})}))}reconnect(e,t){return s(this,void 0,void 0,(function*(){this.isReconnecting=!0,yield this.connect(e,t,{reconnect:!0})}))}connect(e,t,i){e.startsWith("http")&&(e=e.replace("http","ws")),e=e.replace(/\/$/,""),e+="/rtc";const n=function createConnectionParams(e,t,i){const n=new URLSearchParams;n.set("access_token",e),(null==i?void 0:i.reconnect)&&n.set("reconnect","1");void 0!==(null==i?void 0:i.autoSubscribe)&&n.set("auto_subscribe",i.autoSubscribe?"1":"0");n.set("sdk","js"),n.set("version",t.version),n.set("protocol",t.protocol.toString()),t.deviceModel&&n.set("device_model",t.deviceModel);t.os&&n.set("os",t.os);t.osVersion&&n.set("os_version",t.osVersion);t.browser&&n.set("browser",t.browser);t.browserVersion&&n.set("browser_version",t.browserVersion);void 0!==(null==i?void 0:i.publishOnly)&&n.set("publish",i.publishOnly);return`?${n.toString()}`}(t,h.getClientInfo(),i);return new Promise(((t,a)=>{u.default.debug("connecting to",e+n),this.ws=void 0;const o=new WebSocket(e+n);o.binaryType="arraybuffer",o.onerror=t=>s(this,void 0,void 0,(function*(){if(this.ws)this.handleWSError(t);else try{const t=yield fetch(`http${e.substring(2)}/validate${n}`);if(t.ok)a(new p.ConnectionError("Internal error"));else{const e=yield t.text();a(new p.ConnectionError(e))}}catch(e){a(new p.ConnectionError("server was not reachable"))}})),o.onopen=()=>{this.ws=o,i.reconnect&&(this.isConnected=!0,t())},o.onmessage=e=>s(this,void 0,void 0,(function*(){let i;if("string"==typeof e.data){const t=JSON.parse(e.data);i=l.SignalResponse.fromJSON(t)}else{if(!(e.data instanceof ArrayBuffer))return void u.default.error("could not decode websocket message",typeof e.data);i=l.SignalResponse.decode(new Uint8Array(e.data))}this.isConnected?(this.signalLatency&&(yield h.sleep(this.signalLatency)),this.handleSignalResponse(i)):i.join?(this.isConnected=!0,t(i.join)):a(new p.ConnectionError("did not receive join response"))})),o.onclose=e=>{this.isConnected&&this.ws===o&&(u.default.debug("websocket connection closed",e.reason),this.isConnected=!1,this.onClose&&this.onClose(e.reason),this.ws===o&&(this.ws=void 0))}}))}close(){var e;this.isConnected=!1,this.ws&&(this.ws.onclose=null),null===(e=this.ws)||void 0===e||e.close(),this.ws=void 0}sendOffer(e){u.default.debug("sending offer",e),this.sendRequest({offer:toProtoSessionDescription(e)})}sendAnswer(e){u.default.debug("sending answer"),this.sendRequest({answer:toProtoSessionDescription(e)})}sendIceCandidate(e,t){u.default.trace("sending ice candidate",e),this.sendRequest({trickle:{candidateInit:JSON.stringify(e),target:t}})}sendMuteTrack(e,t){this.sendRequest({mute:{sid:e,muted:t}})}sendAddTrack(e){this.sendRequest({addTrack:l.AddTrackRequest.fromPartial(e)})}sendUpdateTrackSettings(e){this.sendRequest({trackSetting:e})}sendUpdateSubscription(e){this.sendRequest({subscription:e})}sendSyncState(e){this.sendRequest({syncState:e})}sendUpdateVideoLayers(e,t){this.sendRequest({updateLayers:{trackSid:e,layers:t}})}sendUpdateSubscriptionPermissions(e,t){this.sendRequest({subscriptionPermission:{allParticipants:e,trackPermissions:t}})}sendSimulateScenario(e){this.sendRequest({simulate:e})}sendLeave(){this.sendRequest(l.SignalRequest.fromPartial({leave:{}}))}sendRequest(e,t=!1){return s(this,void 0,void 0,(function*(){const i=!t&&!function canPassThroughQueue(e){const t=void 0!==Object.keys(e).find((e=>v.includes(e)));return u.default.trace("request allowed to bypass queue:",t,e),t}(e);if(!i||!this.isReconnecting&&this.requestQueue.isEmpty())if(this.signalLatency&&(yield h.sleep(this.signalLatency)),this.ws)try{this.useJSON?this.ws.send(JSON.stringify(l.SignalRequest.toJSON(e))):this.ws.send(l.SignalRequest.encode(e).finish())}catch(e){u.default.error("error sending signal message",e)}else u.default.error("cannot send signal request before connected");else this.requestQueue.enqueue((()=>this.sendRequest(e,!0)))}))}handleSignalResponse(e){if(e.answer){const t=fromProtoSessionDescription(e.answer);this.onAnswer&&this.onAnswer(t)}else if(e.offer){const t=fromProtoSessionDescription(e.offer);this.onOffer&&this.onOffer(t)}else if(e.trickle){const t=JSON.parse(e.trickle.candidateInit);this.onTrickle&&this.onTrickle(t,e.trickle.target)}else e.update?this.onParticipantUpdate&&this.onParticipantUpdate(e.update.participants):e.trackPublished?this.onLocalTrackPublished&&this.onLocalTrackPublished(e.trackPublished):e.speakersChanged?this.onSpeakersChanged&&this.onSpeakersChanged(e.speakersChanged.speakers):e.leave?this.onLeave&&this.onLeave(e.leave):e.mute?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(e.mute.sid,e.mute.muted):e.roomUpdate?this.onRoomUpdate&&this.onRoomUpdate(e.roomUpdate.room):e.connectionQuality?this.onConnectionQuality&&this.onConnectionQuality(e.connectionQuality):e.streamStateUpdate?this.onStreamStateUpdate&&this.onStreamStateUpdate(e.streamStateUpdate):e.subscribedQualityUpdate?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(e.subscribedQualityUpdate):e.subscriptionPermissionUpdate?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(e.subscriptionPermissionUpdate):e.refreshToken?this.onTokenRefresh&&this.onTokenRefresh(e.refreshToken):e.trackUnpublished?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(e.trackUnpublished):u.default.debug("unsupported message",e)}setReconnected(){this.isReconnecting=!1,this.requestQueue.run()}handleWSError(e){u.default.error("websocket error",e)}},t.toProtoSessionDescription=toProtoSessionDescription},2011:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},s=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.connect=t.version=void 0;const u=o(i(2662)),l=i(7650),p=i(8911),h=c(i(3258));var m=i(6942);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return m.version}}),t.connect=function connect(e,t,i){var n,a,o,c;return s(this,void 0,void 0,(function*(){null!=i||(i={}),void 0===i.adaptiveStream&&(i.adaptiveStream=!0===i.autoManageVideo?{}:void 0),u.setLogLevel(null!==(n=i.logLevel)&&void 0!==n?n:u.LogLevel.warn);const m=null!==(a=i.rtcConfig)&&void 0!==a?a:{};i.iceServers&&(m.iceServers=i.iceServers);const v=new h.default(i);yield v.connect(e,t,i);const g=null!==(o=i.audio)&&void 0!==o&&o,b=null!==(c=i.video)&&void 0!==c&&c;return(g||b)&&setTimeout((()=>s(this,void 0,void 0,(function*(){let e;if(g&&b)try{yield v.localParticipant.enableCameraAndMicrophone()}catch(t){const i=l.MediaDeviceFailure.getFailure(t);if(u.default.warn("received error while creating media",i),t instanceof Error&&u.default.warn(t.message),i===l.MediaDeviceFailure.NotFound||i===l.MediaDeviceFailure.DeviceInUse)try{yield v.localParticipant.setMicrophoneEnabled(!0)}catch(t){e=t}else e=t}else if(g)try{yield v.localParticipant.setMicrophoneEnabled(!0)}catch(t){e=t}else if(b)try{yield v.localParticipant.setCameraEnabled(!0)}catch(t){e=t}e&&(v.emit(p.RoomEvent.MediaDevicesError,e),u.default.error("could not create media",e))})))),v}))}},8219:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},s=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionQuality=t.VideoQuality=t.TrackPublication=t.RemoteTrackPublication=t.RemoteVideoTrack=t.RemoteAudioTrack=t.RemoteTrack=t.LocalTrackPublication=t.LocalTrack=t.LocalVideoTrack=t.LocalAudioTrack=t.LocalParticipant=t.RemoteParticipant=t.Participant=t.DataPacket_Kind=t.RoomState=t.Room=t.setLogLevel=void 0;const u=i(2662);Object.defineProperty(t,"setLogLevel",{enumerable:!0,get:function(){return u.setLogLevel}});const l=i(8983);Object.defineProperty(t,"DataPacket_Kind",{enumerable:!0,get:function(){return l.DataPacket_Kind}}),Object.defineProperty(t,"VideoQuality",{enumerable:!0,get:function(){return l.VideoQuality}});const p=c(i(4149));t.LocalParticipant=p.default;const h=o(i(2070));t.Participant=h.default,Object.defineProperty(t,"ConnectionQuality",{enumerable:!0,get:function(){return h.ConnectionQuality}});const m=c(i(1488));t.RemoteParticipant=m.default;const v=o(i(3258));t.Room=v.default,Object.defineProperty(t,"RoomState",{enumerable:!0,get:function(){return v.RoomState}});const g=c(i(8669));t.LocalAudioTrack=g.default;const b=c(i(5728));t.LocalTrack=b.default;const k=c(i(170));t.LocalTrackPublication=k.default;const S=c(i(6887));t.LocalVideoTrack=S.default;const y=c(i(5941));t.RemoteAudioTrack=y.default;const T=c(i(5785));t.RemoteTrack=T.default;const P=c(i(297));t.RemoteTrackPublication=P.default;const C=c(i(466));t.RemoteVideoTrack=C.default;const w=i(2184);Object.defineProperty(t,"TrackPublication",{enumerable:!0,get:function(){return w.TrackPublication}}),s(i(2011),t),s(i(4797),t),s(i(7650),t),s(i(8911),t),s(i(119),t),s(i(6669),t),s(i(410),t),s(i(5884),t),s(i(6942),t)},2662:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setLogLevel=t.LogLevel=void 0;const a=n(i(2043));var o;!function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.silent="silent"}(o=t.LogLevel||(t.LogLevel={}));const s=a.default.getLogger("livekit");s.setLevel(o.info),t.default=s,t.setLogLevel=function setLogLevel(e){s.setLevel(e)}},4797:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1609:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Timestamp=t.protobufPackage=void 0;const a=n(i(3720)),o=n(i(2100));t.protobufPackage="google.protobuf";const s={seconds:0,nanos:0};t.Timestamp={encode:(e,t=o.default.Writer.create())=>(0!==e.seconds&&t.uint32(8).int64(e.seconds),0!==e.nanos&&t.uint32(16).int32(e.nanos),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},s);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.seconds=longToNumber(i.int64());break;case 2:a.nanos=i.int32();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},s);return void 0!==e.seconds&&null!==e.seconds?t.seconds=Number(e.seconds):t.seconds=0,void 0!==e.nanos&&null!==e.nanos?t.nanos=Number(e.nanos):t.nanos=0,t},toJSON(e){const t={};return void 0!==e.seconds&&(t.seconds=e.seconds),void 0!==e.nanos&&(t.nanos=e.nanos),t},fromPartial(e){var t,i;const n=Object.assign({},s);return n.seconds=null!==(t=e.seconds)&&void 0!==t?t:0,n.nanos=null!==(i=e.nanos)&&void 0!==i?i:0,n}};var c=(()=>{if(void 0!==c)return c;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==i.g)return i.g;throw"Unable to locate global object"})();function longToNumber(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new c.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}o.default.util.Long!==a.default&&(o.default.util.Long=a.default,o.default.configure())},8983:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RTPStats_GapHistogramEntry=t.RTPStats=t.VideoConfiguration=t.ClientConfiguration=t.ClientInfo=t.ParticipantTracks=t.UserPacket=t.SpeakerInfo=t.ActiveSpeakerUpdate=t.DataPacket=t.VideoLayer=t.TrackInfo=t.ParticipantInfo=t.ParticipantPermission=t.Codec=t.Room=t.clientInfo_SDKToJSON=t.clientInfo_SDKFromJSON=t.ClientInfo_SDK=t.dataPacket_KindToJSON=t.dataPacket_KindFromJSON=t.DataPacket_Kind=t.participantInfo_StateToJSON=t.participantInfo_StateFromJSON=t.ParticipantInfo_State=t.clientConfigSettingToJSON=t.clientConfigSettingFromJSON=t.ClientConfigSetting=t.connectionQualityToJSON=t.connectionQualityFromJSON=t.ConnectionQuality=t.videoQualityToJSON=t.videoQualityFromJSON=t.VideoQuality=t.trackSourceToJSON=t.trackSourceFromJSON=t.TrackSource=t.trackTypeToJSON=t.trackTypeFromJSON=t.TrackType=t.protobufPackage=void 0;const a=n(i(3720)),o=n(i(2100)),s=i(1609);var c,u,l,p,h,m,v,g;function trackTypeFromJSON(e){switch(e){case 0:case"AUDIO":return c.AUDIO;case 1:case"VIDEO":return c.VIDEO;case 2:case"DATA":return c.DATA;default:return c.UNRECOGNIZED}}function trackTypeToJSON(e){switch(e){case c.AUDIO:return"AUDIO";case c.VIDEO:return"VIDEO";case c.DATA:return"DATA";default:return"UNKNOWN"}}function trackSourceFromJSON(e){switch(e){case 0:case"UNKNOWN":return u.UNKNOWN;case 1:case"CAMERA":return u.CAMERA;case 2:case"MICROPHONE":return u.MICROPHONE;case 3:case"SCREEN_SHARE":return u.SCREEN_SHARE;case 4:case"SCREEN_SHARE_AUDIO":return u.SCREEN_SHARE_AUDIO;default:return u.UNRECOGNIZED}}function trackSourceToJSON(e){switch(e){case u.UNKNOWN:return"UNKNOWN";case u.CAMERA:return"CAMERA";case u.MICROPHONE:return"MICROPHONE";case u.SCREEN_SHARE:return"SCREEN_SHARE";case u.SCREEN_SHARE_AUDIO:return"SCREEN_SHARE_AUDIO";default:return"UNKNOWN"}}function videoQualityFromJSON(e){switch(e){case 0:case"LOW":return l.LOW;case 1:case"MEDIUM":return l.MEDIUM;case 2:case"HIGH":return l.HIGH;case 3:case"OFF":return l.OFF;default:return l.UNRECOGNIZED}}function videoQualityToJSON(e){switch(e){case l.LOW:return"LOW";case l.MEDIUM:return"MEDIUM";case l.HIGH:return"HIGH";case l.OFF:return"OFF";default:return"UNKNOWN"}}function clientConfigSettingFromJSON(e){switch(e){case 0:case"UNSET":return h.UNSET;case 1:case"DISABLED":return h.DISABLED;case 2:case"ENABLED":return h.ENABLED;default:return h.UNRECOGNIZED}}function clientConfigSettingToJSON(e){switch(e){case h.UNSET:return"UNSET";case h.DISABLED:return"DISABLED";case h.ENABLED:return"ENABLED";default:return"UNKNOWN"}}function participantInfo_StateFromJSON(e){switch(e){case 0:case"JOINING":return m.JOINING;case 1:case"JOINED":return m.JOINED;case 2:case"ACTIVE":return m.ACTIVE;case 3:case"DISCONNECTED":return m.DISCONNECTED;default:return m.UNRECOGNIZED}}function participantInfo_StateToJSON(e){switch(e){case m.JOINING:return"JOINING";case m.JOINED:return"JOINED";case m.ACTIVE:return"ACTIVE";case m.DISCONNECTED:return"DISCONNECTED";default:return"UNKNOWN"}}function dataPacket_KindFromJSON(e){switch(e){case 0:case"RELIABLE":return v.RELIABLE;case 1:case"LOSSY":return v.LOSSY;default:return v.UNRECOGNIZED}}function dataPacket_KindToJSON(e){switch(e){case v.RELIABLE:return"RELIABLE";case v.LOSSY:return"LOSSY";default:return"UNKNOWN"}}function clientInfo_SDKFromJSON(e){switch(e){case 0:case"UNKNOWN":return g.UNKNOWN;case 1:case"JS":return g.JS;case 2:case"SWIFT":return g.SWIFT;case 3:case"ANDROID":return g.ANDROID;case 4:case"FLUTTER":return g.FLUTTER;case 5:case"GO":return g.GO;case 6:case"UNITY":return g.UNITY;default:return g.UNRECOGNIZED}}function clientInfo_SDKToJSON(e){switch(e){case g.UNKNOWN:return"UNKNOWN";case g.JS:return"JS";case g.SWIFT:return"SWIFT";case g.ANDROID:return"ANDROID";case g.FLUTTER:return"FLUTTER";case g.GO:return"GO";case g.UNITY:return"UNITY";default:return"UNKNOWN"}}t.protobufPackage="livekit",function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO",e[e.DATA=2]="DATA",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(c=t.TrackType||(t.TrackType={})),t.trackTypeFromJSON=trackTypeFromJSON,t.trackTypeToJSON=trackTypeToJSON,function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CAMERA=1]="CAMERA",e[e.MICROPHONE=2]="MICROPHONE",e[e.SCREEN_SHARE=3]="SCREEN_SHARE",e[e.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(u=t.TrackSource||(t.TrackSource={})),t.trackSourceFromJSON=trackSourceFromJSON,t.trackSourceToJSON=trackSourceToJSON,function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e[e.OFF=3]="OFF",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(l=t.VideoQuality||(t.VideoQuality={})),t.videoQualityFromJSON=videoQualityFromJSON,t.videoQualityToJSON=videoQualityToJSON,function(e){e[e.POOR=0]="POOR",e[e.GOOD=1]="GOOD",e[e.EXCELLENT=2]="EXCELLENT",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(p=t.ConnectionQuality||(t.ConnectionQuality={})),t.connectionQualityFromJSON=function connectionQualityFromJSON(e){switch(e){case 0:case"POOR":return p.POOR;case 1:case"GOOD":return p.GOOD;case 2:case"EXCELLENT":return p.EXCELLENT;default:return p.UNRECOGNIZED}},t.connectionQualityToJSON=function connectionQualityToJSON(e){switch(e){case p.POOR:return"POOR";case p.GOOD:return"GOOD";case p.EXCELLENT:return"EXCELLENT";default:return"UNKNOWN"}},function(e){e[e.UNSET=0]="UNSET",e[e.DISABLED=1]="DISABLED",e[e.ENABLED=2]="ENABLED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(h=t.ClientConfigSetting||(t.ClientConfigSetting={})),t.clientConfigSettingFromJSON=clientConfigSettingFromJSON,t.clientConfigSettingToJSON=clientConfigSettingToJSON,function(e){e[e.JOINING=0]="JOINING",e[e.JOINED=1]="JOINED",e[e.ACTIVE=2]="ACTIVE",e[e.DISCONNECTED=3]="DISCONNECTED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(m=t.ParticipantInfo_State||(t.ParticipantInfo_State={})),t.participantInfo_StateFromJSON=participantInfo_StateFromJSON,t.participantInfo_StateToJSON=participantInfo_StateToJSON,function(e){e[e.RELIABLE=0]="RELIABLE",e[e.LOSSY=1]="LOSSY",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(v=t.DataPacket_Kind||(t.DataPacket_Kind={})),t.dataPacket_KindFromJSON=dataPacket_KindFromJSON,t.dataPacket_KindToJSON=dataPacket_KindToJSON,function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JS=1]="JS",e[e.SWIFT=2]="SWIFT",e[e.ANDROID=3]="ANDROID",e[e.FLUTTER=4]="FLUTTER",e[e.GO=5]="GO",e[e.UNITY=6]="UNITY",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(g=t.ClientInfo_SDK||(t.ClientInfo_SDK={})),t.clientInfo_SDKFromJSON=clientInfo_SDKFromJSON,t.clientInfo_SDKToJSON=clientInfo_SDKToJSON;const b={sid:"",name:"",emptyTimeout:0,maxParticipants:0,creationTime:0,turnPassword:"",metadata:"",numParticipants:0,activeRecording:!1};t.Room={encode(e,i=o.default.Writer.create()){""!==e.sid&&i.uint32(10).string(e.sid),""!==e.name&&i.uint32(18).string(e.name),0!==e.emptyTimeout&&i.uint32(24).uint32(e.emptyTimeout),0!==e.maxParticipants&&i.uint32(32).uint32(e.maxParticipants),0!==e.creationTime&&i.uint32(40).int64(e.creationTime),""!==e.turnPassword&&i.uint32(50).string(e.turnPassword);for(const n of e.enabledCodecs)t.Codec.encode(n,i.uint32(58).fork()).ldelim();return""!==e.metadata&&i.uint32(66).string(e.metadata),0!==e.numParticipants&&i.uint32(72).uint32(e.numParticipants),!0===e.activeRecording&&i.uint32(80).bool(e.activeRecording),i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},b);for(s.enabledCodecs=[];n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:s.sid=n.string();break;case 2:s.name=n.string();break;case 3:s.emptyTimeout=n.uint32();break;case 4:s.maxParticipants=n.uint32();break;case 5:s.creationTime=longToNumber(n.int64());break;case 6:s.turnPassword=n.string();break;case 7:s.enabledCodecs.push(t.Codec.decode(n,n.uint32()));break;case 8:s.metadata=n.string();break;case 9:s.numParticipants=n.uint32();break;case 10:s.activeRecording=n.bool();break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},b);if(i.enabledCodecs=[],void 0!==e.sid&&null!==e.sid?i.sid=String(e.sid):i.sid="",void 0!==e.name&&null!==e.name?i.name=String(e.name):i.name="",void 0!==e.emptyTimeout&&null!==e.emptyTimeout?i.emptyTimeout=Number(e.emptyTimeout):i.emptyTimeout=0,void 0!==e.maxParticipants&&null!==e.maxParticipants?i.maxParticipants=Number(e.maxParticipants):i.maxParticipants=0,void 0!==e.creationTime&&null!==e.creationTime?i.creationTime=Number(e.creationTime):i.creationTime=0,void 0!==e.turnPassword&&null!==e.turnPassword?i.turnPassword=String(e.turnPassword):i.turnPassword="",void 0!==e.enabledCodecs&&null!==e.enabledCodecs)for(const n of e.enabledCodecs)i.enabledCodecs.push(t.Codec.fromJSON(n));return void 0!==e.metadata&&null!==e.metadata?i.metadata=String(e.metadata):i.metadata="",void 0!==e.numParticipants&&null!==e.numParticipants?i.numParticipants=Number(e.numParticipants):i.numParticipants=0,void 0!==e.activeRecording&&null!==e.activeRecording?i.activeRecording=Boolean(e.activeRecording):i.activeRecording=!1,i},toJSON(e){const i={};return void 0!==e.sid&&(i.sid=e.sid),void 0!==e.name&&(i.name=e.name),void 0!==e.emptyTimeout&&(i.emptyTimeout=e.emptyTimeout),void 0!==e.maxParticipants&&(i.maxParticipants=e.maxParticipants),void 0!==e.creationTime&&(i.creationTime=e.creationTime),void 0!==e.turnPassword&&(i.turnPassword=e.turnPassword),e.enabledCodecs?i.enabledCodecs=e.enabledCodecs.map((e=>e?t.Codec.toJSON(e):void 0)):i.enabledCodecs=[],void 0!==e.metadata&&(i.metadata=e.metadata),void 0!==e.numParticipants&&(i.numParticipants=e.numParticipants),void 0!==e.activeRecording&&(i.activeRecording=e.activeRecording),i},fromPartial(e){var i,n,a,o,s,c,u,l,p;const h=Object.assign({},b);if(h.sid=null!==(i=e.sid)&&void 0!==i?i:"",h.name=null!==(n=e.name)&&void 0!==n?n:"",h.emptyTimeout=null!==(a=e.emptyTimeout)&&void 0!==a?a:0,h.maxParticipants=null!==(o=e.maxParticipants)&&void 0!==o?o:0,h.creationTime=null!==(s=e.creationTime)&&void 0!==s?s:0,h.turnPassword=null!==(c=e.turnPassword)&&void 0!==c?c:"",h.enabledCodecs=[],void 0!==e.enabledCodecs&&null!==e.enabledCodecs)for(const i of e.enabledCodecs)h.enabledCodecs.push(t.Codec.fromPartial(i));return h.metadata=null!==(u=e.metadata)&&void 0!==u?u:"",h.numParticipants=null!==(l=e.numParticipants)&&void 0!==l?l:0,h.activeRecording=null!==(p=e.activeRecording)&&void 0!==p&&p,h}};const k={mime:"",fmtpLine:""};t.Codec={encode:(e,t=o.default.Writer.create())=>(""!==e.mime&&t.uint32(10).string(e.mime),""!==e.fmtpLine&&t.uint32(18).string(e.fmtpLine),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},k);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.mime=i.string();break;case 2:a.fmtpLine=i.string();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},k);return void 0!==e.mime&&null!==e.mime?t.mime=String(e.mime):t.mime="",void 0!==e.fmtpLine&&null!==e.fmtpLine?t.fmtpLine=String(e.fmtpLine):t.fmtpLine="",t},toJSON(e){const t={};return void 0!==e.mime&&(t.mime=e.mime),void 0!==e.fmtpLine&&(t.fmtpLine=e.fmtpLine),t},fromPartial(e){var t,i;const n=Object.assign({},k);return n.mime=null!==(t=e.mime)&&void 0!==t?t:"",n.fmtpLine=null!==(i=e.fmtpLine)&&void 0!==i?i:"",n}};const S={canSubscribe:!1,canPublish:!1,canPublishData:!1,hidden:!1,recorder:!1};t.ParticipantPermission={encode:(e,t=o.default.Writer.create())=>(!0===e.canSubscribe&&t.uint32(8).bool(e.canSubscribe),!0===e.canPublish&&t.uint32(16).bool(e.canPublish),!0===e.canPublishData&&t.uint32(24).bool(e.canPublishData),!0===e.hidden&&t.uint32(56).bool(e.hidden),!0===e.recorder&&t.uint32(64).bool(e.recorder),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},S);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.canSubscribe=i.bool();break;case 2:a.canPublish=i.bool();break;case 3:a.canPublishData=i.bool();break;case 7:a.hidden=i.bool();break;case 8:a.recorder=i.bool();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},S);return void 0!==e.canSubscribe&&null!==e.canSubscribe?t.canSubscribe=Boolean(e.canSubscribe):t.canSubscribe=!1,void 0!==e.canPublish&&null!==e.canPublish?t.canPublish=Boolean(e.canPublish):t.canPublish=!1,void 0!==e.canPublishData&&null!==e.canPublishData?t.canPublishData=Boolean(e.canPublishData):t.canPublishData=!1,void 0!==e.hidden&&null!==e.hidden?t.hidden=Boolean(e.hidden):t.hidden=!1,void 0!==e.recorder&&null!==e.recorder?t.recorder=Boolean(e.recorder):t.recorder=!1,t},toJSON(e){const t={};return void 0!==e.canSubscribe&&(t.canSubscribe=e.canSubscribe),void 0!==e.canPublish&&(t.canPublish=e.canPublish),void 0!==e.canPublishData&&(t.canPublishData=e.canPublishData),void 0!==e.hidden&&(t.hidden=e.hidden),void 0!==e.recorder&&(t.recorder=e.recorder),t},fromPartial(e){var t,i,n,a,o;const s=Object.assign({},S);return s.canSubscribe=null!==(t=e.canSubscribe)&&void 0!==t&&t,s.canPublish=null!==(i=e.canPublish)&&void 0!==i&&i,s.canPublishData=null!==(n=e.canPublishData)&&void 0!==n&&n,s.hidden=null!==(a=e.hidden)&&void 0!==a&&a,s.recorder=null!==(o=e.recorder)&&void 0!==o&&o,s}};const y={sid:"",identity:"",state:0,metadata:"",joinedAt:0,name:"",version:0};t.ParticipantInfo={encode(e,i=o.default.Writer.create()){""!==e.sid&&i.uint32(10).string(e.sid),""!==e.identity&&i.uint32(18).string(e.identity),0!==e.state&&i.uint32(24).int32(e.state);for(const n of e.tracks)t.TrackInfo.encode(n,i.uint32(34).fork()).ldelim();return""!==e.metadata&&i.uint32(42).string(e.metadata),0!==e.joinedAt&&i.uint32(48).int64(e.joinedAt),""!==e.name&&i.uint32(74).string(e.name),0!==e.version&&i.uint32(80).uint32(e.version),void 0!==e.permission&&t.ParticipantPermission.encode(e.permission,i.uint32(90).fork()).ldelim(),i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},y);for(s.tracks=[];n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:s.sid=n.string();break;case 2:s.identity=n.string();break;case 3:s.state=n.int32();break;case 4:s.tracks.push(t.TrackInfo.decode(n,n.uint32()));break;case 5:s.metadata=n.string();break;case 6:s.joinedAt=longToNumber(n.int64());break;case 9:s.name=n.string();break;case 10:s.version=n.uint32();break;case 11:s.permission=t.ParticipantPermission.decode(n,n.uint32());break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},y);if(i.tracks=[],void 0!==e.sid&&null!==e.sid?i.sid=String(e.sid):i.sid="",void 0!==e.identity&&null!==e.identity?i.identity=String(e.identity):i.identity="",void 0!==e.state&&null!==e.state?i.state=participantInfo_StateFromJSON(e.state):i.state=0,void 0!==e.tracks&&null!==e.tracks)for(const n of e.tracks)i.tracks.push(t.TrackInfo.fromJSON(n));return void 0!==e.metadata&&null!==e.metadata?i.metadata=String(e.metadata):i.metadata="",void 0!==e.joinedAt&&null!==e.joinedAt?i.joinedAt=Number(e.joinedAt):i.joinedAt=0,void 0!==e.name&&null!==e.name?i.name=String(e.name):i.name="",void 0!==e.version&&null!==e.version?i.version=Number(e.version):i.version=0,void 0!==e.permission&&null!==e.permission?i.permission=t.ParticipantPermission.fromJSON(e.permission):i.permission=void 0,i},toJSON(e){const i={};return void 0!==e.sid&&(i.sid=e.sid),void 0!==e.identity&&(i.identity=e.identity),void 0!==e.state&&(i.state=participantInfo_StateToJSON(e.state)),e.tracks?i.tracks=e.tracks.map((e=>e?t.TrackInfo.toJSON(e):void 0)):i.tracks=[],void 0!==e.metadata&&(i.metadata=e.metadata),void 0!==e.joinedAt&&(i.joinedAt=e.joinedAt),void 0!==e.name&&(i.name=e.name),void 0!==e.version&&(i.version=e.version),void 0!==e.permission&&(i.permission=e.permission?t.ParticipantPermission.toJSON(e.permission):void 0),i},fromPartial(e){var i,n,a,o,s,c,u;const l=Object.assign({},y);if(l.sid=null!==(i=e.sid)&&void 0!==i?i:"",l.identity=null!==(n=e.identity)&&void 0!==n?n:"",l.state=null!==(a=e.state)&&void 0!==a?a:0,l.tracks=[],void 0!==e.tracks&&null!==e.tracks)for(const i of e.tracks)l.tracks.push(t.TrackInfo.fromPartial(i));return l.metadata=null!==(o=e.metadata)&&void 0!==o?o:"",l.joinedAt=null!==(s=e.joinedAt)&&void 0!==s?s:0,l.name=null!==(c=e.name)&&void 0!==c?c:"",l.version=null!==(u=e.version)&&void 0!==u?u:0,void 0!==e.permission&&null!==e.permission?l.permission=t.ParticipantPermission.fromPartial(e.permission):l.permission=void 0,l}};const T={sid:"",type:0,name:"",muted:!1,width:0,height:0,simulcast:!1,disableDtx:!1,source:0,mimeType:"",mid:""};t.TrackInfo={encode(e,i=o.default.Writer.create()){""!==e.sid&&i.uint32(10).string(e.sid),0!==e.type&&i.uint32(16).int32(e.type),""!==e.name&&i.uint32(26).string(e.name),!0===e.muted&&i.uint32(32).bool(e.muted),0!==e.width&&i.uint32(40).uint32(e.width),0!==e.height&&i.uint32(48).uint32(e.height),!0===e.simulcast&&i.uint32(56).bool(e.simulcast),!0===e.disableDtx&&i.uint32(64).bool(e.disableDtx),0!==e.source&&i.uint32(72).int32(e.source);for(const n of e.layers)t.VideoLayer.encode(n,i.uint32(82).fork()).ldelim();return""!==e.mimeType&&i.uint32(90).string(e.mimeType),""!==e.mid&&i.uint32(98).string(e.mid),i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},T);for(s.layers=[];n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:s.sid=n.string();break;case 2:s.type=n.int32();break;case 3:s.name=n.string();break;case 4:s.muted=n.bool();break;case 5:s.width=n.uint32();break;case 6:s.height=n.uint32();break;case 7:s.simulcast=n.bool();break;case 8:s.disableDtx=n.bool();break;case 9:s.source=n.int32();break;case 10:s.layers.push(t.VideoLayer.decode(n,n.uint32()));break;case 11:s.mimeType=n.string();break;case 12:s.mid=n.string();break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},T);if(i.layers=[],void 0!==e.sid&&null!==e.sid?i.sid=String(e.sid):i.sid="",void 0!==e.type&&null!==e.type?i.type=trackTypeFromJSON(e.type):i.type=0,void 0!==e.name&&null!==e.name?i.name=String(e.name):i.name="",void 0!==e.muted&&null!==e.muted?i.muted=Boolean(e.muted):i.muted=!1,void 0!==e.width&&null!==e.width?i.width=Number(e.width):i.width=0,void 0!==e.height&&null!==e.height?i.height=Number(e.height):i.height=0,void 0!==e.simulcast&&null!==e.simulcast?i.simulcast=Boolean(e.simulcast):i.simulcast=!1,void 0!==e.disableDtx&&null!==e.disableDtx?i.disableDtx=Boolean(e.disableDtx):i.disableDtx=!1,void 0!==e.source&&null!==e.source?i.source=trackSourceFromJSON(e.source):i.source=0,void 0!==e.layers&&null!==e.layers)for(const n of e.layers)i.layers.push(t.VideoLayer.fromJSON(n));return void 0!==e.mimeType&&null!==e.mimeType?i.mimeType=String(e.mimeType):i.mimeType="",void 0!==e.mid&&null!==e.mid?i.mid=String(e.mid):i.mid="",i},toJSON(e){const i={};return void 0!==e.sid&&(i.sid=e.sid),void 0!==e.type&&(i.type=trackTypeToJSON(e.type)),void 0!==e.name&&(i.name=e.name),void 0!==e.muted&&(i.muted=e.muted),void 0!==e.width&&(i.width=e.width),void 0!==e.height&&(i.height=e.height),void 0!==e.simulcast&&(i.simulcast=e.simulcast),void 0!==e.disableDtx&&(i.disableDtx=e.disableDtx),void 0!==e.source&&(i.source=trackSourceToJSON(e.source)),e.layers?i.layers=e.layers.map((e=>e?t.VideoLayer.toJSON(e):void 0)):i.layers=[],void 0!==e.mimeType&&(i.mimeType=e.mimeType),void 0!==e.mid&&(i.mid=e.mid),i},fromPartial(e){var i,n,a,o,s,c,u,l,p,h,m;const v=Object.assign({},T);if(v.sid=null!==(i=e.sid)&&void 0!==i?i:"",v.type=null!==(n=e.type)&&void 0!==n?n:0,v.name=null!==(a=e.name)&&void 0!==a?a:"",v.muted=null!==(o=e.muted)&&void 0!==o&&o,v.width=null!==(s=e.width)&&void 0!==s?s:0,v.height=null!==(c=e.height)&&void 0!==c?c:0,v.simulcast=null!==(u=e.simulcast)&&void 0!==u&&u,v.disableDtx=null!==(l=e.disableDtx)&&void 0!==l&&l,v.source=null!==(p=e.source)&&void 0!==p?p:0,v.layers=[],void 0!==e.layers&&null!==e.layers)for(const i of e.layers)v.layers.push(t.VideoLayer.fromPartial(i));return v.mimeType=null!==(h=e.mimeType)&&void 0!==h?h:"",v.mid=null!==(m=e.mid)&&void 0!==m?m:"",v}};const P={quality:0,width:0,height:0,bitrate:0,ssrc:0};t.VideoLayer={encode:(e,t=o.default.Writer.create())=>(0!==e.quality&&t.uint32(8).int32(e.quality),0!==e.width&&t.uint32(16).uint32(e.width),0!==e.height&&t.uint32(24).uint32(e.height),0!==e.bitrate&&t.uint32(32).uint32(e.bitrate),0!==e.ssrc&&t.uint32(40).uint32(e.ssrc),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},P);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.quality=i.int32();break;case 2:a.width=i.uint32();break;case 3:a.height=i.uint32();break;case 4:a.bitrate=i.uint32();break;case 5:a.ssrc=i.uint32();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},P);return void 0!==e.quality&&null!==e.quality?t.quality=videoQualityFromJSON(e.quality):t.quality=0,void 0!==e.width&&null!==e.width?t.width=Number(e.width):t.width=0,void 0!==e.height&&null!==e.height?t.height=Number(e.height):t.height=0,void 0!==e.bitrate&&null!==e.bitrate?t.bitrate=Number(e.bitrate):t.bitrate=0,void 0!==e.ssrc&&null!==e.ssrc?t.ssrc=Number(e.ssrc):t.ssrc=0,t},toJSON(e){const t={};return void 0!==e.quality&&(t.quality=videoQualityToJSON(e.quality)),void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),void 0!==e.bitrate&&(t.bitrate=e.bitrate),void 0!==e.ssrc&&(t.ssrc=e.ssrc),t},fromPartial(e){var t,i,n,a,o;const s=Object.assign({},P);return s.quality=null!==(t=e.quality)&&void 0!==t?t:0,s.width=null!==(i=e.width)&&void 0!==i?i:0,s.height=null!==(n=e.height)&&void 0!==n?n:0,s.bitrate=null!==(a=e.bitrate)&&void 0!==a?a:0,s.ssrc=null!==(o=e.ssrc)&&void 0!==o?o:0,s}};const C={kind:0};t.DataPacket={encode:(e,i=o.default.Writer.create())=>(0!==e.kind&&i.uint32(8).int32(e.kind),void 0!==e.user&&t.UserPacket.encode(e.user,i.uint32(18).fork()).ldelim(),void 0!==e.speaker&&t.ActiveSpeakerUpdate.encode(e.speaker,i.uint32(26).fork()).ldelim(),i),decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},C);for(;n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:s.kind=n.int32();break;case 2:s.user=t.UserPacket.decode(n,n.uint32());break;case 3:s.speaker=t.ActiveSpeakerUpdate.decode(n,n.uint32());break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},C);return void 0!==e.kind&&null!==e.kind?i.kind=dataPacket_KindFromJSON(e.kind):i.kind=0,void 0!==e.user&&null!==e.user?i.user=t.UserPacket.fromJSON(e.user):i.user=void 0,void 0!==e.speaker&&null!==e.speaker?i.speaker=t.ActiveSpeakerUpdate.fromJSON(e.speaker):i.speaker=void 0,i},toJSON(e){const i={};return void 0!==e.kind&&(i.kind=dataPacket_KindToJSON(e.kind)),void 0!==e.user&&(i.user=e.user?t.UserPacket.toJSON(e.user):void 0),void 0!==e.speaker&&(i.speaker=e.speaker?t.ActiveSpeakerUpdate.toJSON(e.speaker):void 0),i},fromPartial(e){var i;const n=Object.assign({},C);return n.kind=null!==(i=e.kind)&&void 0!==i?i:0,void 0!==e.user&&null!==e.user?n.user=t.UserPacket.fromPartial(e.user):n.user=void 0,void 0!==e.speaker&&null!==e.speaker?n.speaker=t.ActiveSpeakerUpdate.fromPartial(e.speaker):n.speaker=void 0,n}};const w={};t.ActiveSpeakerUpdate={encode(e,i=o.default.Writer.create()){for(const n of e.speakers)t.SpeakerInfo.encode(n,i.uint32(10).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},w);for(s.speakers=[];n.pos<a;){const e=n.uint32();if(e>>>3==1)s.speakers.push(t.SpeakerInfo.decode(n,n.uint32()));else n.skipType(7&e)}return s},fromJSON(e){const i=Object.assign({},w);if(i.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const n of e.speakers)i.speakers.push(t.SpeakerInfo.fromJSON(n));return i},toJSON(e){const i={};return e.speakers?i.speakers=e.speakers.map((e=>e?t.SpeakerInfo.toJSON(e):void 0)):i.speakers=[],i},fromPartial(e){const i=Object.assign({},w);if(i.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const n of e.speakers)i.speakers.push(t.SpeakerInfo.fromPartial(n));return i}};const E={sid:"",level:0,active:!1};t.SpeakerInfo={encode:(e,t=o.default.Writer.create())=>(""!==e.sid&&t.uint32(10).string(e.sid),0!==e.level&&t.uint32(21).float(e.level),!0===e.active&&t.uint32(24).bool(e.active),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},E);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.sid=i.string();break;case 2:a.level=i.float();break;case 3:a.active=i.bool();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},E);return void 0!==e.sid&&null!==e.sid?t.sid=String(e.sid):t.sid="",void 0!==e.level&&null!==e.level?t.level=Number(e.level):t.level=0,void 0!==e.active&&null!==e.active?t.active=Boolean(e.active):t.active=!1,t},toJSON(e){const t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.level&&(t.level=e.level),void 0!==e.active&&(t.active=e.active),t},fromPartial(e){var t,i,n;const a=Object.assign({},E);return a.sid=null!==(t=e.sid)&&void 0!==t?t:"",a.level=null!==(i=e.level)&&void 0!==i?i:0,a.active=null!==(n=e.active)&&void 0!==n&&n,a}};const O={participantSid:"",destinationSids:""};t.UserPacket={encode(e,t=o.default.Writer.create()){""!==e.participantSid&&t.uint32(10).string(e.participantSid),0!==e.payload.length&&t.uint32(18).bytes(e.payload);for(const i of e.destinationSids)t.uint32(26).string(i);return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},O);for(a.destinationSids=[],a.payload=new Uint8Array;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.participantSid=i.string();break;case 2:a.payload=i.bytes();break;case 3:a.destinationSids.push(i.string());break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},O);if(t.destinationSids=[],t.payload=new Uint8Array,void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.payload&&null!==e.payload&&(t.payload=function bytesFromBase64(e){const t=M(e),i=new Uint8Array(t.length);for(let e=0;e<t.length;++e)i[e]=t.charCodeAt(e);return i}(e.payload)),void 0!==e.destinationSids&&null!==e.destinationSids)for(const i of e.destinationSids)t.destinationSids.push(String(i));return t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.payload&&(t.payload=function base64FromBytes(e){const t=[];for(const i of e)t.push(String.fromCharCode(i));return x(t.join(""))}(void 0!==e.payload?e.payload:new Uint8Array)),e.destinationSids?t.destinationSids=e.destinationSids.map((e=>e)):t.destinationSids=[],t},fromPartial(e){var t,i;const n=Object.assign({},O);if(n.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",n.payload=null!==(i=e.payload)&&void 0!==i?i:new Uint8Array,n.destinationSids=[],void 0!==e.destinationSids&&null!==e.destinationSids)for(const t of e.destinationSids)n.destinationSids.push(t);return n}};const R={participantSid:"",trackSids:""};t.ParticipantTracks={encode(e,t=o.default.Writer.create()){""!==e.participantSid&&t.uint32(10).string(e.participantSid);for(const i of e.trackSids)t.uint32(18).string(i);return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},R);for(a.trackSids=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.participantSid=i.string();break;case 2:a.trackSids.push(i.string());break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},R);if(t.trackSids=[],void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.trackSids&&null!==e.trackSids)for(const i of e.trackSids)t.trackSids.push(String(i));return t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),e.trackSids?t.trackSids=e.trackSids.map((e=>e)):t.trackSids=[],t},fromPartial(e){var t;const i=Object.assign({},R);if(i.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",i.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const t of e.trackSids)i.trackSids.push(t);return i}};const _={sdk:0,version:"",protocol:0,os:"",osVersion:"",deviceModel:"",browser:"",browserVersion:"",address:""};t.ClientInfo={encode:(e,t=o.default.Writer.create())=>(0!==e.sdk&&t.uint32(8).int32(e.sdk),""!==e.version&&t.uint32(18).string(e.version),0!==e.protocol&&t.uint32(24).int32(e.protocol),""!==e.os&&t.uint32(34).string(e.os),""!==e.osVersion&&t.uint32(42).string(e.osVersion),""!==e.deviceModel&&t.uint32(50).string(e.deviceModel),""!==e.browser&&t.uint32(58).string(e.browser),""!==e.browserVersion&&t.uint32(66).string(e.browserVersion),""!==e.address&&t.uint32(74).string(e.address),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},_);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.sdk=i.int32();break;case 2:a.version=i.string();break;case 3:a.protocol=i.int32();break;case 4:a.os=i.string();break;case 5:a.osVersion=i.string();break;case 6:a.deviceModel=i.string();break;case 7:a.browser=i.string();break;case 8:a.browserVersion=i.string();break;case 9:a.address=i.string();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},_);return void 0!==e.sdk&&null!==e.sdk?t.sdk=clientInfo_SDKFromJSON(e.sdk):t.sdk=0,void 0!==e.version&&null!==e.version?t.version=String(e.version):t.version="",void 0!==e.protocol&&null!==e.protocol?t.protocol=Number(e.protocol):t.protocol=0,void 0!==e.os&&null!==e.os?t.os=String(e.os):t.os="",void 0!==e.osVersion&&null!==e.osVersion?t.osVersion=String(e.osVersion):t.osVersion="",void 0!==e.deviceModel&&null!==e.deviceModel?t.deviceModel=String(e.deviceModel):t.deviceModel="",void 0!==e.browser&&null!==e.browser?t.browser=String(e.browser):t.browser="",void 0!==e.browserVersion&&null!==e.browserVersion?t.browserVersion=String(e.browserVersion):t.browserVersion="",void 0!==e.address&&null!==e.address?t.address=String(e.address):t.address="",t},toJSON(e){const t={};return void 0!==e.sdk&&(t.sdk=clientInfo_SDKToJSON(e.sdk)),void 0!==e.version&&(t.version=e.version),void 0!==e.protocol&&(t.protocol=e.protocol),void 0!==e.os&&(t.os=e.os),void 0!==e.osVersion&&(t.osVersion=e.osVersion),void 0!==e.deviceModel&&(t.deviceModel=e.deviceModel),void 0!==e.browser&&(t.browser=e.browser),void 0!==e.browserVersion&&(t.browserVersion=e.browserVersion),void 0!==e.address&&(t.address=e.address),t},fromPartial(e){var t,i,n,a,o,s,c,u,l;const p=Object.assign({},_);return p.sdk=null!==(t=e.sdk)&&void 0!==t?t:0,p.version=null!==(i=e.version)&&void 0!==i?i:"",p.protocol=null!==(n=e.protocol)&&void 0!==n?n:0,p.os=null!==(a=e.os)&&void 0!==a?a:"",p.osVersion=null!==(o=e.osVersion)&&void 0!==o?o:"",p.deviceModel=null!==(s=e.deviceModel)&&void 0!==s?s:"",p.browser=null!==(c=e.browser)&&void 0!==c?c:"",p.browserVersion=null!==(u=e.browserVersion)&&void 0!==u?u:"",p.address=null!==(l=e.address)&&void 0!==l?l:"",p}};const N={resumeConnection:0};t.ClientConfiguration={encode:(e,i=o.default.Writer.create())=>(void 0!==e.video&&t.VideoConfiguration.encode(e.video,i.uint32(10).fork()).ldelim(),void 0!==e.screen&&t.VideoConfiguration.encode(e.screen,i.uint32(18).fork()).ldelim(),0!==e.resumeConnection&&i.uint32(24).int32(e.resumeConnection),i),decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},N);for(;n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:s.video=t.VideoConfiguration.decode(n,n.uint32());break;case 2:s.screen=t.VideoConfiguration.decode(n,n.uint32());break;case 3:s.resumeConnection=n.int32();break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},N);return void 0!==e.video&&null!==e.video?i.video=t.VideoConfiguration.fromJSON(e.video):i.video=void 0,void 0!==e.screen&&null!==e.screen?i.screen=t.VideoConfiguration.fromJSON(e.screen):i.screen=void 0,void 0!==e.resumeConnection&&null!==e.resumeConnection?i.resumeConnection=clientConfigSettingFromJSON(e.resumeConnection):i.resumeConnection=0,i},toJSON(e){const i={};return void 0!==e.video&&(i.video=e.video?t.VideoConfiguration.toJSON(e.video):void 0),void 0!==e.screen&&(i.screen=e.screen?t.VideoConfiguration.toJSON(e.screen):void 0),void 0!==e.resumeConnection&&(i.resumeConnection=clientConfigSettingToJSON(e.resumeConnection)),i},fromPartial(e){var i;const n=Object.assign({},N);return void 0!==e.video&&null!==e.video?n.video=t.VideoConfiguration.fromPartial(e.video):n.video=void 0,void 0!==e.screen&&null!==e.screen?n.screen=t.VideoConfiguration.fromPartial(e.screen):n.screen=void 0,n.resumeConnection=null!==(i=e.resumeConnection)&&void 0!==i?i:0,n}};const D={hardwareEncoder:0};t.VideoConfiguration={encode:(e,t=o.default.Writer.create())=>(0!==e.hardwareEncoder&&t.uint32(8).int32(e.hardwareEncoder),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},D);for(;i.pos<n;){const e=i.uint32();if(e>>>3==1)a.hardwareEncoder=i.int32();else i.skipType(7&e)}return a},fromJSON(e){const t=Object.assign({},D);return void 0!==e.hardwareEncoder&&null!==e.hardwareEncoder?t.hardwareEncoder=clientConfigSettingFromJSON(e.hardwareEncoder):t.hardwareEncoder=0,t},toJSON(e){const t={};return void 0!==e.hardwareEncoder&&(t.hardwareEncoder=clientConfigSettingToJSON(e.hardwareEncoder)),t},fromPartial(e){var t;const i=Object.assign({},D);return i.hardwareEncoder=null!==(t=e.hardwareEncoder)&&void 0!==t?t:0,i}};const L={duration:0,packets:0,packetRate:0,bytes:0,bitrate:0,packetsLost:0,packetLossRate:0,packetLossPercentage:0,packetsDuplicate:0,packetDuplicateRate:0,bytesDuplicate:0,bitrateDuplicate:0,packetsPadding:0,packetPaddingRate:0,bytesPadding:0,bitratePadding:0,packetsOutOfOrder:0,frames:0,frameRate:0,jitterCurrent:0,jitterMax:0,nacks:0,nackMisses:0,plis:0,firs:0,rttCurrent:0,rttMax:0,keyFrames:0,layerLockPlis:0};t.RTPStats={encode:(e,i=o.default.Writer.create())=>(void 0!==e.startTime&&s.Timestamp.encode(toTimestamp(e.startTime),i.uint32(10).fork()).ldelim(),void 0!==e.endTime&&s.Timestamp.encode(toTimestamp(e.endTime),i.uint32(18).fork()).ldelim(),0!==e.duration&&i.uint32(25).double(e.duration),0!==e.packets&&i.uint32(32).uint32(e.packets),0!==e.packetRate&&i.uint32(41).double(e.packetRate),0!==e.bytes&&i.uint32(48).uint64(e.bytes),0!==e.bitrate&&i.uint32(57).double(e.bitrate),0!==e.packetsLost&&i.uint32(64).uint32(e.packetsLost),0!==e.packetLossRate&&i.uint32(73).double(e.packetLossRate),0!==e.packetLossPercentage&&i.uint32(85).float(e.packetLossPercentage),0!==e.packetsDuplicate&&i.uint32(88).uint32(e.packetsDuplicate),0!==e.packetDuplicateRate&&i.uint32(97).double(e.packetDuplicateRate),0!==e.bytesDuplicate&&i.uint32(104).uint64(e.bytesDuplicate),0!==e.bitrateDuplicate&&i.uint32(113).double(e.bitrateDuplicate),0!==e.packetsPadding&&i.uint32(120).uint32(e.packetsPadding),0!==e.packetPaddingRate&&i.uint32(129).double(e.packetPaddingRate),0!==e.bytesPadding&&i.uint32(136).uint64(e.bytesPadding),0!==e.bitratePadding&&i.uint32(145).double(e.bitratePadding),0!==e.packetsOutOfOrder&&i.uint32(152).uint32(e.packetsOutOfOrder),0!==e.frames&&i.uint32(160).uint32(e.frames),0!==e.frameRate&&i.uint32(169).double(e.frameRate),0!==e.jitterCurrent&&i.uint32(177).double(e.jitterCurrent),0!==e.jitterMax&&i.uint32(185).double(e.jitterMax),Object.entries(e.gapHistogram).forEach((([e,n])=>{t.RTPStats_GapHistogramEntry.encode({key:e,value:n},i.uint32(194).fork()).ldelim()})),0!==e.nacks&&i.uint32(200).uint32(e.nacks),0!==e.nackMisses&&i.uint32(208).uint32(e.nackMisses),0!==e.plis&&i.uint32(216).uint32(e.plis),void 0!==e.lastPli&&s.Timestamp.encode(toTimestamp(e.lastPli),i.uint32(226).fork()).ldelim(),0!==e.firs&&i.uint32(232).uint32(e.firs),void 0!==e.lastFir&&s.Timestamp.encode(toTimestamp(e.lastFir),i.uint32(242).fork()).ldelim(),0!==e.rttCurrent&&i.uint32(248).uint32(e.rttCurrent),0!==e.rttMax&&i.uint32(256).uint32(e.rttMax),0!==e.keyFrames&&i.uint32(264).uint32(e.keyFrames),void 0!==e.lastKeyFrame&&s.Timestamp.encode(toTimestamp(e.lastKeyFrame),i.uint32(274).fork()).ldelim(),0!==e.layerLockPlis&&i.uint32(280).uint32(e.layerLockPlis),void 0!==e.lastLayerLockPli&&s.Timestamp.encode(toTimestamp(e.lastLayerLockPli),i.uint32(290).fork()).ldelim(),i),decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const c=Object.assign({},L);for(c.gapHistogram={};n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:c.startTime=fromTimestamp(s.Timestamp.decode(n,n.uint32()));break;case 2:c.endTime=fromTimestamp(s.Timestamp.decode(n,n.uint32()));break;case 3:c.duration=n.double();break;case 4:c.packets=n.uint32();break;case 5:c.packetRate=n.double();break;case 6:c.bytes=longToNumber(n.uint64());break;case 7:c.bitrate=n.double();break;case 8:c.packetsLost=n.uint32();break;case 9:c.packetLossRate=n.double();break;case 10:c.packetLossPercentage=n.float();break;case 11:c.packetsDuplicate=n.uint32();break;case 12:c.packetDuplicateRate=n.double();break;case 13:c.bytesDuplicate=longToNumber(n.uint64());break;case 14:c.bitrateDuplicate=n.double();break;case 15:c.packetsPadding=n.uint32();break;case 16:c.packetPaddingRate=n.double();break;case 17:c.bytesPadding=longToNumber(n.uint64());break;case 18:c.bitratePadding=n.double();break;case 19:c.packetsOutOfOrder=n.uint32();break;case 20:c.frames=n.uint32();break;case 21:c.frameRate=n.double();break;case 22:c.jitterCurrent=n.double();break;case 23:c.jitterMax=n.double();break;case 24:const i=t.RTPStats_GapHistogramEntry.decode(n,n.uint32());void 0!==i.value&&(c.gapHistogram[i.key]=i.value);break;case 25:c.nacks=n.uint32();break;case 26:c.nackMisses=n.uint32();break;case 27:c.plis=n.uint32();break;case 28:c.lastPli=fromTimestamp(s.Timestamp.decode(n,n.uint32()));break;case 29:c.firs=n.uint32();break;case 30:c.lastFir=fromTimestamp(s.Timestamp.decode(n,n.uint32()));break;case 31:c.rttCurrent=n.uint32();break;case 32:c.rttMax=n.uint32();break;case 33:c.keyFrames=n.uint32();break;case 34:c.lastKeyFrame=fromTimestamp(s.Timestamp.decode(n,n.uint32()));break;case 35:c.layerLockPlis=n.uint32();break;case 36:c.lastLayerLockPli=fromTimestamp(s.Timestamp.decode(n,n.uint32()));break;default:n.skipType(7&e)}}return c},fromJSON(e){const t=Object.assign({},L);return t.gapHistogram={},void 0!==e.startTime&&null!==e.startTime?t.startTime=fromJsonTimestamp(e.startTime):t.startTime=void 0,void 0!==e.endTime&&null!==e.endTime?t.endTime=fromJsonTimestamp(e.endTime):t.endTime=void 0,void 0!==e.duration&&null!==e.duration?t.duration=Number(e.duration):t.duration=0,void 0!==e.packets&&null!==e.packets?t.packets=Number(e.packets):t.packets=0,void 0!==e.packetRate&&null!==e.packetRate?t.packetRate=Number(e.packetRate):t.packetRate=0,void 0!==e.bytes&&null!==e.bytes?t.bytes=Number(e.bytes):t.bytes=0,void 0!==e.bitrate&&null!==e.bitrate?t.bitrate=Number(e.bitrate):t.bitrate=0,void 0!==e.packetsLost&&null!==e.packetsLost?t.packetsLost=Number(e.packetsLost):t.packetsLost=0,void 0!==e.packetLossRate&&null!==e.packetLossRate?t.packetLossRate=Number(e.packetLossRate):t.packetLossRate=0,void 0!==e.packetLossPercentage&&null!==e.packetLossPercentage?t.packetLossPercentage=Number(e.packetLossPercentage):t.packetLossPercentage=0,void 0!==e.packetsDuplicate&&null!==e.packetsDuplicate?t.packetsDuplicate=Number(e.packetsDuplicate):t.packetsDuplicate=0,void 0!==e.packetDuplicateRate&&null!==e.packetDuplicateRate?t.packetDuplicateRate=Number(e.packetDuplicateRate):t.packetDuplicateRate=0,void 0!==e.bytesDuplicate&&null!==e.bytesDuplicate?t.bytesDuplicate=Number(e.bytesDuplicate):t.bytesDuplicate=0,void 0!==e.bitrateDuplicate&&null!==e.bitrateDuplicate?t.bitrateDuplicate=Number(e.bitrateDuplicate):t.bitrateDuplicate=0,void 0!==e.packetsPadding&&null!==e.packetsPadding?t.packetsPadding=Number(e.packetsPadding):t.packetsPadding=0,void 0!==e.packetPaddingRate&&null!==e.packetPaddingRate?t.packetPaddingRate=Number(e.packetPaddingRate):t.packetPaddingRate=0,void 0!==e.bytesPadding&&null!==e.bytesPadding?t.bytesPadding=Number(e.bytesPadding):t.bytesPadding=0,void 0!==e.bitratePadding&&null!==e.bitratePadding?t.bitratePadding=Number(e.bitratePadding):t.bitratePadding=0,void 0!==e.packetsOutOfOrder&&null!==e.packetsOutOfOrder?t.packetsOutOfOrder=Number(e.packetsOutOfOrder):t.packetsOutOfOrder=0,void 0!==e.frames&&null!==e.frames?t.frames=Number(e.frames):t.frames=0,void 0!==e.frameRate&&null!==e.frameRate?t.frameRate=Number(e.frameRate):t.frameRate=0,void 0!==e.jitterCurrent&&null!==e.jitterCurrent?t.jitterCurrent=Number(e.jitterCurrent):t.jitterCurrent=0,void 0!==e.jitterMax&&null!==e.jitterMax?t.jitterMax=Number(e.jitterMax):t.jitterMax=0,void 0!==e.gapHistogram&&null!==e.gapHistogram&&Object.entries(e.gapHistogram).forEach((([e,i])=>{t.gapHistogram[Number(e)]=Number(i)})),void 0!==e.nacks&&null!==e.nacks?t.nacks=Number(e.nacks):t.nacks=0,void 0!==e.nackMisses&&null!==e.nackMisses?t.nackMisses=Number(e.nackMisses):t.nackMisses=0,void 0!==e.plis&&null!==e.plis?t.plis=Number(e.plis):t.plis=0,void 0!==e.lastPli&&null!==e.lastPli?t.lastPli=fromJsonTimestamp(e.lastPli):t.lastPli=void 0,void 0!==e.firs&&null!==e.firs?t.firs=Number(e.firs):t.firs=0,void 0!==e.lastFir&&null!==e.lastFir?t.lastFir=fromJsonTimestamp(e.lastFir):t.lastFir=void 0,void 0!==e.rttCurrent&&null!==e.rttCurrent?t.rttCurrent=Number(e.rttCurrent):t.rttCurrent=0,void 0!==e.rttMax&&null!==e.rttMax?t.rttMax=Number(e.rttMax):t.rttMax=0,void 0!==e.keyFrames&&null!==e.keyFrames?t.keyFrames=Number(e.keyFrames):t.keyFrames=0,void 0!==e.lastKeyFrame&&null!==e.lastKeyFrame?t.lastKeyFrame=fromJsonTimestamp(e.lastKeyFrame):t.lastKeyFrame=void 0,void 0!==e.layerLockPlis&&null!==e.layerLockPlis?t.layerLockPlis=Number(e.layerLockPlis):t.layerLockPlis=0,void 0!==e.lastLayerLockPli&&null!==e.lastLayerLockPli?t.lastLayerLockPli=fromJsonTimestamp(e.lastLayerLockPli):t.lastLayerLockPli=void 0,t},toJSON(e){const t={};return void 0!==e.startTime&&(t.startTime=e.startTime.toISOString()),void 0!==e.endTime&&(t.endTime=e.endTime.toISOString()),void 0!==e.duration&&(t.duration=e.duration),void 0!==e.packets&&(t.packets=e.packets),void 0!==e.packetRate&&(t.packetRate=e.packetRate),void 0!==e.bytes&&(t.bytes=e.bytes),void 0!==e.bitrate&&(t.bitrate=e.bitrate),void 0!==e.packetsLost&&(t.packetsLost=e.packetsLost),void 0!==e.packetLossRate&&(t.packetLossRate=e.packetLossRate),void 0!==e.packetLossPercentage&&(t.packetLossPercentage=e.packetLossPercentage),void 0!==e.packetsDuplicate&&(t.packetsDuplicate=e.packetsDuplicate),void 0!==e.packetDuplicateRate&&(t.packetDuplicateRate=e.packetDuplicateRate),void 0!==e.bytesDuplicate&&(t.bytesDuplicate=e.bytesDuplicate),void 0!==e.bitrateDuplicate&&(t.bitrateDuplicate=e.bitrateDuplicate),void 0!==e.packetsPadding&&(t.packetsPadding=e.packetsPadding),void 0!==e.packetPaddingRate&&(t.packetPaddingRate=e.packetPaddingRate),void 0!==e.bytesPadding&&(t.bytesPadding=e.bytesPadding),void 0!==e.bitratePadding&&(t.bitratePadding=e.bitratePadding),void 0!==e.packetsOutOfOrder&&(t.packetsOutOfOrder=e.packetsOutOfOrder),void 0!==e.frames&&(t.frames=e.frames),void 0!==e.frameRate&&(t.frameRate=e.frameRate),void 0!==e.jitterCurrent&&(t.jitterCurrent=e.jitterCurrent),void 0!==e.jitterMax&&(t.jitterMax=e.jitterMax),t.gapHistogram={},e.gapHistogram&&Object.entries(e.gapHistogram).forEach((([e,i])=>{t.gapHistogram[e]=i})),void 0!==e.nacks&&(t.nacks=e.nacks),void 0!==e.nackMisses&&(t.nackMisses=e.nackMisses),void 0!==e.plis&&(t.plis=e.plis),void 0!==e.lastPli&&(t.lastPli=e.lastPli.toISOString()),void 0!==e.firs&&(t.firs=e.firs),void 0!==e.lastFir&&(t.lastFir=e.lastFir.toISOString()),void 0!==e.rttCurrent&&(t.rttCurrent=e.rttCurrent),void 0!==e.rttMax&&(t.rttMax=e.rttMax),void 0!==e.keyFrames&&(t.keyFrames=e.keyFrames),void 0!==e.lastKeyFrame&&(t.lastKeyFrame=e.lastKeyFrame.toISOString()),void 0!==e.layerLockPlis&&(t.layerLockPlis=e.layerLockPlis),void 0!==e.lastLayerLockPli&&(t.lastLayerLockPli=e.lastLayerLockPli.toISOString()),t},fromPartial(e){var t,i,n,a,o,s,c,u,l,p,h,m,v,g,b,k,S,y,T,P,C,w,E,O,R,_,N,D,I,U,M,x,A,j,J;const F=Object.assign({},L);return F.startTime=null!==(t=e.startTime)&&void 0!==t?t:void 0,F.endTime=null!==(i=e.endTime)&&void 0!==i?i:void 0,F.duration=null!==(n=e.duration)&&void 0!==n?n:0,F.packets=null!==(a=e.packets)&&void 0!==a?a:0,F.packetRate=null!==(o=e.packetRate)&&void 0!==o?o:0,F.bytes=null!==(s=e.bytes)&&void 0!==s?s:0,F.bitrate=null!==(c=e.bitrate)&&void 0!==c?c:0,F.packetsLost=null!==(u=e.packetsLost)&&void 0!==u?u:0,F.packetLossRate=null!==(l=e.packetLossRate)&&void 0!==l?l:0,F.packetLossPercentage=null!==(p=e.packetLossPercentage)&&void 0!==p?p:0,F.packetsDuplicate=null!==(h=e.packetsDuplicate)&&void 0!==h?h:0,F.packetDuplicateRate=null!==(m=e.packetDuplicateRate)&&void 0!==m?m:0,F.bytesDuplicate=null!==(v=e.bytesDuplicate)&&void 0!==v?v:0,F.bitrateDuplicate=null!==(g=e.bitrateDuplicate)&&void 0!==g?g:0,F.packetsPadding=null!==(b=e.packetsPadding)&&void 0!==b?b:0,F.packetPaddingRate=null!==(k=e.packetPaddingRate)&&void 0!==k?k:0,F.bytesPadding=null!==(S=e.bytesPadding)&&void 0!==S?S:0,F.bitratePadding=null!==(y=e.bitratePadding)&&void 0!==y?y:0,F.packetsOutOfOrder=null!==(T=e.packetsOutOfOrder)&&void 0!==T?T:0,F.frames=null!==(P=e.frames)&&void 0!==P?P:0,F.frameRate=null!==(C=e.frameRate)&&void 0!==C?C:0,F.jitterCurrent=null!==(w=e.jitterCurrent)&&void 0!==w?w:0,F.jitterMax=null!==(E=e.jitterMax)&&void 0!==E?E:0,F.gapHistogram={},void 0!==e.gapHistogram&&null!==e.gapHistogram&&Object.entries(e.gapHistogram).forEach((([e,t])=>{void 0!==t&&(F.gapHistogram[Number(e)]=Number(t))})),F.nacks=null!==(O=e.nacks)&&void 0!==O?O:0,F.nackMisses=null!==(R=e.nackMisses)&&void 0!==R?R:0,F.plis=null!==(_=e.plis)&&void 0!==_?_:0,F.lastPli=null!==(N=e.lastPli)&&void 0!==N?N:void 0,F.firs=null!==(D=e.firs)&&void 0!==D?D:0,F.lastFir=null!==(I=e.lastFir)&&void 0!==I?I:void 0,F.rttCurrent=null!==(U=e.rttCurrent)&&void 0!==U?U:0,F.rttMax=null!==(M=e.rttMax)&&void 0!==M?M:0,F.keyFrames=null!==(x=e.keyFrames)&&void 0!==x?x:0,F.lastKeyFrame=null!==(A=e.lastKeyFrame)&&void 0!==A?A:void 0,F.layerLockPlis=null!==(j=e.layerLockPlis)&&void 0!==j?j:0,F.lastLayerLockPli=null!==(J=e.lastLayerLockPli)&&void 0!==J?J:void 0,F}};const I={key:0,value:0};t.RTPStats_GapHistogramEntry={encode:(e,t=o.default.Writer.create())=>(0!==e.key&&t.uint32(8).int32(e.key),0!==e.value&&t.uint32(16).uint32(e.value),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},I);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.key=i.int32();break;case 2:a.value=i.uint32();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},I);return void 0!==e.key&&null!==e.key?t.key=Number(e.key):t.key=0,void 0!==e.value&&null!==e.value?t.value=Number(e.value):t.value=0,t},toJSON(e){const t={};return void 0!==e.key&&(t.key=e.key),void 0!==e.value&&(t.value=e.value),t},fromPartial(e){var t,i;const n=Object.assign({},I);return n.key=null!==(t=e.key)&&void 0!==t?t:0,n.value=null!==(i=e.value)&&void 0!==i?i:0,n}};var U=(()=>{if(void 0!==U)return U;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==i.g)return i.g;throw"Unable to locate global object"})();const M=U.atob||(e=>U.Buffer.from(e,"base64").toString("binary"));const x=U.btoa||(e=>U.Buffer.from(e,"binary").toString("base64"));function toTimestamp(e){return{seconds:e.getTime()/1e3,nanos:e.getTime()%1e3*1e6}}function fromTimestamp(e){let t=1e3*e.seconds;return t+=e.nanos/1e6,new Date(t)}function fromJsonTimestamp(e){return e instanceof Date?e:"string"==typeof e?new Date(e):fromTimestamp(s.Timestamp.fromJSON(e))}function longToNumber(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new U.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}o.default.util.Long!==a.default&&(o.default.util.Long=a.default,o.default.configure())},4658:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SimulateScenario=t.DataChannelInfo=t.SyncState=t.SubscriptionPermissionUpdate=t.SubscriptionPermission=t.TrackPermission=t.SubscribedQualityUpdate=t.SubscribedQuality=t.StreamStateUpdate=t.StreamStateInfo=t.ConnectionQualityUpdate=t.ConnectionQualityInfo=t.RoomUpdate=t.SpeakersChanged=t.ICEServer=t.UpdateVideoLayers=t.LeaveRequest=t.UpdateTrackSettings=t.UpdateSubscription=t.ParticipantUpdate=t.SessionDescription=t.TrackUnpublishedResponse=t.TrackPublishedResponse=t.JoinResponse=t.MuteTrackRequest=t.TrickleRequest=t.AddTrackRequest=t.SignalResponse=t.SignalRequest=t.streamStateToJSON=t.streamStateFromJSON=t.StreamState=t.signalTargetToJSON=t.signalTargetFromJSON=t.SignalTarget=t.protobufPackage=void 0;const a=n(i(3720)),o=n(i(2100)),s=i(8983);var c,u;function signalTargetFromJSON(e){switch(e){case 0:case"PUBLISHER":return c.PUBLISHER;case 1:case"SUBSCRIBER":return c.SUBSCRIBER;default:return c.UNRECOGNIZED}}function signalTargetToJSON(e){switch(e){case c.PUBLISHER:return"PUBLISHER";case c.SUBSCRIBER:return"SUBSCRIBER";default:return"UNKNOWN"}}function streamStateFromJSON(e){switch(e){case 0:case"ACTIVE":return u.ACTIVE;case 1:case"PAUSED":return u.PAUSED;default:return u.UNRECOGNIZED}}function streamStateToJSON(e){switch(e){case u.ACTIVE:return"ACTIVE";case u.PAUSED:return"PAUSED";default:return"UNKNOWN"}}t.protobufPackage="livekit",function(e){e[e.PUBLISHER=0]="PUBLISHER",e[e.SUBSCRIBER=1]="SUBSCRIBER",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(c=t.SignalTarget||(t.SignalTarget={})),t.signalTargetFromJSON=signalTargetFromJSON,t.signalTargetToJSON=signalTargetToJSON,function(e){e[e.ACTIVE=0]="ACTIVE",e[e.PAUSED=1]="PAUSED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(u=t.StreamState||(t.StreamState={})),t.streamStateFromJSON=streamStateFromJSON,t.streamStateToJSON=streamStateToJSON;const l={};t.SignalRequest={encode:(e,i=o.default.Writer.create())=>(void 0!==e.offer&&t.SessionDescription.encode(e.offer,i.uint32(10).fork()).ldelim(),void 0!==e.answer&&t.SessionDescription.encode(e.answer,i.uint32(18).fork()).ldelim(),void 0!==e.trickle&&t.TrickleRequest.encode(e.trickle,i.uint32(26).fork()).ldelim(),void 0!==e.addTrack&&t.AddTrackRequest.encode(e.addTrack,i.uint32(34).fork()).ldelim(),void 0!==e.mute&&t.MuteTrackRequest.encode(e.mute,i.uint32(42).fork()).ldelim(),void 0!==e.subscription&&t.UpdateSubscription.encode(e.subscription,i.uint32(50).fork()).ldelim(),void 0!==e.trackSetting&&t.UpdateTrackSettings.encode(e.trackSetting,i.uint32(58).fork()).ldelim(),void 0!==e.leave&&t.LeaveRequest.encode(e.leave,i.uint32(66).fork()).ldelim(),void 0!==e.updateLayers&&t.UpdateVideoLayers.encode(e.updateLayers,i.uint32(82).fork()).ldelim(),void 0!==e.subscriptionPermission&&t.SubscriptionPermission.encode(e.subscriptionPermission,i.uint32(90).fork()).ldelim(),void 0!==e.syncState&&t.SyncState.encode(e.syncState,i.uint32(98).fork()).ldelim(),void 0!==e.simulate&&t.SimulateScenario.encode(e.simulate,i.uint32(106).fork()).ldelim(),i),decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},l);for(;n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:s.offer=t.SessionDescription.decode(n,n.uint32());break;case 2:s.answer=t.SessionDescription.decode(n,n.uint32());break;case 3:s.trickle=t.TrickleRequest.decode(n,n.uint32());break;case 4:s.addTrack=t.AddTrackRequest.decode(n,n.uint32());break;case 5:s.mute=t.MuteTrackRequest.decode(n,n.uint32());break;case 6:s.subscription=t.UpdateSubscription.decode(n,n.uint32());break;case 7:s.trackSetting=t.UpdateTrackSettings.decode(n,n.uint32());break;case 8:s.leave=t.LeaveRequest.decode(n,n.uint32());break;case 10:s.updateLayers=t.UpdateVideoLayers.decode(n,n.uint32());break;case 11:s.subscriptionPermission=t.SubscriptionPermission.decode(n,n.uint32());break;case 12:s.syncState=t.SyncState.decode(n,n.uint32());break;case 13:s.simulate=t.SimulateScenario.decode(n,n.uint32());break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},l);return void 0!==e.offer&&null!==e.offer?i.offer=t.SessionDescription.fromJSON(e.offer):i.offer=void 0,void 0!==e.answer&&null!==e.answer?i.answer=t.SessionDescription.fromJSON(e.answer):i.answer=void 0,void 0!==e.trickle&&null!==e.trickle?i.trickle=t.TrickleRequest.fromJSON(e.trickle):i.trickle=void 0,void 0!==e.addTrack&&null!==e.addTrack?i.addTrack=t.AddTrackRequest.fromJSON(e.addTrack):i.addTrack=void 0,void 0!==e.mute&&null!==e.mute?i.mute=t.MuteTrackRequest.fromJSON(e.mute):i.mute=void 0,void 0!==e.subscription&&null!==e.subscription?i.subscription=t.UpdateSubscription.fromJSON(e.subscription):i.subscription=void 0,void 0!==e.trackSetting&&null!==e.trackSetting?i.trackSetting=t.UpdateTrackSettings.fromJSON(e.trackSetting):i.trackSetting=void 0,void 0!==e.leave&&null!==e.leave?i.leave=t.LeaveRequest.fromJSON(e.leave):i.leave=void 0,void 0!==e.updateLayers&&null!==e.updateLayers?i.updateLayers=t.UpdateVideoLayers.fromJSON(e.updateLayers):i.updateLayers=void 0,void 0!==e.subscriptionPermission&&null!==e.subscriptionPermission?i.subscriptionPermission=t.SubscriptionPermission.fromJSON(e.subscriptionPermission):i.subscriptionPermission=void 0,void 0!==e.syncState&&null!==e.syncState?i.syncState=t.SyncState.fromJSON(e.syncState):i.syncState=void 0,void 0!==e.simulate&&null!==e.simulate?i.simulate=t.SimulateScenario.fromJSON(e.simulate):i.simulate=void 0,i},toJSON(e){const i={};return void 0!==e.offer&&(i.offer=e.offer?t.SessionDescription.toJSON(e.offer):void 0),void 0!==e.answer&&(i.answer=e.answer?t.SessionDescription.toJSON(e.answer):void 0),void 0!==e.trickle&&(i.trickle=e.trickle?t.TrickleRequest.toJSON(e.trickle):void 0),void 0!==e.addTrack&&(i.addTrack=e.addTrack?t.AddTrackRequest.toJSON(e.addTrack):void 0),void 0!==e.mute&&(i.mute=e.mute?t.MuteTrackRequest.toJSON(e.mute):void 0),void 0!==e.subscription&&(i.subscription=e.subscription?t.UpdateSubscription.toJSON(e.subscription):void 0),void 0!==e.trackSetting&&(i.trackSetting=e.trackSetting?t.UpdateTrackSettings.toJSON(e.trackSetting):void 0),void 0!==e.leave&&(i.leave=e.leave?t.LeaveRequest.toJSON(e.leave):void 0),void 0!==e.updateLayers&&(i.updateLayers=e.updateLayers?t.UpdateVideoLayers.toJSON(e.updateLayers):void 0),void 0!==e.subscriptionPermission&&(i.subscriptionPermission=e.subscriptionPermission?t.SubscriptionPermission.toJSON(e.subscriptionPermission):void 0),void 0!==e.syncState&&(i.syncState=e.syncState?t.SyncState.toJSON(e.syncState):void 0),void 0!==e.simulate&&(i.simulate=e.simulate?t.SimulateScenario.toJSON(e.simulate):void 0),i},fromPartial(e){const i=Object.assign({},l);return void 0!==e.offer&&null!==e.offer?i.offer=t.SessionDescription.fromPartial(e.offer):i.offer=void 0,void 0!==e.answer&&null!==e.answer?i.answer=t.SessionDescription.fromPartial(e.answer):i.answer=void 0,void 0!==e.trickle&&null!==e.trickle?i.trickle=t.TrickleRequest.fromPartial(e.trickle):i.trickle=void 0,void 0!==e.addTrack&&null!==e.addTrack?i.addTrack=t.AddTrackRequest.fromPartial(e.addTrack):i.addTrack=void 0,void 0!==e.mute&&null!==e.mute?i.mute=t.MuteTrackRequest.fromPartial(e.mute):i.mute=void 0,void 0!==e.subscription&&null!==e.subscription?i.subscription=t.UpdateSubscription.fromPartial(e.subscription):i.subscription=void 0,void 0!==e.trackSetting&&null!==e.trackSetting?i.trackSetting=t.UpdateTrackSettings.fromPartial(e.trackSetting):i.trackSetting=void 0,void 0!==e.leave&&null!==e.leave?i.leave=t.LeaveRequest.fromPartial(e.leave):i.leave=void 0,void 0!==e.updateLayers&&null!==e.updateLayers?i.updateLayers=t.UpdateVideoLayers.fromPartial(e.updateLayers):i.updateLayers=void 0,void 0!==e.subscriptionPermission&&null!==e.subscriptionPermission?i.subscriptionPermission=t.SubscriptionPermission.fromPartial(e.subscriptionPermission):i.subscriptionPermission=void 0,void 0!==e.syncState&&null!==e.syncState?i.syncState=t.SyncState.fromPartial(e.syncState):i.syncState=void 0,void 0!==e.simulate&&null!==e.simulate?i.simulate=t.SimulateScenario.fromPartial(e.simulate):i.simulate=void 0,i}};const p={};t.SignalResponse={encode:(e,i=o.default.Writer.create())=>(void 0!==e.join&&t.JoinResponse.encode(e.join,i.uint32(10).fork()).ldelim(),void 0!==e.answer&&t.SessionDescription.encode(e.answer,i.uint32(18).fork()).ldelim(),void 0!==e.offer&&t.SessionDescription.encode(e.offer,i.uint32(26).fork()).ldelim(),void 0!==e.trickle&&t.TrickleRequest.encode(e.trickle,i.uint32(34).fork()).ldelim(),void 0!==e.update&&t.ParticipantUpdate.encode(e.update,i.uint32(42).fork()).ldelim(),void 0!==e.trackPublished&&t.TrackPublishedResponse.encode(e.trackPublished,i.uint32(50).fork()).ldelim(),void 0!==e.leave&&t.LeaveRequest.encode(e.leave,i.uint32(66).fork()).ldelim(),void 0!==e.mute&&t.MuteTrackRequest.encode(e.mute,i.uint32(74).fork()).ldelim(),void 0!==e.speakersChanged&&t.SpeakersChanged.encode(e.speakersChanged,i.uint32(82).fork()).ldelim(),void 0!==e.roomUpdate&&t.RoomUpdate.encode(e.roomUpdate,i.uint32(90).fork()).ldelim(),void 0!==e.connectionQuality&&t.ConnectionQualityUpdate.encode(e.connectionQuality,i.uint32(98).fork()).ldelim(),void 0!==e.streamStateUpdate&&t.StreamStateUpdate.encode(e.streamStateUpdate,i.uint32(106).fork()).ldelim(),void 0!==e.subscribedQualityUpdate&&t.SubscribedQualityUpdate.encode(e.subscribedQualityUpdate,i.uint32(114).fork()).ldelim(),void 0!==e.subscriptionPermissionUpdate&&t.SubscriptionPermissionUpdate.encode(e.subscriptionPermissionUpdate,i.uint32(122).fork()).ldelim(),void 0!==e.refreshToken&&i.uint32(130).string(e.refreshToken),void 0!==e.trackUnpublished&&t.TrackUnpublishedResponse.encode(e.trackUnpublished,i.uint32(138).fork()).ldelim(),i),decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},p);for(;n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:s.join=t.JoinResponse.decode(n,n.uint32());break;case 2:s.answer=t.SessionDescription.decode(n,n.uint32());break;case 3:s.offer=t.SessionDescription.decode(n,n.uint32());break;case 4:s.trickle=t.TrickleRequest.decode(n,n.uint32());break;case 5:s.update=t.ParticipantUpdate.decode(n,n.uint32());break;case 6:s.trackPublished=t.TrackPublishedResponse.decode(n,n.uint32());break;case 8:s.leave=t.LeaveRequest.decode(n,n.uint32());break;case 9:s.mute=t.MuteTrackRequest.decode(n,n.uint32());break;case 10:s.speakersChanged=t.SpeakersChanged.decode(n,n.uint32());break;case 11:s.roomUpdate=t.RoomUpdate.decode(n,n.uint32());break;case 12:s.connectionQuality=t.ConnectionQualityUpdate.decode(n,n.uint32());break;case 13:s.streamStateUpdate=t.StreamStateUpdate.decode(n,n.uint32());break;case 14:s.subscribedQualityUpdate=t.SubscribedQualityUpdate.decode(n,n.uint32());break;case 15:s.subscriptionPermissionUpdate=t.SubscriptionPermissionUpdate.decode(n,n.uint32());break;case 16:s.refreshToken=n.string();break;case 17:s.trackUnpublished=t.TrackUnpublishedResponse.decode(n,n.uint32());break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},p);return void 0!==e.join&&null!==e.join?i.join=t.JoinResponse.fromJSON(e.join):i.join=void 0,void 0!==e.answer&&null!==e.answer?i.answer=t.SessionDescription.fromJSON(e.answer):i.answer=void 0,void 0!==e.offer&&null!==e.offer?i.offer=t.SessionDescription.fromJSON(e.offer):i.offer=void 0,void 0!==e.trickle&&null!==e.trickle?i.trickle=t.TrickleRequest.fromJSON(e.trickle):i.trickle=void 0,void 0!==e.update&&null!==e.update?i.update=t.ParticipantUpdate.fromJSON(e.update):i.update=void 0,void 0!==e.trackPublished&&null!==e.trackPublished?i.trackPublished=t.TrackPublishedResponse.fromJSON(e.trackPublished):i.trackPublished=void 0,void 0!==e.leave&&null!==e.leave?i.leave=t.LeaveRequest.fromJSON(e.leave):i.leave=void 0,void 0!==e.mute&&null!==e.mute?i.mute=t.MuteTrackRequest.fromJSON(e.mute):i.mute=void 0,void 0!==e.speakersChanged&&null!==e.speakersChanged?i.speakersChanged=t.SpeakersChanged.fromJSON(e.speakersChanged):i.speakersChanged=void 0,void 0!==e.roomUpdate&&null!==e.roomUpdate?i.roomUpdate=t.RoomUpdate.fromJSON(e.roomUpdate):i.roomUpdate=void 0,void 0!==e.connectionQuality&&null!==e.connectionQuality?i.connectionQuality=t.ConnectionQualityUpdate.fromJSON(e.connectionQuality):i.connectionQuality=void 0,void 0!==e.streamStateUpdate&&null!==e.streamStateUpdate?i.streamStateUpdate=t.StreamStateUpdate.fromJSON(e.streamStateUpdate):i.streamStateUpdate=void 0,void 0!==e.subscribedQualityUpdate&&null!==e.subscribedQualityUpdate?i.subscribedQualityUpdate=t.SubscribedQualityUpdate.fromJSON(e.subscribedQualityUpdate):i.subscribedQualityUpdate=void 0,void 0!==e.subscriptionPermissionUpdate&&null!==e.subscriptionPermissionUpdate?i.subscriptionPermissionUpdate=t.SubscriptionPermissionUpdate.fromJSON(e.subscriptionPermissionUpdate):i.subscriptionPermissionUpdate=void 0,void 0!==e.refreshToken&&null!==e.refreshToken?i.refreshToken=String(e.refreshToken):i.refreshToken=void 0,void 0!==e.trackUnpublished&&null!==e.trackUnpublished?i.trackUnpublished=t.TrackUnpublishedResponse.fromJSON(e.trackUnpublished):i.trackUnpublished=void 0,i},toJSON(e){const i={};return void 0!==e.join&&(i.join=e.join?t.JoinResponse.toJSON(e.join):void 0),void 0!==e.answer&&(i.answer=e.answer?t.SessionDescription.toJSON(e.answer):void 0),void 0!==e.offer&&(i.offer=e.offer?t.SessionDescription.toJSON(e.offer):void 0),void 0!==e.trickle&&(i.trickle=e.trickle?t.TrickleRequest.toJSON(e.trickle):void 0),void 0!==e.update&&(i.update=e.update?t.ParticipantUpdate.toJSON(e.update):void 0),void 0!==e.trackPublished&&(i.trackPublished=e.trackPublished?t.TrackPublishedResponse.toJSON(e.trackPublished):void 0),void 0!==e.leave&&(i.leave=e.leave?t.LeaveRequest.toJSON(e.leave):void 0),void 0!==e.mute&&(i.mute=e.mute?t.MuteTrackRequest.toJSON(e.mute):void 0),void 0!==e.speakersChanged&&(i.speakersChanged=e.speakersChanged?t.SpeakersChanged.toJSON(e.speakersChanged):void 0),void 0!==e.roomUpdate&&(i.roomUpdate=e.roomUpdate?t.RoomUpdate.toJSON(e.roomUpdate):void 0),void 0!==e.connectionQuality&&(i.connectionQuality=e.connectionQuality?t.ConnectionQualityUpdate.toJSON(e.connectionQuality):void 0),void 0!==e.streamStateUpdate&&(i.streamStateUpdate=e.streamStateUpdate?t.StreamStateUpdate.toJSON(e.streamStateUpdate):void 0),void 0!==e.subscribedQualityUpdate&&(i.subscribedQualityUpdate=e.subscribedQualityUpdate?t.SubscribedQualityUpdate.toJSON(e.subscribedQualityUpdate):void 0),void 0!==e.subscriptionPermissionUpdate&&(i.subscriptionPermissionUpdate=e.subscriptionPermissionUpdate?t.SubscriptionPermissionUpdate.toJSON(e.subscriptionPermissionUpdate):void 0),void 0!==e.refreshToken&&(i.refreshToken=e.refreshToken),void 0!==e.trackUnpublished&&(i.trackUnpublished=e.trackUnpublished?t.TrackUnpublishedResponse.toJSON(e.trackUnpublished):void 0),i},fromPartial(e){var i;const n=Object.assign({},p);return void 0!==e.join&&null!==e.join?n.join=t.JoinResponse.fromPartial(e.join):n.join=void 0,void 0!==e.answer&&null!==e.answer?n.answer=t.SessionDescription.fromPartial(e.answer):n.answer=void 0,void 0!==e.offer&&null!==e.offer?n.offer=t.SessionDescription.fromPartial(e.offer):n.offer=void 0,void 0!==e.trickle&&null!==e.trickle?n.trickle=t.TrickleRequest.fromPartial(e.trickle):n.trickle=void 0,void 0!==e.update&&null!==e.update?n.update=t.ParticipantUpdate.fromPartial(e.update):n.update=void 0,void 0!==e.trackPublished&&null!==e.trackPublished?n.trackPublished=t.TrackPublishedResponse.fromPartial(e.trackPublished):n.trackPublished=void 0,void 0!==e.leave&&null!==e.leave?n.leave=t.LeaveRequest.fromPartial(e.leave):n.leave=void 0,void 0!==e.mute&&null!==e.mute?n.mute=t.MuteTrackRequest.fromPartial(e.mute):n.mute=void 0,void 0!==e.speakersChanged&&null!==e.speakersChanged?n.speakersChanged=t.SpeakersChanged.fromPartial(e.speakersChanged):n.speakersChanged=void 0,void 0!==e.roomUpdate&&null!==e.roomUpdate?n.roomUpdate=t.RoomUpdate.fromPartial(e.roomUpdate):n.roomUpdate=void 0,void 0!==e.connectionQuality&&null!==e.connectionQuality?n.connectionQuality=t.ConnectionQualityUpdate.fromPartial(e.connectionQuality):n.connectionQuality=void 0,void 0!==e.streamStateUpdate&&null!==e.streamStateUpdate?n.streamStateUpdate=t.StreamStateUpdate.fromPartial(e.streamStateUpdate):n.streamStateUpdate=void 0,void 0!==e.subscribedQualityUpdate&&null!==e.subscribedQualityUpdate?n.subscribedQualityUpdate=t.SubscribedQualityUpdate.fromPartial(e.subscribedQualityUpdate):n.subscribedQualityUpdate=void 0,void 0!==e.subscriptionPermissionUpdate&&null!==e.subscriptionPermissionUpdate?n.subscriptionPermissionUpdate=t.SubscriptionPermissionUpdate.fromPartial(e.subscriptionPermissionUpdate):n.subscriptionPermissionUpdate=void 0,n.refreshToken=null!==(i=e.refreshToken)&&void 0!==i?i:void 0,void 0!==e.trackUnpublished&&null!==e.trackUnpublished?n.trackUnpublished=t.TrackUnpublishedResponse.fromPartial(e.trackUnpublished):n.trackUnpublished=void 0,n}};const h={cid:"",name:"",type:0,width:0,height:0,muted:!1,disableDtx:!1,source:0};t.AddTrackRequest={encode(e,t=o.default.Writer.create()){""!==e.cid&&t.uint32(10).string(e.cid),""!==e.name&&t.uint32(18).string(e.name),0!==e.type&&t.uint32(24).int32(e.type),0!==e.width&&t.uint32(32).uint32(e.width),0!==e.height&&t.uint32(40).uint32(e.height),!0===e.muted&&t.uint32(48).bool(e.muted),!0===e.disableDtx&&t.uint32(56).bool(e.disableDtx),0!==e.source&&t.uint32(64).int32(e.source);for(const i of e.layers)s.VideoLayer.encode(i,t.uint32(74).fork()).ldelim();return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},h);for(a.layers=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.cid=i.string();break;case 2:a.name=i.string();break;case 3:a.type=i.int32();break;case 4:a.width=i.uint32();break;case 5:a.height=i.uint32();break;case 6:a.muted=i.bool();break;case 7:a.disableDtx=i.bool();break;case 8:a.source=i.int32();break;case 9:a.layers.push(s.VideoLayer.decode(i,i.uint32()));break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},h);if(t.layers=[],void 0!==e.cid&&null!==e.cid?t.cid=String(e.cid):t.cid="",void 0!==e.name&&null!==e.name?t.name=String(e.name):t.name="",void 0!==e.type&&null!==e.type?t.type=s.trackTypeFromJSON(e.type):t.type=0,void 0!==e.width&&null!==e.width?t.width=Number(e.width):t.width=0,void 0!==e.height&&null!==e.height?t.height=Number(e.height):t.height=0,void 0!==e.muted&&null!==e.muted?t.muted=Boolean(e.muted):t.muted=!1,void 0!==e.disableDtx&&null!==e.disableDtx?t.disableDtx=Boolean(e.disableDtx):t.disableDtx=!1,void 0!==e.source&&null!==e.source?t.source=s.trackSourceFromJSON(e.source):t.source=0,void 0!==e.layers&&null!==e.layers)for(const i of e.layers)t.layers.push(s.VideoLayer.fromJSON(i));return t},toJSON(e){const t={};return void 0!==e.cid&&(t.cid=e.cid),void 0!==e.name&&(t.name=e.name),void 0!==e.type&&(t.type=s.trackTypeToJSON(e.type)),void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),void 0!==e.muted&&(t.muted=e.muted),void 0!==e.disableDtx&&(t.disableDtx=e.disableDtx),void 0!==e.source&&(t.source=s.trackSourceToJSON(e.source)),e.layers?t.layers=e.layers.map((e=>e?s.VideoLayer.toJSON(e):void 0)):t.layers=[],t},fromPartial(e){var t,i,n,a,o,c,u,l;const p=Object.assign({},h);if(p.cid=null!==(t=e.cid)&&void 0!==t?t:"",p.name=null!==(i=e.name)&&void 0!==i?i:"",p.type=null!==(n=e.type)&&void 0!==n?n:0,p.width=null!==(a=e.width)&&void 0!==a?a:0,p.height=null!==(o=e.height)&&void 0!==o?o:0,p.muted=null!==(c=e.muted)&&void 0!==c&&c,p.disableDtx=null!==(u=e.disableDtx)&&void 0!==u&&u,p.source=null!==(l=e.source)&&void 0!==l?l:0,p.layers=[],void 0!==e.layers&&null!==e.layers)for(const t of e.layers)p.layers.push(s.VideoLayer.fromPartial(t));return p}};const m={candidateInit:"",target:0};t.TrickleRequest={encode:(e,t=o.default.Writer.create())=>(""!==e.candidateInit&&t.uint32(10).string(e.candidateInit),0!==e.target&&t.uint32(16).int32(e.target),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},m);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.candidateInit=i.string();break;case 2:a.target=i.int32();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},m);return void 0!==e.candidateInit&&null!==e.candidateInit?t.candidateInit=String(e.candidateInit):t.candidateInit="",void 0!==e.target&&null!==e.target?t.target=signalTargetFromJSON(e.target):t.target=0,t},toJSON(e){const t={};return void 0!==e.candidateInit&&(t.candidateInit=e.candidateInit),void 0!==e.target&&(t.target=signalTargetToJSON(e.target)),t},fromPartial(e){var t,i;const n=Object.assign({},m);return n.candidateInit=null!==(t=e.candidateInit)&&void 0!==t?t:"",n.target=null!==(i=e.target)&&void 0!==i?i:0,n}};const v={sid:"",muted:!1};t.MuteTrackRequest={encode:(e,t=o.default.Writer.create())=>(""!==e.sid&&t.uint32(10).string(e.sid),!0===e.muted&&t.uint32(16).bool(e.muted),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},v);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.sid=i.string();break;case 2:a.muted=i.bool();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},v);return void 0!==e.sid&&null!==e.sid?t.sid=String(e.sid):t.sid="",void 0!==e.muted&&null!==e.muted?t.muted=Boolean(e.muted):t.muted=!1,t},toJSON(e){const t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.muted&&(t.muted=e.muted),t},fromPartial(e){var t,i;const n=Object.assign({},v);return n.sid=null!==(t=e.sid)&&void 0!==t?t:"",n.muted=null!==(i=e.muted)&&void 0!==i&&i,n}};const g={serverVersion:"",subscriberPrimary:!1,alternativeUrl:"",serverRegion:""};t.JoinResponse={encode(e,i=o.default.Writer.create()){void 0!==e.room&&s.Room.encode(e.room,i.uint32(10).fork()).ldelim(),void 0!==e.participant&&s.ParticipantInfo.encode(e.participant,i.uint32(18).fork()).ldelim();for(const t of e.otherParticipants)s.ParticipantInfo.encode(t,i.uint32(26).fork()).ldelim();""!==e.serverVersion&&i.uint32(34).string(e.serverVersion);for(const n of e.iceServers)t.ICEServer.encode(n,i.uint32(42).fork()).ldelim();return!0===e.subscriberPrimary&&i.uint32(48).bool(e.subscriberPrimary),""!==e.alternativeUrl&&i.uint32(58).string(e.alternativeUrl),void 0!==e.clientConfiguration&&s.ClientConfiguration.encode(e.clientConfiguration,i.uint32(66).fork()).ldelim(),""!==e.serverRegion&&i.uint32(74).string(e.serverRegion),i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const c=Object.assign({},g);for(c.otherParticipants=[],c.iceServers=[];n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:c.room=s.Room.decode(n,n.uint32());break;case 2:c.participant=s.ParticipantInfo.decode(n,n.uint32());break;case 3:c.otherParticipants.push(s.ParticipantInfo.decode(n,n.uint32()));break;case 4:c.serverVersion=n.string();break;case 5:c.iceServers.push(t.ICEServer.decode(n,n.uint32()));break;case 6:c.subscriberPrimary=n.bool();break;case 7:c.alternativeUrl=n.string();break;case 8:c.clientConfiguration=s.ClientConfiguration.decode(n,n.uint32());break;case 9:c.serverRegion=n.string();break;default:n.skipType(7&e)}}return c},fromJSON(e){const i=Object.assign({},g);if(i.otherParticipants=[],i.iceServers=[],void 0!==e.room&&null!==e.room?i.room=s.Room.fromJSON(e.room):i.room=void 0,void 0!==e.participant&&null!==e.participant?i.participant=s.ParticipantInfo.fromJSON(e.participant):i.participant=void 0,void 0!==e.otherParticipants&&null!==e.otherParticipants)for(const t of e.otherParticipants)i.otherParticipants.push(s.ParticipantInfo.fromJSON(t));if(void 0!==e.serverVersion&&null!==e.serverVersion?i.serverVersion=String(e.serverVersion):i.serverVersion="",void 0!==e.iceServers&&null!==e.iceServers)for(const n of e.iceServers)i.iceServers.push(t.ICEServer.fromJSON(n));return void 0!==e.subscriberPrimary&&null!==e.subscriberPrimary?i.subscriberPrimary=Boolean(e.subscriberPrimary):i.subscriberPrimary=!1,void 0!==e.alternativeUrl&&null!==e.alternativeUrl?i.alternativeUrl=String(e.alternativeUrl):i.alternativeUrl="",void 0!==e.clientConfiguration&&null!==e.clientConfiguration?i.clientConfiguration=s.ClientConfiguration.fromJSON(e.clientConfiguration):i.clientConfiguration=void 0,void 0!==e.serverRegion&&null!==e.serverRegion?i.serverRegion=String(e.serverRegion):i.serverRegion="",i},toJSON(e){const i={};return void 0!==e.room&&(i.room=e.room?s.Room.toJSON(e.room):void 0),void 0!==e.participant&&(i.participant=e.participant?s.ParticipantInfo.toJSON(e.participant):void 0),e.otherParticipants?i.otherParticipants=e.otherParticipants.map((e=>e?s.ParticipantInfo.toJSON(e):void 0)):i.otherParticipants=[],void 0!==e.serverVersion&&(i.serverVersion=e.serverVersion),e.iceServers?i.iceServers=e.iceServers.map((e=>e?t.ICEServer.toJSON(e):void 0)):i.iceServers=[],void 0!==e.subscriberPrimary&&(i.subscriberPrimary=e.subscriberPrimary),void 0!==e.alternativeUrl&&(i.alternativeUrl=e.alternativeUrl),void 0!==e.clientConfiguration&&(i.clientConfiguration=e.clientConfiguration?s.ClientConfiguration.toJSON(e.clientConfiguration):void 0),void 0!==e.serverRegion&&(i.serverRegion=e.serverRegion),i},fromPartial(e){var i,n,a,o;const c=Object.assign({},g);if(void 0!==e.room&&null!==e.room?c.room=s.Room.fromPartial(e.room):c.room=void 0,void 0!==e.participant&&null!==e.participant?c.participant=s.ParticipantInfo.fromPartial(e.participant):c.participant=void 0,c.otherParticipants=[],void 0!==e.otherParticipants&&null!==e.otherParticipants)for(const t of e.otherParticipants)c.otherParticipants.push(s.ParticipantInfo.fromPartial(t));if(c.serverVersion=null!==(i=e.serverVersion)&&void 0!==i?i:"",c.iceServers=[],void 0!==e.iceServers&&null!==e.iceServers)for(const i of e.iceServers)c.iceServers.push(t.ICEServer.fromPartial(i));return c.subscriberPrimary=null!==(n=e.subscriberPrimary)&&void 0!==n&&n,c.alternativeUrl=null!==(a=e.alternativeUrl)&&void 0!==a?a:"",void 0!==e.clientConfiguration&&null!==e.clientConfiguration?c.clientConfiguration=s.ClientConfiguration.fromPartial(e.clientConfiguration):c.clientConfiguration=void 0,c.serverRegion=null!==(o=e.serverRegion)&&void 0!==o?o:"",c}};const b={cid:""};t.TrackPublishedResponse={encode:(e,t=o.default.Writer.create())=>(""!==e.cid&&t.uint32(10).string(e.cid),void 0!==e.track&&s.TrackInfo.encode(e.track,t.uint32(18).fork()).ldelim(),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},b);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.cid=i.string();break;case 2:a.track=s.TrackInfo.decode(i,i.uint32());break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},b);return void 0!==e.cid&&null!==e.cid?t.cid=String(e.cid):t.cid="",void 0!==e.track&&null!==e.track?t.track=s.TrackInfo.fromJSON(e.track):t.track=void 0,t},toJSON(e){const t={};return void 0!==e.cid&&(t.cid=e.cid),void 0!==e.track&&(t.track=e.track?s.TrackInfo.toJSON(e.track):void 0),t},fromPartial(e){var t;const i=Object.assign({},b);return i.cid=null!==(t=e.cid)&&void 0!==t?t:"",void 0!==e.track&&null!==e.track?i.track=s.TrackInfo.fromPartial(e.track):i.track=void 0,i}};const k={trackSid:""};t.TrackUnpublishedResponse={encode:(e,t=o.default.Writer.create())=>(""!==e.trackSid&&t.uint32(10).string(e.trackSid),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},k);for(;i.pos<n;){const e=i.uint32();if(e>>>3==1)a.trackSid=i.string();else i.skipType(7&e)}return a},fromJSON(e){const t=Object.assign({},k);return void 0!==e.trackSid&&null!==e.trackSid?t.trackSid=String(e.trackSid):t.trackSid="",t},toJSON(e){const t={};return void 0!==e.trackSid&&(t.trackSid=e.trackSid),t},fromPartial(e){var t;const i=Object.assign({},k);return i.trackSid=null!==(t=e.trackSid)&&void 0!==t?t:"",i}};const S={type:"",sdp:""};t.SessionDescription={encode:(e,t=o.default.Writer.create())=>(""!==e.type&&t.uint32(10).string(e.type),""!==e.sdp&&t.uint32(18).string(e.sdp),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},S);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.type=i.string();break;case 2:a.sdp=i.string();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},S);return void 0!==e.type&&null!==e.type?t.type=String(e.type):t.type="",void 0!==e.sdp&&null!==e.sdp?t.sdp=String(e.sdp):t.sdp="",t},toJSON(e){const t={};return void 0!==e.type&&(t.type=e.type),void 0!==e.sdp&&(t.sdp=e.sdp),t},fromPartial(e){var t,i;const n=Object.assign({},S);return n.type=null!==(t=e.type)&&void 0!==t?t:"",n.sdp=null!==(i=e.sdp)&&void 0!==i?i:"",n}};const y={};t.ParticipantUpdate={encode(e,t=o.default.Writer.create()){for(const i of e.participants)s.ParticipantInfo.encode(i,t.uint32(10).fork()).ldelim();return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},y);for(a.participants=[];i.pos<n;){const e=i.uint32();if(e>>>3==1)a.participants.push(s.ParticipantInfo.decode(i,i.uint32()));else i.skipType(7&e)}return a},fromJSON(e){const t=Object.assign({},y);if(t.participants=[],void 0!==e.participants&&null!==e.participants)for(const i of e.participants)t.participants.push(s.ParticipantInfo.fromJSON(i));return t},toJSON(e){const t={};return e.participants?t.participants=e.participants.map((e=>e?s.ParticipantInfo.toJSON(e):void 0)):t.participants=[],t},fromPartial(e){const t=Object.assign({},y);if(t.participants=[],void 0!==e.participants&&null!==e.participants)for(const i of e.participants)t.participants.push(s.ParticipantInfo.fromPartial(i));return t}};const T={trackSids:"",subscribe:!1};t.UpdateSubscription={encode(e,t=o.default.Writer.create()){for(const i of e.trackSids)t.uint32(10).string(i);!0===e.subscribe&&t.uint32(16).bool(e.subscribe);for(const i of e.participantTracks)s.ParticipantTracks.encode(i,t.uint32(26).fork()).ldelim();return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},T);for(a.trackSids=[],a.participantTracks=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.trackSids.push(i.string());break;case 2:a.subscribe=i.bool();break;case 3:a.participantTracks.push(s.ParticipantTracks.decode(i,i.uint32()));break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},T);if(t.trackSids=[],t.participantTracks=[],void 0!==e.trackSids&&null!==e.trackSids)for(const i of e.trackSids)t.trackSids.push(String(i));if(void 0!==e.subscribe&&null!==e.subscribe?t.subscribe=Boolean(e.subscribe):t.subscribe=!1,void 0!==e.participantTracks&&null!==e.participantTracks)for(const i of e.participantTracks)t.participantTracks.push(s.ParticipantTracks.fromJSON(i));return t},toJSON(e){const t={};return e.trackSids?t.trackSids=e.trackSids.map((e=>e)):t.trackSids=[],void 0!==e.subscribe&&(t.subscribe=e.subscribe),e.participantTracks?t.participantTracks=e.participantTracks.map((e=>e?s.ParticipantTracks.toJSON(e):void 0)):t.participantTracks=[],t},fromPartial(e){var t;const i=Object.assign({},T);if(i.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const t of e.trackSids)i.trackSids.push(t);if(i.subscribe=null!==(t=e.subscribe)&&void 0!==t&&t,i.participantTracks=[],void 0!==e.participantTracks&&null!==e.participantTracks)for(const t of e.participantTracks)i.participantTracks.push(s.ParticipantTracks.fromPartial(t));return i}};const P={trackSids:"",disabled:!1,quality:0,width:0,height:0};t.UpdateTrackSettings={encode(e,t=o.default.Writer.create()){for(const i of e.trackSids)t.uint32(10).string(i);return!0===e.disabled&&t.uint32(24).bool(e.disabled),0!==e.quality&&t.uint32(32).int32(e.quality),0!==e.width&&t.uint32(40).uint32(e.width),0!==e.height&&t.uint32(48).uint32(e.height),t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},P);for(a.trackSids=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.trackSids.push(i.string());break;case 3:a.disabled=i.bool();break;case 4:a.quality=i.int32();break;case 5:a.width=i.uint32();break;case 6:a.height=i.uint32();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},P);if(t.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const i of e.trackSids)t.trackSids.push(String(i));return void 0!==e.disabled&&null!==e.disabled?t.disabled=Boolean(e.disabled):t.disabled=!1,void 0!==e.quality&&null!==e.quality?t.quality=s.videoQualityFromJSON(e.quality):t.quality=0,void 0!==e.width&&null!==e.width?t.width=Number(e.width):t.width=0,void 0!==e.height&&null!==e.height?t.height=Number(e.height):t.height=0,t},toJSON(e){const t={};return e.trackSids?t.trackSids=e.trackSids.map((e=>e)):t.trackSids=[],void 0!==e.disabled&&(t.disabled=e.disabled),void 0!==e.quality&&(t.quality=s.videoQualityToJSON(e.quality)),void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),t},fromPartial(e){var t,i,n,a;const o=Object.assign({},P);if(o.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const t of e.trackSids)o.trackSids.push(t);return o.disabled=null!==(t=e.disabled)&&void 0!==t&&t,o.quality=null!==(i=e.quality)&&void 0!==i?i:0,o.width=null!==(n=e.width)&&void 0!==n?n:0,o.height=null!==(a=e.height)&&void 0!==a?a:0,o}};const C={canReconnect:!1};t.LeaveRequest={encode:(e,t=o.default.Writer.create())=>(!0===e.canReconnect&&t.uint32(8).bool(e.canReconnect),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},C);for(;i.pos<n;){const e=i.uint32();if(e>>>3==1)a.canReconnect=i.bool();else i.skipType(7&e)}return a},fromJSON(e){const t=Object.assign({},C);return void 0!==e.canReconnect&&null!==e.canReconnect?t.canReconnect=Boolean(e.canReconnect):t.canReconnect=!1,t},toJSON(e){const t={};return void 0!==e.canReconnect&&(t.canReconnect=e.canReconnect),t},fromPartial(e){var t;const i=Object.assign({},C);return i.canReconnect=null!==(t=e.canReconnect)&&void 0!==t&&t,i}};const w={trackSid:""};t.UpdateVideoLayers={encode(e,t=o.default.Writer.create()){""!==e.trackSid&&t.uint32(10).string(e.trackSid);for(const i of e.layers)s.VideoLayer.encode(i,t.uint32(18).fork()).ldelim();return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},w);for(a.layers=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.trackSid=i.string();break;case 2:a.layers.push(s.VideoLayer.decode(i,i.uint32()));break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},w);if(t.layers=[],void 0!==e.trackSid&&null!==e.trackSid?t.trackSid=String(e.trackSid):t.trackSid="",void 0!==e.layers&&null!==e.layers)for(const i of e.layers)t.layers.push(s.VideoLayer.fromJSON(i));return t},toJSON(e){const t={};return void 0!==e.trackSid&&(t.trackSid=e.trackSid),e.layers?t.layers=e.layers.map((e=>e?s.VideoLayer.toJSON(e):void 0)):t.layers=[],t},fromPartial(e){var t;const i=Object.assign({},w);if(i.trackSid=null!==(t=e.trackSid)&&void 0!==t?t:"",i.layers=[],void 0!==e.layers&&null!==e.layers)for(const t of e.layers)i.layers.push(s.VideoLayer.fromPartial(t));return i}};const E={urls:"",username:"",credential:""};t.ICEServer={encode(e,t=o.default.Writer.create()){for(const i of e.urls)t.uint32(10).string(i);return""!==e.username&&t.uint32(18).string(e.username),""!==e.credential&&t.uint32(26).string(e.credential),t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},E);for(a.urls=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.urls.push(i.string());break;case 2:a.username=i.string();break;case 3:a.credential=i.string();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},E);if(t.urls=[],void 0!==e.urls&&null!==e.urls)for(const i of e.urls)t.urls.push(String(i));return void 0!==e.username&&null!==e.username?t.username=String(e.username):t.username="",void 0!==e.credential&&null!==e.credential?t.credential=String(e.credential):t.credential="",t},toJSON(e){const t={};return e.urls?t.urls=e.urls.map((e=>e)):t.urls=[],void 0!==e.username&&(t.username=e.username),void 0!==e.credential&&(t.credential=e.credential),t},fromPartial(e){var t,i;const n=Object.assign({},E);if(n.urls=[],void 0!==e.urls&&null!==e.urls)for(const t of e.urls)n.urls.push(t);return n.username=null!==(t=e.username)&&void 0!==t?t:"",n.credential=null!==(i=e.credential)&&void 0!==i?i:"",n}};const O={};t.SpeakersChanged={encode(e,t=o.default.Writer.create()){for(const i of e.speakers)s.SpeakerInfo.encode(i,t.uint32(10).fork()).ldelim();return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},O);for(a.speakers=[];i.pos<n;){const e=i.uint32();if(e>>>3==1)a.speakers.push(s.SpeakerInfo.decode(i,i.uint32()));else i.skipType(7&e)}return a},fromJSON(e){const t=Object.assign({},O);if(t.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const i of e.speakers)t.speakers.push(s.SpeakerInfo.fromJSON(i));return t},toJSON(e){const t={};return e.speakers?t.speakers=e.speakers.map((e=>e?s.SpeakerInfo.toJSON(e):void 0)):t.speakers=[],t},fromPartial(e){const t=Object.assign({},O);if(t.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const i of e.speakers)t.speakers.push(s.SpeakerInfo.fromPartial(i));return t}};const R={};t.RoomUpdate={encode:(e,t=o.default.Writer.create())=>(void 0!==e.room&&s.Room.encode(e.room,t.uint32(10).fork()).ldelim(),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},R);for(;i.pos<n;){const e=i.uint32();if(e>>>3==1)a.room=s.Room.decode(i,i.uint32());else i.skipType(7&e)}return a},fromJSON(e){const t=Object.assign({},R);return void 0!==e.room&&null!==e.room?t.room=s.Room.fromJSON(e.room):t.room=void 0,t},toJSON(e){const t={};return void 0!==e.room&&(t.room=e.room?s.Room.toJSON(e.room):void 0),t},fromPartial(e){const t=Object.assign({},R);return void 0!==e.room&&null!==e.room?t.room=s.Room.fromPartial(e.room):t.room=void 0,t}};const _={participantSid:"",quality:0,score:0};t.ConnectionQualityInfo={encode:(e,t=o.default.Writer.create())=>(""!==e.participantSid&&t.uint32(10).string(e.participantSid),0!==e.quality&&t.uint32(16).int32(e.quality),0!==e.score&&t.uint32(29).float(e.score),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},_);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.participantSid=i.string();break;case 2:a.quality=i.int32();break;case 3:a.score=i.float();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},_);return void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.quality&&null!==e.quality?t.quality=s.connectionQualityFromJSON(e.quality):t.quality=0,void 0!==e.score&&null!==e.score?t.score=Number(e.score):t.score=0,t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.quality&&(t.quality=s.connectionQualityToJSON(e.quality)),void 0!==e.score&&(t.score=e.score),t},fromPartial(e){var t,i,n;const a=Object.assign({},_);return a.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",a.quality=null!==(i=e.quality)&&void 0!==i?i:0,a.score=null!==(n=e.score)&&void 0!==n?n:0,a}};const N={};t.ConnectionQualityUpdate={encode(e,i=o.default.Writer.create()){for(const n of e.updates)t.ConnectionQualityInfo.encode(n,i.uint32(10).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},N);for(s.updates=[];n.pos<a;){const e=n.uint32();if(e>>>3==1)s.updates.push(t.ConnectionQualityInfo.decode(n,n.uint32()));else n.skipType(7&e)}return s},fromJSON(e){const i=Object.assign({},N);if(i.updates=[],void 0!==e.updates&&null!==e.updates)for(const n of e.updates)i.updates.push(t.ConnectionQualityInfo.fromJSON(n));return i},toJSON(e){const i={};return e.updates?i.updates=e.updates.map((e=>e?t.ConnectionQualityInfo.toJSON(e):void 0)):i.updates=[],i},fromPartial(e){const i=Object.assign({},N);if(i.updates=[],void 0!==e.updates&&null!==e.updates)for(const n of e.updates)i.updates.push(t.ConnectionQualityInfo.fromPartial(n));return i}};const D={participantSid:"",trackSid:"",state:0};t.StreamStateInfo={encode:(e,t=o.default.Writer.create())=>(""!==e.participantSid&&t.uint32(10).string(e.participantSid),""!==e.trackSid&&t.uint32(18).string(e.trackSid),0!==e.state&&t.uint32(24).int32(e.state),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},D);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.participantSid=i.string();break;case 2:a.trackSid=i.string();break;case 3:a.state=i.int32();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},D);return void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.trackSid&&null!==e.trackSid?t.trackSid=String(e.trackSid):t.trackSid="",void 0!==e.state&&null!==e.state?t.state=streamStateFromJSON(e.state):t.state=0,t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.trackSid&&(t.trackSid=e.trackSid),void 0!==e.state&&(t.state=streamStateToJSON(e.state)),t},fromPartial(e){var t,i,n;const a=Object.assign({},D);return a.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",a.trackSid=null!==(i=e.trackSid)&&void 0!==i?i:"",a.state=null!==(n=e.state)&&void 0!==n?n:0,a}};const L={};t.StreamStateUpdate={encode(e,i=o.default.Writer.create()){for(const n of e.streamStates)t.StreamStateInfo.encode(n,i.uint32(10).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},L);for(s.streamStates=[];n.pos<a;){const e=n.uint32();if(e>>>3==1)s.streamStates.push(t.StreamStateInfo.decode(n,n.uint32()));else n.skipType(7&e)}return s},fromJSON(e){const i=Object.assign({},L);if(i.streamStates=[],void 0!==e.streamStates&&null!==e.streamStates)for(const n of e.streamStates)i.streamStates.push(t.StreamStateInfo.fromJSON(n));return i},toJSON(e){const i={};return e.streamStates?i.streamStates=e.streamStates.map((e=>e?t.StreamStateInfo.toJSON(e):void 0)):i.streamStates=[],i},fromPartial(e){const i=Object.assign({},L);if(i.streamStates=[],void 0!==e.streamStates&&null!==e.streamStates)for(const n of e.streamStates)i.streamStates.push(t.StreamStateInfo.fromPartial(n));return i}};const I={quality:0,enabled:!1};t.SubscribedQuality={encode:(e,t=o.default.Writer.create())=>(0!==e.quality&&t.uint32(8).int32(e.quality),!0===e.enabled&&t.uint32(16).bool(e.enabled),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},I);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.quality=i.int32();break;case 2:a.enabled=i.bool();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},I);return void 0!==e.quality&&null!==e.quality?t.quality=s.videoQualityFromJSON(e.quality):t.quality=0,void 0!==e.enabled&&null!==e.enabled?t.enabled=Boolean(e.enabled):t.enabled=!1,t},toJSON(e){const t={};return void 0!==e.quality&&(t.quality=s.videoQualityToJSON(e.quality)),void 0!==e.enabled&&(t.enabled=e.enabled),t},fromPartial(e){var t,i;const n=Object.assign({},I);return n.quality=null!==(t=e.quality)&&void 0!==t?t:0,n.enabled=null!==(i=e.enabled)&&void 0!==i&&i,n}};const U={trackSid:""};t.SubscribedQualityUpdate={encode(e,i=o.default.Writer.create()){""!==e.trackSid&&i.uint32(10).string(e.trackSid);for(const n of e.subscribedQualities)t.SubscribedQuality.encode(n,i.uint32(18).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},U);for(s.subscribedQualities=[];n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:s.trackSid=n.string();break;case 2:s.subscribedQualities.push(t.SubscribedQuality.decode(n,n.uint32()));break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},U);if(i.subscribedQualities=[],void 0!==e.trackSid&&null!==e.trackSid?i.trackSid=String(e.trackSid):i.trackSid="",void 0!==e.subscribedQualities&&null!==e.subscribedQualities)for(const n of e.subscribedQualities)i.subscribedQualities.push(t.SubscribedQuality.fromJSON(n));return i},toJSON(e){const i={};return void 0!==e.trackSid&&(i.trackSid=e.trackSid),e.subscribedQualities?i.subscribedQualities=e.subscribedQualities.map((e=>e?t.SubscribedQuality.toJSON(e):void 0)):i.subscribedQualities=[],i},fromPartial(e){var i;const n=Object.assign({},U);if(n.trackSid=null!==(i=e.trackSid)&&void 0!==i?i:"",n.subscribedQualities=[],void 0!==e.subscribedQualities&&null!==e.subscribedQualities)for(const i of e.subscribedQualities)n.subscribedQualities.push(t.SubscribedQuality.fromPartial(i));return n}};const M={participantSid:"",allTracks:!1,trackSids:""};t.TrackPermission={encode(e,t=o.default.Writer.create()){""!==e.participantSid&&t.uint32(10).string(e.participantSid),!0===e.allTracks&&t.uint32(16).bool(e.allTracks);for(const i of e.trackSids)t.uint32(26).string(i);return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},M);for(a.trackSids=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.participantSid=i.string();break;case 2:a.allTracks=i.bool();break;case 3:a.trackSids.push(i.string());break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},M);if(t.trackSids=[],void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.allTracks&&null!==e.allTracks?t.allTracks=Boolean(e.allTracks):t.allTracks=!1,void 0!==e.trackSids&&null!==e.trackSids)for(const i of e.trackSids)t.trackSids.push(String(i));return t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.allTracks&&(t.allTracks=e.allTracks),e.trackSids?t.trackSids=e.trackSids.map((e=>e)):t.trackSids=[],t},fromPartial(e){var t,i;const n=Object.assign({},M);if(n.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",n.allTracks=null!==(i=e.allTracks)&&void 0!==i&&i,n.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const t of e.trackSids)n.trackSids.push(t);return n}};const x={allParticipants:!1};t.SubscriptionPermission={encode(e,i=o.default.Writer.create()){!0===e.allParticipants&&i.uint32(8).bool(e.allParticipants);for(const n of e.trackPermissions)t.TrackPermission.encode(n,i.uint32(18).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},x);for(s.trackPermissions=[];n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:s.allParticipants=n.bool();break;case 2:s.trackPermissions.push(t.TrackPermission.decode(n,n.uint32()));break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},x);if(i.trackPermissions=[],void 0!==e.allParticipants&&null!==e.allParticipants?i.allParticipants=Boolean(e.allParticipants):i.allParticipants=!1,void 0!==e.trackPermissions&&null!==e.trackPermissions)for(const n of e.trackPermissions)i.trackPermissions.push(t.TrackPermission.fromJSON(n));return i},toJSON(e){const i={};return void 0!==e.allParticipants&&(i.allParticipants=e.allParticipants),e.trackPermissions?i.trackPermissions=e.trackPermissions.map((e=>e?t.TrackPermission.toJSON(e):void 0)):i.trackPermissions=[],i},fromPartial(e){var i;const n=Object.assign({},x);if(n.allParticipants=null!==(i=e.allParticipants)&&void 0!==i&&i,n.trackPermissions=[],void 0!==e.trackPermissions&&null!==e.trackPermissions)for(const i of e.trackPermissions)n.trackPermissions.push(t.TrackPermission.fromPartial(i));return n}};const A={participantSid:"",trackSid:"",allowed:!1};t.SubscriptionPermissionUpdate={encode:(e,t=o.default.Writer.create())=>(""!==e.participantSid&&t.uint32(10).string(e.participantSid),""!==e.trackSid&&t.uint32(18).string(e.trackSid),!0===e.allowed&&t.uint32(24).bool(e.allowed),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},A);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.participantSid=i.string();break;case 2:a.trackSid=i.string();break;case 3:a.allowed=i.bool();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},A);return void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.trackSid&&null!==e.trackSid?t.trackSid=String(e.trackSid):t.trackSid="",void 0!==e.allowed&&null!==e.allowed?t.allowed=Boolean(e.allowed):t.allowed=!1,t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.trackSid&&(t.trackSid=e.trackSid),void 0!==e.allowed&&(t.allowed=e.allowed),t},fromPartial(e){var t,i,n;const a=Object.assign({},A);return a.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",a.trackSid=null!==(i=e.trackSid)&&void 0!==i?i:"",a.allowed=null!==(n=e.allowed)&&void 0!==n&&n,a}};const j={};t.SyncState={encode(e,i=o.default.Writer.create()){void 0!==e.answer&&t.SessionDescription.encode(e.answer,i.uint32(10).fork()).ldelim(),void 0!==e.subscription&&t.UpdateSubscription.encode(e.subscription,i.uint32(18).fork()).ldelim();for(const n of e.publishTracks)t.TrackPublishedResponse.encode(n,i.uint32(26).fork()).ldelim();for(const n of e.dataChannels)t.DataChannelInfo.encode(n,i.uint32(34).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let a=void 0===i?n.len:n.pos+i;const s=Object.assign({},j);for(s.publishTracks=[],s.dataChannels=[];n.pos<a;){const e=n.uint32();switch(e>>>3){case 1:s.answer=t.SessionDescription.decode(n,n.uint32());break;case 2:s.subscription=t.UpdateSubscription.decode(n,n.uint32());break;case 3:s.publishTracks.push(t.TrackPublishedResponse.decode(n,n.uint32()));break;case 4:s.dataChannels.push(t.DataChannelInfo.decode(n,n.uint32()));break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},j);if(i.publishTracks=[],i.dataChannels=[],void 0!==e.answer&&null!==e.answer?i.answer=t.SessionDescription.fromJSON(e.answer):i.answer=void 0,void 0!==e.subscription&&null!==e.subscription?i.subscription=t.UpdateSubscription.fromJSON(e.subscription):i.subscription=void 0,void 0!==e.publishTracks&&null!==e.publishTracks)for(const n of e.publishTracks)i.publishTracks.push(t.TrackPublishedResponse.fromJSON(n));if(void 0!==e.dataChannels&&null!==e.dataChannels)for(const n of e.dataChannels)i.dataChannels.push(t.DataChannelInfo.fromJSON(n));return i},toJSON(e){const i={};return void 0!==e.answer&&(i.answer=e.answer?t.SessionDescription.toJSON(e.answer):void 0),void 0!==e.subscription&&(i.subscription=e.subscription?t.UpdateSubscription.toJSON(e.subscription):void 0),e.publishTracks?i.publishTracks=e.publishTracks.map((e=>e?t.TrackPublishedResponse.toJSON(e):void 0)):i.publishTracks=[],e.dataChannels?i.dataChannels=e.dataChannels.map((e=>e?t.DataChannelInfo.toJSON(e):void 0)):i.dataChannels=[],i},fromPartial(e){const i=Object.assign({},j);if(void 0!==e.answer&&null!==e.answer?i.answer=t.SessionDescription.fromPartial(e.answer):i.answer=void 0,void 0!==e.subscription&&null!==e.subscription?i.subscription=t.UpdateSubscription.fromPartial(e.subscription):i.subscription=void 0,i.publishTracks=[],void 0!==e.publishTracks&&null!==e.publishTracks)for(const n of e.publishTracks)i.publishTracks.push(t.TrackPublishedResponse.fromPartial(n));if(i.dataChannels=[],void 0!==e.dataChannels&&null!==e.dataChannels)for(const n of e.dataChannels)i.dataChannels.push(t.DataChannelInfo.fromPartial(n));return i}};const J={label:"",id:0};t.DataChannelInfo={encode:(e,t=o.default.Writer.create())=>(""!==e.label&&t.uint32(10).string(e.label),0!==e.id&&t.uint32(16).uint32(e.id),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},J);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.label=i.string();break;case 2:a.id=i.uint32();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},J);return void 0!==e.label&&null!==e.label?t.label=String(e.label):t.label="",void 0!==e.id&&null!==e.id?t.id=Number(e.id):t.id=0,t},toJSON(e){const t={};return void 0!==e.label&&(t.label=e.label),void 0!==e.id&&(t.id=e.id),t},fromPartial(e){var t,i;const n=Object.assign({},J);return n.label=null!==(t=e.label)&&void 0!==t?t:"",n.id=null!==(i=e.id)&&void 0!==i?i:0,n}};const F={};t.SimulateScenario={encode:(e,t=o.default.Writer.create())=>(void 0!==e.speakerUpdate&&t.uint32(8).int32(e.speakerUpdate),void 0!==e.nodeFailure&&t.uint32(16).bool(e.nodeFailure),void 0!==e.migration&&t.uint32(24).bool(e.migration),void 0!==e.serverLeave&&t.uint32(32).bool(e.serverLeave),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const a=Object.assign({},F);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:a.speakerUpdate=i.int32();break;case 2:a.nodeFailure=i.bool();break;case 3:a.migration=i.bool();break;case 4:a.serverLeave=i.bool();break;default:i.skipType(7&e)}}return a},fromJSON(e){const t=Object.assign({},F);return void 0!==e.speakerUpdate&&null!==e.speakerUpdate?t.speakerUpdate=Number(e.speakerUpdate):t.speakerUpdate=void 0,void 0!==e.nodeFailure&&null!==e.nodeFailure?t.nodeFailure=Boolean(e.nodeFailure):t.nodeFailure=void 0,void 0!==e.migration&&null!==e.migration?t.migration=Boolean(e.migration):t.migration=void 0,void 0!==e.serverLeave&&null!==e.serverLeave?t.serverLeave=Boolean(e.serverLeave):t.serverLeave=void 0,t},toJSON(e){const t={};return void 0!==e.speakerUpdate&&(t.speakerUpdate=e.speakerUpdate),void 0!==e.nodeFailure&&(t.nodeFailure=e.nodeFailure),void 0!==e.migration&&(t.migration=e.migration),void 0!==e.serverLeave&&(t.serverLeave=e.serverLeave),t},fromPartial(e){var t,i,n,a;const o=Object.assign({},F);return o.speakerUpdate=null!==(t=e.speakerUpdate)&&void 0!==t?t:void 0,o.nodeFailure=null!==(i=e.nodeFailure)&&void 0!==i?i:void 0,o.migration=null!==(n=e.migration)&&void 0!==n?n:void 0,o.serverLeave=null!==(a=e.serverLeave)&&void 0!==a?a:void 0,o}},o.default.util.Long!==a.default&&(o.default.util.Long=a.default,o.default.configure())},1480:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n="default";class DeviceManager{static getInstance(){return void 0===this.instance&&(this.instance=new DeviceManager),this.instance}getDevices(e){return i(this,void 0,void 0,(function*(){let t=yield navigator.mediaDevices.enumerateDevices();if(t=t.filter((t=>t.kind===e)),t.length>1&&t[0].deviceId===n){const e=t[0];for(let i=1;i<t.length;i+=1)if(t[i].groupId===e.groupId){const e=t[0];t[0]=t[i],t[i]=e;break}return t.filter((t=>t!==e))}return t}))}normalizeDeviceId(e,t,a){return i(this,void 0,void 0,(function*(){if(t!==n)return t;const i=(yield this.getDevices(e)).find((e=>e.groupId===a&&e.deviceId!==n));return null==i?void 0:i.deviceId}))}}t.default=DeviceManager,DeviceManager.mediaDeviceKinds=["audioinput","audiooutput","videoinput"]},8974:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(2938),s=a(i(2662));t.default=class PCTransport{constructor(e){this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.negotiate=o.debounce((()=>{this.createAndSendOffer()}),100),this.pc=new RTCPeerConnection(e)}get isICEConnected(){return"connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState}addIceCandidate(e){return n(this,void 0,void 0,(function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)}))}setRemoteDescription(e){return n(this,void 0,void 0,(function*(){yield this.pc.setRemoteDescription(e),this.pendingCandidates.forEach((e=>{this.pc.addIceCandidate(e)})),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate&&(this.renegotiate=!1,this.createAndSendOffer())}))}createAndSendOffer(e){return n(this,void 0,void 0,(function*(){if(void 0===this.onOffer)return;if((null==e?void 0:e.iceRestart)&&(s.default.debug("restarting ICE"),this.restartingIce=!0),"have-local-offer"===this.pc.signalingState){const t=this.pc.remoteDescription;if(!(null==e?void 0:e.iceRestart)||!t)return void(this.renegotiate=!0);yield this.pc.setRemoteDescription(t)}else if("closed"===this.pc.signalingState)return void s.default.warn("could not createOffer with closed peer connection");s.default.debug("starting to negotiate");const t=yield this.pc.createOffer(e);yield this.pc.setLocalDescription(t),this.onOffer(t)}))}close(){this.pc.close()}}},8947:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.maxICEConnectTimeout=void 0;const o=i(7187),s=i(9286),c=a(i(2662)),u=i(8983),l=i(4658),p=i(7650),h=i(8911),m=a(i(8974)),v=i(1981),g="_lossy",b="_reliable";t.maxICEConnectTimeout=15e3;class RTCEngine extends o.EventEmitter{constructor(){super(),this.rtcConfig={},this.subscriberPrimary=!1,this.pcConnected=!1,this.isClosed=!0,this.pendingTrackResolvers={},this.hasPublished=!1,this.reconnectAttempts=0,this.reconnectStart=0,this.fullReconnectOnNext=!1,this.handleDataChannel=({channel:e})=>n(this,void 0,void 0,(function*(){if(e){if(e.label===b)this.reliableDCSub=e;else{if(e.label!==g)return;this.lossyDCSub=e}e.onmessage=this.handleDataMessage}})),this.handleDataMessage=e=>n(this,void 0,void 0,(function*(){let t;if(e.data instanceof ArrayBuffer)t=e.data;else{if(!(e.data instanceof Blob))return void c.default.error("unsupported data type",e.data);t=yield e.data.arrayBuffer()}const i=u.DataPacket.decode(new Uint8Array(t));i.speaker?this.emit(h.EngineEvent.ActiveSpeakersUpdate,i.speaker.speakers):i.user&&this.emit(h.EngineEvent.DataPacketReceived,i.user,i.kind)})),this.handleDataError=e=>{const t=0===e.currentTarget.maxRetransmits?"lossy":"reliable";if(e instanceof ErrorEvent){const{error:i}=e.error;c.default.error(`DataChannel error on ${t}: ${e.message}`,i)}else c.default.error(`Unknown DataChannel Error on ${t}`,e)},this.handleDisconnect=e=>{if(this.isClosed)return;c.default.debug(`${e} disconnected`),0===this.reconnectAttempts&&(this.reconnectStart=Date.now());const t=this.reconnectAttempts*this.reconnectAttempts*300;setTimeout((()=>n(this,void 0,void 0,(function*(){var e;if(!this.isClosed){(v.isFireFox()||(null===(e=this.clientConfiguration)||void 0===e?void 0:e.resumeConnection)===u.ClientConfigSetting.DISABLED)&&(this.fullReconnectOnNext=!0);try{this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(),this.reconnectAttempts=0,this.fullReconnectOnNext=!1}catch(e){this.reconnectAttempts+=1;let t=!0;e instanceof p.UnexpectedConnectionState?(c.default.debug("received unrecoverable error",e.message),t=!1):e instanceof SignalReconnectError||(this.fullReconnectOnNext=!0);const i=Date.now()-this.reconnectStart;(this.reconnectAttempts>=10||i>6e4)&&(t=!1),t?this.handleDisconnect("reconnect"):(c.default.info(`could not recover connection after 10 attempts, ${i}ms. giving up`),this.emit(h.EngineEvent.Disconnected),this.close())}}}))),t)},this.client=new s.SignalClient}join(e,t,i){return n(this,void 0,void 0,(function*(){this.url=e,this.token=t,this.signalOpts=i;const n=yield this.client.join(e,t,i);return this.isClosed=!1,this.subscriberPrimary=n.subscriberPrimary,this.publisher||this.configure(n),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=n.clientConfiguration,n}))}close(){this.isClosed=!0,this.removeAllListeners(),this.publisher&&"closed"!==this.publisher.pc.signalingState&&(this.publisher.pc.getSenders().forEach((e=>{var t,i;try{(null===(t=this.publisher)||void 0===t?void 0:t.pc.removeTrack)&&(null===(i=this.publisher)||void 0===i||i.pc.removeTrack(e))}catch(e){c.default.warn("could not removeTrack",e)}})),this.publisher.close(),this.publisher=void 0),this.subscriber&&(this.subscriber.close(),this.subscriber=void 0),this.client.close()}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new p.TrackInvalidError("a track with the same ID has already been published");return new Promise((t=>{this.pendingTrackResolvers[e.cid]=t,this.client.sendAddTrack(e)}))}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return null===(e=this.reliableDCSub)||void 0===e?void 0:e.readyState}get connectedServerAddress(){return this.connectedServerAddr}configure(e){if(this.publisher||this.subscriber)return;if(e.iceServers&&!this.rtcConfig.iceServers){const t=[];e.iceServers.forEach((e=>{const i={urls:e.urls};e.username&&(i.username=e.username),e.credential&&(i.credential=e.credential),t.push(i)})),this.rtcConfig.iceServers=t}this.rtcConfig.sdpSemantics="unified-plan",this.rtcConfig.continualGatheringPolicy="gather_continually",this.publisher=new m.default(this.rtcConfig),this.subscriber=new m.default(this.rtcConfig),this.emit(h.EngineEvent.TransportsCreated,this.publisher,this.subscriber),this.publisher.pc.onicecandidate=e=>{e.candidate&&(c.default.trace("adding ICE candidate for peer",e.candidate),this.client.sendIceCandidate(e.candidate,l.SignalTarget.PUBLISHER))},this.subscriber.pc.onicecandidate=e=>{e.candidate&&this.client.sendIceCandidate(e.candidate,l.SignalTarget.SUBSCRIBER)},this.publisher.onOffer=e=>{this.client.sendOffer(e)};let t=this.publisher.pc;e.subscriberPrimary&&(t=this.subscriber.pc,this.subscriber.pc.ondatachannel=this.handleDataChannel),this.primaryPC=t,t.onconnectionstatechange=()=>n(this,void 0,void 0,(function*(){if("connected"===t.connectionState){c.default.trace("pc connected");try{this.connectedServerAddr=yield function getConnectedAddress(e){var t;return n(this,void 0,void 0,(function*(){let i="";const n=new Map,a=new Map;if((yield e.getStats()).forEach((e=>{switch(e.type){case"transport":i=e.selectedCandidatePairId;break;case"candidate-pair":""===i&&e.selected&&(i=e.id),n.set(e.id,e);break;case"remote-candidate":a.set(e.id,`${e.address}:${e.port}`)}})),""===i)return;const o=null===(t=n.get(i))||void 0===t?void 0:t.remoteCandidateId;return void 0!==o?a.get(o):void 0}))}(t)}catch(e){c.default.warn("could not get connected server address",e)}this.pcConnected||(this.pcConnected=!0,this.emit(h.EngineEvent.Connected))}else"failed"===t.connectionState&&(c.default.trace("pc disconnected"),this.pcConnected&&(this.pcConnected=!1,this.handleDisconnect("peerconnection")))})),v.isWeb()?this.subscriber.pc.ontrack=e=>{this.emit(h.EngineEvent.MediaTrackAdded,e.track,e.streams[0],e.receiver)}:this.subscriber.pc.onaddstream=e=>{const t=e.stream.getTracks()[0];this.emit(h.EngineEvent.MediaTrackAdded,t,e.stream)},this.lossyDC=this.publisher.pc.createDataChannel(g,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.publisher.pc.createDataChannel(b,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.client.onAnswer=e=>n(this,void 0,void 0,(function*(){this.publisher&&(c.default.debug("received server answer",e.type,this.publisher.pc.signalingState),yield this.publisher.setRemoteDescription(e))})),this.client.onTrickle=(e,t)=>{this.publisher&&this.subscriber&&(c.default.trace("got ICE candidate from peer",e,t),t===l.SignalTarget.PUBLISHER?this.publisher.addIceCandidate(e):this.subscriber.addIceCandidate(e))},this.client.onOffer=e=>n(this,void 0,void 0,(function*(){if(!this.subscriber)return;c.default.debug("received server offer",e.type,this.subscriber.pc.signalingState),yield this.subscriber.setRemoteDescription(e);const t=yield this.subscriber.pc.createAnswer();yield this.subscriber.pc.setLocalDescription(t),this.client.sendAnswer(t)})),this.client.onLocalTrackPublished=e=>{c.default.debug("received trackPublishedResponse",e);const t=this.pendingTrackResolvers[e.cid];t?(delete this.pendingTrackResolvers[e.cid],t(e.track)):c.default.error("missing track resolver for ",e.cid)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onClose=()=>{this.handleDisconnect("signal")},this.client.onLeave=e=>{(null==e?void 0:e.canReconnect)?(this.fullReconnectOnNext=!0,this.primaryPC=void 0):(this.emit(h.EngineEvent.Disconnected),this.close())}}restartConnection(){var e,t;return n(this,void 0,void 0,(function*(){if(!this.url||!this.token)throw new p.UnexpectedConnectionState("could not reconnect, url or token not saved");let i;c.default.info("reconnecting, attempt",this.reconnectAttempts),0===this.reconnectAttempts&&this.emit(h.EngineEvent.Restarting),this.primaryPC=void 0,null===(e=this.publisher)||void 0===e||e.close(),this.publisher=void 0,null===(t=this.subscriber)||void 0===t||t.close(),this.subscriber=void 0;try{i=yield this.join(this.url,this.token,this.signalOpts)}catch(e){throw new SignalReconnectError}yield this.waitForPCConnected(),this.client.setReconnected(),this.emit(h.EngineEvent.Restarted,i)}))}resumeConnection(){return n(this,void 0,void 0,(function*(){if(!this.url||!this.token)throw new p.UnexpectedConnectionState("could not reconnect, url or token not saved");if(!this.publisher||!this.subscriber)throw new p.UnexpectedConnectionState("publisher and subscriber connections unset");c.default.info("resuming signal connection, attempt",this.reconnectAttempts),0===this.reconnectAttempts&&this.emit(h.EngineEvent.Resuming);try{yield this.client.reconnect(this.url,this.token)}catch(e){throw new SignalReconnectError}this.emit(h.EngineEvent.SignalResumed),this.subscriber.restartingIce=!0,this.hasPublished&&(yield this.publisher.createAndSendOffer({iceRestart:!0})),yield this.waitForPCConnected(),this.client.setReconnected(),this.emit(h.EngineEvent.Resumed)}))}waitForPCConnected(){var e;return n(this,void 0,void 0,(function*(){const i=(new Date).getTime();let n=i;for(this.pcConnected=!1;n-i<t.maxICEConnectTimeout&&void 0!==this.primaryPC;){if(n-i>1e3&&"connected"===(null===(e=this.primaryPC)||void 0===e?void 0:e.connectionState)&&(this.pcConnected=!0),this.pcConnected)return;yield v.sleep(100),n=(new Date).getTime()}throw new p.ConnectionError("could not establish PC connection")}))}sendDataPacket(e,t){return n(this,void 0,void 0,(function*(){const i=u.DataPacket.encode(e).finish();yield this.ensurePublisherConnected(t),t===u.DataPacket_Kind.LOSSY&&this.lossyDC?this.lossyDC.send(i):t===u.DataPacket_Kind.RELIABLE&&this.reliableDC&&this.reliableDC.send(i)}))}ensurePublisherConnected(e){var i,a;return n(this,void 0,void 0,(function*(){if(!this.subscriberPrimary)return;if(!this.publisher)throw new p.ConnectionError("publisher connection not set");this.publisher.isICEConnected||"checking"===this.publisher.pc.iceConnectionState||this.negotiate();const n=this.dataChannelForKind(e);if("open"===(null==n?void 0:n.readyState))return;const o=(new Date).getTime()+t.maxICEConnectTimeout;for(;(new Date).getTime()<o;){if(this.publisher.isICEConnected&&"open"===(null===(i=this.dataChannelForKind(e))||void 0===i?void 0:i.readyState))return;yield v.sleep(50)}throw new p.ConnectionError(`could not establish publisher connection, state ${null===(a=this.publisher)||void 0===a?void 0:a.pc.iceConnectionState}`)}))}negotiate(){this.publisher&&(this.hasPublished=!0,this.publisher.negotiate())}dataChannelForKind(e){return e===u.DataPacket_Kind.LOSSY?this.lossyDC:e===u.DataPacket_Kind.RELIABLE?this.reliableDC:void 0}}t.default=RTCEngine;class SignalReconnectError extends Error{}},3258:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},s=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RoomState=void 0;const u=i(7187),l=i(9286),p=c(i(2662)),h=i(8983),m=i(4658),v=c(i(1480)),g=i(7650),b=i(8911),k=c(i(4149)),S=c(i(1488)),y=o(i(8947)),T=i(1442),P=c(i(297)),C=i(410),w=i(9565),E=i(1981);var O;!function(e){e.Disconnected="disconnected",e.Connected="connected",e.Reconnecting="reconnecting"}(O=t.RoomState||(t.RoomState={}));class Room extends u.EventEmitter{constructor(e){super(),this.state=O.Disconnected,this.activeSpeakers=[],this.sid="",this.name="",this.metadata=void 0,this.audioEnabled=!0,this.connect=(e,t,i)=>s(this,void 0,void 0,(function*(){if(this.state===O.Disconnected){this.createEngine(),this.acquireAudioContext(),(null==i?void 0:i.rtcConfig)&&(this.engine.rtcConfig=i.rtcConfig),this.connOptions=i;try{const n=yield this.engine.join(e,t,i);if(p.default.debug(`connected to Livekit Server version: ${n.serverVersion}, region: ${n.serverRegion}`),!n.serverVersion)throw new g.UnsupportedServer("unknown server version");"0.15.1"===n.serverVersion&&this.options.dynacast&&(p.default.debug("disabling dynacast due to server version"),this.options.dynacast=!1),this.state=O.Connected,this.emit(b.RoomEvent.StateChanged,this.state);const a=n.participant;this.localParticipant.sid=a.sid,this.localParticipant.identity=a.identity,this.localParticipant.updateInfo(a),this.localParticipant.on(b.ParticipantEvent.MetadataChanged,(e=>{this.emit(b.RoomEvent.MetadataChanged,e,this.localParticipant)})).on(b.ParticipantEvent.ParticipantMetadataChanged,(e=>{this.emit(b.RoomEvent.ParticipantMetadataChanged,e,this.localParticipant)})).on(b.ParticipantEvent.TrackMuted,(e=>{this.emit(b.RoomEvent.TrackMuted,e,this.localParticipant)})).on(b.ParticipantEvent.TrackUnmuted,(e=>{this.emit(b.RoomEvent.TrackUnmuted,e,this.localParticipant)})).on(b.ParticipantEvent.LocalTrackPublished,(e=>{this.emit(b.RoomEvent.LocalTrackPublished,e,this.localParticipant)})).on(b.ParticipantEvent.LocalTrackUnpublished,(e=>{this.emit(b.RoomEvent.LocalTrackUnpublished,e,this.localParticipant)})).on(b.ParticipantEvent.ConnectionQualityChanged,(e=>{this.emit(b.RoomEvent.ConnectionQualityChanged,e,this.localParticipant)})).on(b.ParticipantEvent.MediaDevicesError,(e=>{this.emit(b.RoomEvent.MediaDevicesError,e)})).on(b.ParticipantEvent.ParticipantPermissionsChanged,(e=>{this.emit(b.RoomEvent.ParticipantPermissionsChanged,e,this.localParticipant)})),n.otherParticipants.forEach((e=>{this.getOrCreateParticipant(e.sid,e)})),this.name=n.room.name,this.sid=n.room.sid,this.metadata=n.room.metadata}catch(e){throw this.engine.close(),e}return new Promise(((e,t)=>{const i=setTimeout((()=>{this.engine.close(),t(new g.ConnectionError("could not connect after timeout"))}),y.maxICEConnectTimeout);this.engine.once(b.EngineEvent.Connected,(()=>{clearTimeout(i),E.isWeb()&&(window.addEventListener("beforeunload",this.onBeforeUnload),navigator.mediaDevices.addEventListener("devicechange",this.handleDeviceChange)),e(this)}))}))}p.default.warn("already connected to room",this.name)})),this.disconnect=(e=!0)=>{this.engine&&(this.engine.client.sendLeave(),this.engine.close()),this.handleDisconnect(e),this.engine=void 0},this.onBeforeUnload=()=>{this.disconnect()},this.handleRestarting=()=>{this.state=O.Reconnecting,this.emit(b.RoomEvent.Reconnecting),this.emit(b.RoomEvent.StateChanged,this.state);for(const e of this.participants.values())this.handleParticipantDisconnected(e.sid,e)},this.handleRestarted=e=>s(this,void 0,void 0,(function*(){p.default.debug("reconnected to server region",e.serverRegion),this.state=O.Connected,this.emit(b.RoomEvent.Reconnected),this.emit(b.RoomEvent.StateChanged,this.state),e.participant&&(this.localParticipant.sid=e.participant.sid,this.handleParticipantUpdates([e.participant])),this.handleParticipantUpdates(e.otherParticipants);const t=[];this.localParticipant.tracks.forEach((e=>{e.track&&t.push(e)})),yield Promise.all(t.map((e=>s(this,void 0,void 0,(function*(){const t=e.track;this.localParticipant.unpublishTrack(t,!1),this.localParticipant.publishTrack(t,e.options)})))))})),this.handleParticipantUpdates=e=>{e.forEach((e=>{if(e.sid===this.localParticipant.sid||e.identity===this.localParticipant.identity)return void this.localParticipant.updateInfo(e);let t=this.participants.get(e.sid);const i=!t;t=this.getOrCreateParticipant(e.sid,e),e.state===h.ParticipantInfo_State.DISCONNECTED?this.handleParticipantDisconnected(e.sid,t):i?this.emit(b.RoomEvent.ParticipantConnected,t):t.updateInfo(e)}))},this.handleActiveSpeakersUpdate=e=>{const t=[],i={};e.forEach((e=>{if(i[e.sid]=!0,e.sid===this.localParticipant.sid)this.localParticipant.audioLevel=e.level,this.localParticipant.setIsSpeaking(!0),t.push(this.localParticipant);else{const i=this.participants.get(e.sid);i&&(i.audioLevel=e.level,i.setIsSpeaking(!0),t.push(i))}})),i[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach((e=>{i[e.sid]||(e.audioLevel=0,e.setIsSpeaking(!1))})),this.activeSpeakers=t,this.emit(b.RoomEvent.ActiveSpeakersChanged,t)},this.handleSpeakersChanged=e=>{const t=new Map;this.activeSpeakers.forEach((e=>{t.set(e.sid,e)})),e.forEach((e=>{let i=this.participants.get(e.sid);e.sid===this.localParticipant.sid&&(i=this.localParticipant),i&&(i.audioLevel=e.level,i.setIsSpeaking(e.active),e.active?t.set(e.sid,i):t.delete(e.sid))}));const i=Array.from(t.values());i.sort(((e,t)=>t.audioLevel-e.audioLevel)),this.activeSpeakers=i,this.emit(b.RoomEvent.ActiveSpeakersChanged,i)},this.handleStreamStateUpdate=e=>{e.streamStates.forEach((e=>{const t=this.participants.get(e.participantSid);if(!t)return;const i=t.getTrackPublication(e.trackSid);i&&i.track&&(i.track.streamState=C.Track.streamStateFromProto(e.state),t.emit(b.ParticipantEvent.TrackStreamStateChanged,i,i.track.streamState),this.emit(b.ParticipantEvent.TrackStreamStateChanged,i,i.track.streamState,t))}))},this.handleSubscriptionPermissionUpdate=e=>{const t=this.participants.get(e.participantSid);if(!t)return;const i=t.getTrackPublication(e.trackSid);i&&(i._allowed=e.allowed,t.emit(b.ParticipantEvent.TrackSubscriptionPermissionChanged,i,i.subscriptionStatus),this.emit(b.ParticipantEvent.TrackSubscriptionPermissionChanged,i,i.subscriptionStatus,t))},this.handleDataPacket=(e,t)=>{const i=this.participants.get(e.participantSid);this.emit(b.RoomEvent.DataReceived,e.payload,i,t),null==i||i.emit(b.ParticipantEvent.DataReceived,e.payload,t)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(b.RoomEvent.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=e=>{p.default.warn("could not playback audio",e),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(b.RoomEvent.AudioPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>s(this,void 0,void 0,(function*(){this.emit(b.RoomEvent.MediaDevicesChanged)})),this.handleRoomUpdate=e=>{this.metadata=e.metadata,this.emit(b.RoomEvent.RoomMetadataChanged,e.metadata)},this.handleConnectionQualityUpdate=e=>{e.updates.forEach((e=>{if(e.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(e.quality);const t=this.participants.get(e.participantSid);t&&t.setConnectionQuality(e.quality)}))},this.participants=new Map,this.options=e||{},this.options.audioCaptureDefaults=Object.assign(Object.assign({},T.audioDefaults),null==e?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},T.videoDefaults),null==e?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},T.publishDefaults),null==e?void 0:e.publishDefaults),this.createEngine(),this.localParticipant=new k.default("","",this.engine,this.options)}createEngine(){this.engine||(this.engine=new y.default,this.engine.client.signalLatency=this.options.expSignalLatency,this.engine.client.onParticipantUpdate=this.handleParticipantUpdates,this.engine.client.onRoomUpdate=this.handleRoomUpdate,this.engine.client.onSpeakersChanged=this.handleSpeakersChanged,this.engine.client.onStreamStateUpdate=this.handleStreamStateUpdate,this.engine.client.onSubscriptionPermissionUpdate=this.handleSubscriptionPermissionUpdate,this.engine.client.onConnectionQuality=this.handleConnectionQualityUpdate,this.engine.on(b.EngineEvent.MediaTrackAdded,((e,t,i)=>{this.onTrackAdded(e,t,i)})).on(b.EngineEvent.Disconnected,(()=>{this.handleDisconnect()})).on(b.EngineEvent.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(b.EngineEvent.DataPacketReceived,this.handleDataPacket).on(b.EngineEvent.Resuming,(()=>{this.state=O.Reconnecting,this.emit(b.RoomEvent.Reconnecting),this.emit(b.RoomEvent.StateChanged,this.state)})).on(b.EngineEvent.Resumed,(()=>{this.state=O.Connected,this.emit(b.RoomEvent.Reconnected),this.emit(b.RoomEvent.StateChanged,this.state),this.updateSubscriptions()})).on(b.EngineEvent.SignalResumed,(()=>{this.state===O.Reconnecting&&this.sendSyncState()})).on(b.EngineEvent.Restarting,this.handleRestarting).on(b.EngineEvent.Restarted,this.handleRestarted))}static getLocalDevices(e){return v.default.getInstance().getDevices(e)}getParticipantByIdentity(e){for(const[,t]of this.participants)if(t.identity===e)return t;if(this.localParticipant.identity===e)return this.localParticipant}simulateScenario(e){let t;switch(e){case"speaker":t=m.SimulateScenario.fromPartial({speakerUpdate:3});break;case"node-failure":t=m.SimulateScenario.fromPartial({nodeFailure:!0});break;case"server-leave":t=m.SimulateScenario.fromPartial({serverLeave:!0});break;case"migration":t=m.SimulateScenario.fromPartial({migration:!0})}t&&this.engine.client.sendSimulateScenario(t)}startAudio(){return s(this,void 0,void 0,(function*(){this.acquireAudioContext();const e=[];this.participants.forEach((t=>{t.audioTracks.forEach((t=>{t.track&&t.track.attachedElements.forEach((t=>{e.push(t)}))}))}));try{yield Promise.all(e.map((e=>e.play()))),this.handleAudioPlaybackStarted()}catch(e){throw this.handleAudioPlaybackFailed(e),e}}))}get canPlaybackAudio(){return this.audioEnabled}switchActiveDevice(e,t){return s(this,void 0,void 0,(function*(){if("audioinput"===e){const e=Array.from(this.localParticipant.audioTracks.values()).filter((e=>e.source===C.Track.Source.Microphone));yield Promise.all(e.map((e=>{var i;return null===(i=e.audioTrack)||void 0===i?void 0:i.setDeviceId(t)}))),this.options.audioCaptureDefaults.deviceId=t}else if("videoinput"===e){const e=Array.from(this.localParticipant.videoTracks.values()).filter((e=>e.source===C.Track.Source.Camera));yield Promise.all(e.map((e=>{var i;return null===(i=e.videoTrack)||void 0===i?void 0:i.setDeviceId(t)}))),this.options.videoCaptureDefaults.deviceId=t}else if("audiooutput"===e){const e=[];this.participants.forEach((t=>{t.audioTracks.forEach((t=>{t.isSubscribed&&t.track&&t.track.attachedElements.forEach((t=>{e.push(t)}))}))})),yield Promise.all(e.map((e=>s(this,void 0,void 0,(function*(){"setSinkId"in e&&(yield e.setSinkId(t))})))))}}))}onTrackAdded(e,t,i){const n=E.unpackStreamId(t.id),a=n[0];let o=n[1];o&&""!==o||(o=e.id);const s=this.getOrCreateParticipant(a);let c;this.options.adaptiveStream&&(c="object"==typeof this.options.adaptiveStream?this.options.adaptiveStream:{}),s.addSubscribedMediaTrack(e,o,t,i,c)}handleDisconnect(e=!0){this.state!==O.Disconnected&&(this.participants.forEach((e=>{e.tracks.forEach((t=>{e.unpublishTrack(t.trackSid)}))})),this.localParticipant.tracks.forEach((t=>{var i,n;t.track&&this.localParticipant.unpublishTrack(t.track),e&&(null===(i=t.track)||void 0===i||i.detach(),null===(n=t.track)||void 0===n||n.stop())})),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&(this.audioContext.close(),this.audioContext=void 0),E.isWeb()&&(window.removeEventListener("beforeunload",this.onBeforeUnload),navigator.mediaDevices.removeEventListener("devicechange",this.handleDeviceChange)),this.state=O.Disconnected,this.emit(b.RoomEvent.Disconnected),this.emit(b.RoomEvent.StateChanged,this.state))}handleParticipantDisconnected(e,t){this.participants.delete(e),t&&(t.tracks.forEach((e=>{t.unpublishTrack(e.trackSid)})),this.emit(b.RoomEvent.ParticipantDisconnected,t))}acquireAudioContext(){this.audioContext&&this.audioContext.close();const e=w.getNewAudioContext();e&&(this.audioContext=e)}createParticipant(e,t){let i;return i=t?S.default.fromParticipantInfo(this.engine.client,t):new S.default(this.engine.client,e,""),i}getOrCreateParticipant(e,t){if(this.participants.has(e))return this.participants.get(e);const i=this.createParticipant(e,t);return this.participants.set(e,i),i.on(b.ParticipantEvent.TrackPublished,(e=>{this.emit(b.RoomEvent.TrackPublished,e,i)})).on(b.ParticipantEvent.TrackSubscribed,((e,t)=>{e.kind===C.Track.Kind.Audio&&(e.on(b.TrackEvent.AudioPlaybackStarted,this.handleAudioPlaybackStarted),e.on(b.TrackEvent.AudioPlaybackFailed,this.handleAudioPlaybackFailed)),this.emit(b.RoomEvent.TrackSubscribed,e,t,i)})).on(b.ParticipantEvent.TrackUnpublished,(e=>{this.emit(b.RoomEvent.TrackUnpublished,e,i)})).on(b.ParticipantEvent.TrackUnsubscribed,((e,t)=>{this.emit(b.RoomEvent.TrackUnsubscribed,e,t,i)})).on(b.ParticipantEvent.TrackSubscriptionFailed,(e=>{this.emit(b.RoomEvent.TrackSubscriptionFailed,e,i)})).on(b.ParticipantEvent.TrackMuted,(e=>{this.emit(b.RoomEvent.TrackMuted,e,i)})).on(b.ParticipantEvent.TrackUnmuted,(e=>{this.emit(b.RoomEvent.TrackUnmuted,e,i)})).on(b.ParticipantEvent.MetadataChanged,(e=>{this.emit(b.RoomEvent.MetadataChanged,e,i)})).on(b.ParticipantEvent.ParticipantMetadataChanged,(e=>{this.emit(b.RoomEvent.ParticipantMetadataChanged,e,i)})).on(b.ParticipantEvent.ConnectionQualityChanged,(e=>{this.emit(b.RoomEvent.ConnectionQualityChanged,e,i)})).on(b.ParticipantEvent.ParticipantPermissionsChanged,(e=>{this.emit(b.RoomEvent.ParticipantPermissionsChanged,e,i)})),i}sendSyncState(){var e;if(void 0===this.engine.subscriber||null===this.engine.subscriber.pc.localDescription)return;const t=this.engine.subscriber.pc.localDescription,i=(null===(e=this.connOptions)||void 0===e?void 0:e.autoSubscribe)||!1,n=new Array;this.participants.forEach((e=>{e.tracks.forEach((e=>{e.isSubscribed!==i&&n.push(e.trackSid)}))})),this.engine.client.sendSyncState({answer:l.toProtoSessionDescription({sdp:t.sdp,type:t.type}),subscription:{trackSids:n,subscribe:!i,participantTracks:[]},publishTracks:this.localParticipant.publishedTracksInfo(),dataChannels:this.localParticipant.dataChannelsInfo()})}updateSubscriptions(){for(const e of this.participants.values())for(const t of e.videoTracks.values())t.isSubscribed&&t instanceof P.default&&t.emitTrackUpdate()}emit(e,...t){return p.default.debug("room event",e,...t),super.emit(e,...t)}}t.default=Room},7650:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaDeviceFailure=t.PublishDataError=t.UnexpectedConnectionState=t.UnsupportedServer=t.TrackInvalidError=t.ConnectionError=t.LivekitError=void 0;class LivekitError extends Error{constructor(e,t){super(t||"an error has occured"),this.code=e}}t.LivekitError=LivekitError;t.ConnectionError=class ConnectionError extends LivekitError{constructor(e){super(1,e)}};t.TrackInvalidError=class TrackInvalidError extends LivekitError{constructor(e){super(20,e||"Track is invalid")}};t.UnsupportedServer=class UnsupportedServer extends LivekitError{constructor(e){super(10,e||"Unsupported server")}};t.UnexpectedConnectionState=class UnexpectedConnectionState extends LivekitError{constructor(e){super(12,e||"Unexpected connection state")}};t.PublishDataError=class PublishDataError extends LivekitError{constructor(e){super(13,e||"Unable to publish data")}},function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(t.MediaDeviceFailure||(t.MediaDeviceFailure={})),function(e){e.getFailure=function getFailure(t){if(t&&"name"in t)return"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?e.NotFound:"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?e.PermissionDenied:"NotReadableError"===t.name||"TrackStartError"===t.name?e.DeviceInUse:e.Other}}(t.MediaDeviceFailure||(t.MediaDeviceFailure={}))},8911:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackEvent=t.EngineEvent=t.ParticipantEvent=t.RoomEvent=void 0,function(e){e.Reconnecting="reconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.StateChanged="stateChanged",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.ActiveSpeakersChanged="activeSpeakersChanged",e.MetadataChanged="metadataChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged"}(t.RoomEvent||(t.RoomEvent={})),function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.MetadataChanged="metadataChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.DataReceived="dataReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged"}(t.ParticipantEvent||(t.ParticipantEvent={})),function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived"}(t.EngineEvent||(t.EngineEvent={})),function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Ended="ended",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.AudioSilenceDetected="audioSilenceDetected",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged"}(t.TrackEvent||(t.TrackEvent={}))},4149:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return a(t,e),t},s=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const u=c(i(2662)),l=i(8983),p=i(4658),h=i(7650),m=i(8911),v=c(i(8669)),g=c(i(170)),b=o(i(6887)),k=i(6669),S=i(410),y=i(9565),T=i(1981),P=c(i(2070)),C=i(8792),w=i(5482),E=c(i(1488));class LocalParticipant extends P.default{constructor(e,t,i,n){super(e,t),this.pendingPublishing=new Set,this.onTrackUnmuted=e=>{this.onTrackMuted(e,!1)},this.onTrackMuted=(e,t)=>{void 0===t&&(t=!0),e.sid?this.engine.updateMuteStatus(e.sid,t):u.default.error("could not update mute status for unpublished track",e)},this.handleSubscribedQualityUpdate=e=>{var t,i;if(!(null===(t=this.roomOptions)||void 0===t?void 0:t.dynacast))return;const n=this.videoTracks.get(e.trackSid);n?null===(i=n.videoTrack)||void 0===i||i.setPublishingLayers(e.subscribedQualities):u.default.warn("handleSubscribedQualityUpdate","received subscribed quality update for unknown track",e.trackSid)},this.handleLocalTrackUnpublished=e=>{const t=this.tracks.get(e.trackSid);t?this.unpublishTrack(t.track):u.default.warn("handleLocalTrackUnpublished","received unpublished event for unknown track",e.trackSid)},this.onTrackUnpublish=e=>{this.unpublishTrack(e)},this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=i,this.roomOptions=n,this.engine.client.onRemoteMuteChanged=(e,t)=>{const i=this.tracks.get(e);i&&i.track&&(t?i.mute():i.unmute())},this.engine.client.onSubscribedQualityUpdate=this.handleSubscribedQualityUpdate,this.engine.client.onLocalTrackUnpublished=this.handleLocalTrackUnpublished}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setCameraEnabled(e){return this.setTrackEnabled(S.Track.Source.Camera,e)}setMicrophoneEnabled(e){return this.setTrackEnabled(S.Track.Source.Microphone,e)}setScreenShareEnabled(e){return this.setTrackEnabled(S.Track.Source.ScreenShare,e)}setPermissions(e){const t=this.permissions,i=super.setPermissions(e);return i&&t&&this.emit(m.ParticipantEvent.ParticipantPermissionsChanged,t),i}setTrackEnabled(e,t){return s(this,void 0,void 0,(function*(){u.default.debug("setTrackEnabled",e,t);const i=this.getTrack(e);if(t)if(i)yield i.unmute();else{let t;if(this.pendingPublishing.has(e))return void u.default.info("skipping duplicate published source",e);this.pendingPublishing.add(e);try{switch(e){case S.Track.Source.Camera:[t]=yield this.createTracks({video:!0});break;case S.Track.Source.Microphone:[t]=yield this.createTracks({audio:!0});break;case S.Track.Source.ScreenShare:[t]=yield this.createScreenTracks({audio:!1});break;default:throw new h.TrackInvalidError(e)}yield this.publishTrack(t)}catch(e){throw e instanceof Error&&!(e instanceof h.TrackInvalidError)&&this.emit(m.ParticipantEvent.MediaDevicesError,e),e}finally{this.pendingPublishing.delete(e)}}else i&&i.track&&(e===S.Track.Source.ScreenShare?this.unpublishTrack(i.track):yield i.mute())}))}enableCameraAndMicrophone(){return s(this,void 0,void 0,(function*(){if(!this.pendingPublishing.has(S.Track.Source.Camera)&&!this.pendingPublishing.has(S.Track.Source.Microphone)){this.pendingPublishing.add(S.Track.Source.Camera),this.pendingPublishing.add(S.Track.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map((e=>this.publishTrack(e))))}finally{this.pendingPublishing.delete(S.Track.Source.Camera),this.pendingPublishing.delete(S.Track.Source.Microphone)}}}))}createTracks(e){var t,i;return s(this,void 0,void 0,(function*(){const n=y.mergeDefaultOptions(e,null===(t=this.roomOptions)||void 0===t?void 0:t.audioCaptureDefaults,null===(i=this.roomOptions)||void 0===i?void 0:i.videoCaptureDefaults),a=y.constraintsForOptions(n);let o;try{o=yield navigator.mediaDevices.getUserMedia(a)}catch(e){throw e instanceof Error&&(a.audio&&(this.microphoneError=e),a.video&&(this.cameraError=e)),e}return a.audio&&(this.microphoneError=void 0),a.video&&(this.cameraError=void 0),o.getTracks().map((t=>{const i="audio"===t.kind;let n,s=i?e.audio:e.video;"boolean"!=typeof s&&s||(s={});const c=i?a.audio:a.video;"boolean"!=typeof c&&(n=c);const u=w.mediaTrackToLocalTrack(t,n);return u.kind===S.Track.Kind.Video?u.source=S.Track.Source.Camera:u.kind===S.Track.Kind.Audio&&(u.source=S.Track.Source.Microphone),u.mediaStream=o,u}))}))}createScreenTracks(e){var t;return s(this,void 0,void 0,(function*(){void 0===e&&(e={}),void 0===e.resolution&&(e.resolution=k.ScreenSharePresets.h1080fps15.resolution);let i=!0;e.resolution&&(i={width:e.resolution.width,height:e.resolution.height,frameRate:e.resolution.frameRate});const n=yield navigator.mediaDevices.getDisplayMedia({audio:null!==(t=e.audio)&&void 0!==t&&t,video:i}),a=n.getVideoTracks();if(0===a.length)throw new h.TrackInvalidError("no video track found");const o=new b.default(a[0]);o.source=S.Track.Source.ScreenShare;const s=[o];if(n.getAudioTracks().length>0){const e=new v.default(n.getAudioTracks()[0]);e.source=S.Track.Source.ScreenShareAudio,s.push(e)}return s}))}publishTrack(e,t){var i,n,a,o,c,l;return s(this,void 0,void 0,(function*(){const s=Object.assign(Object.assign({},null===(i=this.roomOptions)||void 0===i?void 0:i.publishDefaults),t);if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new v.default(e);break;case"video":e=new b.default(e);break;default:throw new h.TrackInvalidError(`unsupported MediaStreamTrack kind ${e.kind}`)}let k;if(this.tracks.forEach((t=>{t.track&&t.track===e&&(k=t)})),k)return k;s.source&&(e.source=s.source),s.stopMicTrackOnMute&&e instanceof v.default&&(e.stopOnMute=!0),e.source===S.Track.Source.ScreenShare&&T.isFireFox()&&(s.simulcast=!1),e.on(m.TrackEvent.Muted,this.onTrackMuted),e.on(m.TrackEvent.Unmuted,this.onTrackUnmuted),e.on(m.TrackEvent.Ended,this.onTrackUnpublish);const y=p.AddTrackRequest.fromPartial({cid:e.mediaStreamTrack.id,name:null==t?void 0:t.name,type:S.Track.kindToProto(e.kind),muted:e.isMuted,source:S.Track.sourceToProto(e.source),disableDtx:!(null===(n=null==s?void 0:s.dtx)||void 0===n||n)});let P;if(e.kind===S.Track.Kind.Video){const t=e.mediaStreamTrack.getSettings(),i=null!==(a=t.width)&&void 0!==a?a:null===(o=e.dimensions)||void 0===o?void 0:o.width,n=null!==(c=t.height)&&void 0!==c?c:null===(l=e.dimensions)||void 0===l?void 0:l.height;y.width=null!=i?i:0,y.height=null!=n?n:0,P=w.computeVideoEncodings(e.source===S.Track.Source.ScreenShare,i,n,s),y.layers=b.videoLayersFromEncodings(y.width,y.height,P)}else e.kind===S.Track.Kind.Audio&&s.audioBitrate&&(P=[{maxBitrate:s.audioBitrate}]);const C=yield this.engine.addTrack(y),E=new g.default(e.kind,C,e);if(e.sid=C.sid,!this.engine.publisher)throw new h.UnexpectedConnectionState("publisher is closed");u.default.debug(`publishing ${e.kind} with encodings`,P,C);const O={direction:"sendonly"};P&&(O.sendEncodings=P);const R=this.engine.publisher.pc.addTransceiver(e.mediaStreamTrack,O);return this.engine.negotiate(),e.sender=R.sender,e instanceof b.default?e.startMonitor(this.engine.client):e instanceof v.default&&e.startMonitor(),s.videoCodec&&this.setPreferredCodec(R,e.kind,s.videoCodec),this.addTrackPublication(E),this.emit(m.ParticipantEvent.LocalTrackPublished,E),E}))}unpublishTrack(e,t){var i,n;const a=this.getPublicationForTrack(e);if(u.default.debug("unpublishTrack","unpublishing track",e),!a||!a.track)return u.default.warn("unpublishTrack","track was not unpublished because no publication was found",e),null;(e=a.track).off(m.TrackEvent.Muted,this.onTrackMuted),e.off(m.TrackEvent.Unmuted,this.onTrackUnmuted),e.off(m.TrackEvent.Ended,this.onTrackUnpublish),void 0===t&&(t=null===(n=null===(i=this.roomOptions)||void 0===i?void 0:i.stopLocalTrackOnUnpublish)||void 0===n||n),t&&e.stop();const{mediaStreamTrack:o}=e;if(this.engine.publisher){this.engine.publisher.pc.getSenders().forEach((e=>{var t;if(e.track===o)try{null===(t=this.engine.publisher)||void 0===t||t.pc.removeTrack(e),this.engine.negotiate()}catch(e){u.default.warn("unpublishTrack","failed to remove track",e)}}))}switch(this.tracks.delete(a.trackSid),a.kind){case S.Track.Kind.Audio:this.audioTracks.delete(a.trackSid);break;case S.Track.Kind.Video:this.videoTracks.delete(a.trackSid)}return a.setTrack(void 0),this.emit(m.ParticipantEvent.LocalTrackUnpublished,a),a}unpublishTracks(e){const t=[];return e.forEach((e=>{const i=this.unpublishTrack(e);i&&t.push(i)})),t}publishData(e,t,i){return s(this,void 0,void 0,(function*(){const n=[];void 0!==i&&i.forEach((e=>{e instanceof E.default?n.push(e.sid):n.push(e)}));const a={kind:t,user:{participantSid:this.sid,payload:e,destinationSids:n}};yield this.engine.sendDataPacket(a,t)}))}setTrackSubscriptionPermissions(e,t=[]){this.engine.client.sendUpdateSubscriptionPermissions(e,t.map((e=>C.trackPermissionToProto(e))))}getPublicationForTrack(e){let t;return this.tracks.forEach((i=>{const n=i.track;n&&(e instanceof MediaStreamTrack?(n instanceof v.default||n instanceof b.default)&&n.mediaStreamTrack===e&&(t=i):e===n&&(t=i))})),t}setPreferredCodec(e,t,i){if(!("getCapabilities"in RTCRtpSender))return;const n=RTCRtpSender.getCapabilities(t);if(!n)return;const a=n.codecs.find((e=>{const t=e.mimeType.toLowerCase(),n=t===`video/${i}`;return"h264"===i&&e.sdpFmtpLine?n&&e.sdpFmtpLine.includes("profile-level-id=42e01f"):n||"audio/opus"===t}));a&&"setCodecPreferences"in e&&e.setCodecPreferences([a])}publishedTracksInfo(){const e=[];return this.tracks.forEach((t=>{void 0!==t.track&&e.push({cid:t.track.mediaStreamTrack.id,track:t.trackInfo})})),e}dataChannelsInfo(){const e=[],getInfo=t=>{void 0!==(null==t?void 0:t.id)&&null!==t.id&&e.push({label:t.label,id:t.id})};return getInfo(this.engine.dataChannelForKind(l.DataPacket_Kind.LOSSY)),getInfo(this.engine.dataChannelForKind(l.DataPacket_Kind.RELIABLE)),e}}t.default=LocalParticipant},2070:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionQuality=void 0;const n=i(7187),a=i(8983),o=i(8911),s=i(410);var c;!function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Unknown="unknown"}(c=t.ConnectionQuality||(t.ConnectionQuality={}));class Participant extends n.EventEmitter{constructor(e,t){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=c.Unknown,this.sid=e,this.identity=t,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){if(e!==s.Track.Source.Unknown)for(const[,t]of this.tracks){if(t.source===e)return t;if(t.source===s.Track.Source.Unknown){if(e===s.Track.Source.Microphone&&t.kind===s.Track.Kind.Audio&&"screen"!==t.trackName)return t;if(e===s.Track.Source.Camera&&t.kind===s.Track.Kind.Video&&"screen"!==t.trackName)return t;if(e===s.Track.Source.ScreenShare&&t.kind===s.Track.Kind.Video&&"screen"===t.trackName)return t;if(e===s.Track.Source.ScreenShareAudio&&t.kind===s.Track.Kind.Audio&&"screen"===t.trackName)return t}}}getTrackByName(e){for(const[,t]of this.tracks)if(t.trackName===e)return t}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrack(s.Track.Source.Camera);return!(null===(e=null==t?void 0:t.isMuted)||void 0===e||e)}get isMicrophoneEnabled(){var e;const t=this.getTrack(s.Track.Source.Microphone);return!(null===(e=null==t?void 0:t.isMuted)||void 0===e||e)}get isScreenShareEnabled(){return!!this.getTrack(s.Track.Source.ScreenShare)}get joinedAt(){return this.participantInfo?new Date(1e3*this.participantInfo.joinedAt):new Date}updateInfo(e){this.identity=e.identity,this.sid=e.sid,this.name=e.name,this.setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e}setMetadata(e){const t=this.metadata!==e,i=this.metadata;this.metadata=e,t&&(this.emit(o.ParticipantEvent.MetadataChanged,i),this.emit(o.ParticipantEvent.ParticipantMetadataChanged,i))}setPermissions(e){var t,i,n,a,o;const s=e.canPublish!==(null===(t=this.permissions)||void 0===t?void 0:t.canPublish)||e.canSubscribe!==(null===(i=this.permissions)||void 0===i?void 0:i.canSubscribe)||e.canPublishData!==(null===(n=this.permissions)||void 0===n?void 0:n.canPublishData)||e.hidden!==(null===(a=this.permissions)||void 0===a?void 0:a.hidden)||e.recorder!==(null===(o=this.permissions)||void 0===o?void 0:o.recorder);return this.permissions=e,s}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(o.ParticipantEvent.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=function qualityFromProto(e){switch(e){case a.ConnectionQuality.EXCELLENT:return c.Excellent;case a.ConnectionQuality.GOOD:return c.Good;case a.ConnectionQuality.POOR:return c.Poor;default:return c.Unknown}}(e),t!==this._connectionQuality&&this.emit(o.ParticipantEvent.ConnectionQualityChanged,this._connectionQuality)}addTrackPublication(e){e.on(o.TrackEvent.Muted,(()=>{this.emit(o.ParticipantEvent.TrackMuted,e)})),e.on(o.TrackEvent.Unmuted,(()=>{this.emit(o.ParticipantEvent.TrackUnmuted,e)}));const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case s.Track.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case s.Track.Kind.Video:this.videoTracks.set(e.trackSid,e)}}}t.default=Participant},8792:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackPermissionToProto=void 0,t.trackPermissionToProto=function trackPermissionToProto(e){var t;if(!e.participantSid)throw new Error("Invalid track permission, missing participantSid");return{participantSid:e.participantSid,allTracks:null!==(t=e.allowAll)&&void 0!==t&&t,trackSids:e.allowedTrackSids||[]}}},1488:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(i(2662)),o=i(8911),s=n(i(5941)),c=n(i(297)),u=n(i(466)),l=i(410),p=n(i(2070));class RemoteParticipant extends p.default{constructor(e,t,i){super(t,i||""),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map}static fromParticipantInfo(e,t){const i=new RemoteParticipant(e,t.sid,t.identity);return i.updateInfo(t),i}addTrackPublication(e){super.addTrackPublication(e),e.on(o.TrackEvent.UpdateSettings,(e=>{this.signalClient.sendUpdateTrackSettings(e)})),e.on(o.TrackEvent.UpdateSubscription,(e=>{e.participantTracks.forEach((e=>{e.participantSid=this.sid})),this.signalClient.sendUpdateSubscription(e)})),e.on(o.TrackEvent.Ended,(t=>{this.emit(o.ParticipantEvent.TrackUnsubscribed,t,e)}))}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}addSubscribedMediaTrack(e,t,i,n,c,l){let p=this.getTrackPublication(t);if(p||t.startsWith("TR")||this.tracks.forEach((t=>{p||e.kind!==t.kind.toString()||(p=t)})),!p)return 0===l?(a.default.error("could not find published track",this.sid,t),void this.emit(o.ParticipantEvent.TrackSubscriptionFailed,t)):(void 0===l&&(l=20),void setTimeout((()=>{this.addSubscribedMediaTrack(e,t,i,n,c,l-1)}),150));let h;return h="video"===e.kind?new u.default(e,t,n,c):new s.default(e,t,n),h.source=p.source,h.isMuted=p.isMuted,h.setMediaStream(i),h.start(),p.setTrack(h),this.emit(o.ParticipantEvent.TrackSubscribed,h,p),p}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){const t=this.hasMetadata;super.updateInfo(e);const i=new Map,n=new Map;e.tracks.forEach((e=>{let t=this.getTrackPublication(e.sid);if(t)t.updateInfo(e);else{const i=l.Track.kindFromProto(e.type);if(!i)return;t=new c.default(i,e.sid,e.name),t.updateInfo(e),n.set(e.sid,t),this.addTrackPublication(t)}i.set(e.sid,t)})),t&&n.forEach((e=>{this.emit(o.ParticipantEvent.TrackPublished,e)})),this.tracks.forEach((e=>{i.has(e.trackSid)||this.unpublishTrack(e.trackSid,!0)}))}unpublishTrack(e,t){const i=this.tracks.get(e);if(!i)return;switch(this.tracks.delete(e),i.kind){case l.Track.Kind.Audio:this.audioTracks.delete(e);break;case l.Track.Kind.Video:this.videoTracks.delete(e)}const{track:n}=i;if(n){const{isSubscribed:e}=i;n.stop(),i.setTrack(void 0),e&&this.emit(o.ParticipantEvent.TrackUnsubscribed,n,i)}t&&this.emit(o.ParticipantEvent.TrackUnpublished,i)}emit(e,...t){return a.default.trace("participant event",this.sid,e,...t),super.emit(e,...t)}}t.default=RemoteParticipant},5482:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.sortPresets=t.defaultSimulcastLayers=t.presetsForResolution=t.determineAppropriateEncoding=t.computeVideoEncodings=t.computeDefaultScreenShareSimulcastPresets=t.defaultSimulcastPresets43=t.defaultSimulcastPresets169=t.presetsScreenShare=t.presets43=t.presets169=t.mediaTrackToLocalTrack=void 0;const a=n(i(2662)),o=i(7650),s=n(i(8669)),c=n(i(6887)),u=i(6669);t.mediaTrackToLocalTrack=function mediaTrackToLocalTrack(e,t){switch(e.kind){case"audio":return new s.default(e,t);case"video":return new c.default(e,t);default:throw new o.TrackInvalidError(`unsupported track type: ${e.kind}`)}},t.presets169=Object.values(u.VideoPresets),t.presets43=Object.values(u.VideoPresets43),t.presetsScreenShare=Object.values(u.ScreenSharePresets),t.defaultSimulcastPresets169=[u.VideoPresets.h180,u.VideoPresets.h360],t.defaultSimulcastPresets43=[u.VideoPresets43.h180,u.VideoPresets43.h360];t.computeDefaultScreenShareSimulcastPresets=e=>[{scaleResolutionDownBy:2,fps:3}].map((t=>{var i;return new u.VideoPreset(Math.floor(e.width/t.scaleResolutionDownBy),Math.floor(e.height/t.scaleResolutionDownBy),Math.max(15e4,Math.floor(e.encoding.maxBitrate/(Math.pow(t.scaleResolutionDownBy,2)*((null!==(i=e.encoding.maxFramerate)&&void 0!==i?i:30)/t.fps)))),t.fps)}));const l=["q","h","f"];function determineAppropriateEncoding(e,t,i){const n=presetsForResolution(e,t,i);let{encoding:a}=n[0];const o=Math.max(t,i);for(let e=0;e<n.length;e+=1){const t=n[e];if(a=t.encoding,t.width>=o)break}return a}function presetsForResolution(e,i,n){if(e)return t.presetsScreenShare;const a=i>n?i/n:n/i;return Math.abs(a-16/9)<Math.abs(a-4/3)?t.presets169:t.presets43}function defaultSimulcastLayers(e,i){if(e)return t.computeDefaultScreenShareSimulcastPresets(i);const{width:n,height:a}=i,o=n>a?n/a:a/n;return Math.abs(o-16/9)<Math.abs(o-4/3)?t.defaultSimulcastPresets169:t.defaultSimulcastPresets43}function encodingsFromPresets(e,t,i){const n=[];return i.forEach(((i,a)=>{if(a>=l.length)return;const o=Math.min(e,t),s=l[a];n.push({rid:s,scaleResolutionDownBy:o/Math.min(i.width,i.height),maxBitrate:i.encoding.maxBitrate,maxFramerate:i.encoding.maxFramerate})})),n}function sortPresets(e){if(e)return e.sort(((e,t)=>{const{encoding:i}=e,{encoding:n}=t;return i.maxBitrate>n.maxBitrate?1:i.maxBitrate<n.maxBitrate?-1:i.maxBitrate===n.maxBitrate&&i.maxFramerate&&n.maxFramerate?i.maxFramerate>n.maxFramerate?1:-1:0}))}t.computeVideoEncodings=function computeVideoEncodings(e,t,i,n){var o,s;let c=null==n?void 0:n.videoEncoding;e&&(c=null==n?void 0:n.screenShareEncoding);const l=null==n?void 0:n.simulcast;if(!c&&!l||!t||!i)return[{}];if(c||(c=determineAppropriateEncoding(e,t,i),a.default.debug("using video encoding",c)),!l)return[c];const p=new u.VideoPreset(t,i,c.maxBitrate,c.maxFramerate);let h,m=[];m=e?null!==(o=sortPresets(null==n?void 0:n.screenShareSimulcastLayers))&&void 0!==o?o:defaultSimulcastLayers(e,p):null!==(s=sortPresets(null==n?void 0:n.videoSimulcastLayers))&&void 0!==s?s:defaultSimulcastLayers(e,p);const v=m[0];m.length>1&&([,h]=m);const g=Math.max(t,i);return encodingsFromPresets(t,i,g>=960&&h?[v,h,p]:g>=480?[v,p]:[p])},t.determineAppropriateEncoding=determineAppropriateEncoding,t.presetsForResolution=presetsForResolution,t.defaultSimulcastLayers=defaultSimulcastLayers,t.sortPresets=sortPresets},4448:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeBitrate=t.monitorFrequency=void 0,t.monitorFrequency=2e3,t.computeBitrate=function computeBitrate(e,t){if(!t)return 0;let i,n;return"bytesReceived"in e?(i=e.bytesReceived,n=t.bytesReceived):"bytesSent"in e&&(i=e.bytesSent,n=t.bytesSent),void 0===i||void 0===n||void 0===e.timestamp||void 0===t.timestamp?0:8*(i-n)*1e3/(e.timestamp-t.timestamp)}},8669:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=a(i(2662)),s=i(8911),c=i(4448),u=a(i(5728)),l=i(410),p=i(9565);class LocalAudioTrack extends u.default{constructor(e,t){super(e,l.Track.Kind.Audio,t),this.stopOnMute=!1,this.monitorSender=()=>n(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(e){return void o.default.error("could not get audio sender stats",e)}e&&this.prevStats&&(this._currentBitrate=c.computeBitrate(e,this.prevStats)),this.prevStats=e,setTimeout((()=>{this.monitorSender()}),c.monitorFrequency)})),this.checkForSilence()}setDeviceId(e){return n(this,void 0,void 0,(function*(){this.constraints.deviceId!==e&&(this.constraints.deviceId=e,this.isMuted||(yield this.restartTrack()))}))}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return n(this,void 0,void 0,(function*(){return this.source===l.Track.Source.Microphone&&this.stopOnMute&&(o.default.debug("stopping mic track"),this.mediaStreamTrack.stop()),yield e.mute.call(this),this}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return n(this,void 0,void 0,(function*(){return this.source===l.Track.Source.Microphone&&this.stopOnMute&&(o.default.debug("reacquiring mic track"),yield this.restartTrack()),yield e.unmute.call(this),this}))}restartTrack(e){return n(this,void 0,void 0,(function*(){let t;if(e){const i=p.constraintsForOptions({audio:e});"boolean"!=typeof i.audio&&(t=i.audio)}yield this.restart(t)}))}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return n(this,void 0,void 0,(function*(){const i=yield t.restart.call(this,e);return this.checkForSilence(),i}))}startMonitor(){setTimeout((()=>{this.monitorSender()}),c.monitorFrequency)}getSenderStats(){return n(this,void 0,void 0,(function*(){if(!this.sender)return;let e;return(yield this.sender.getStats()).forEach((t=>{"outbound-rtp"===t.type&&(e={type:"audio",streamId:t.id,packetsSent:t.packetsSent,packetsLost:t.packetsLost,bytesSent:t.bytesSent,timestamp:t.timestamp,roundTripTime:t.roundTripTime,jitter:t.jitter})})),e}))}checkForSilence(){return n(this,void 0,void 0,(function*(){(yield p.detectSilence(this))&&(this.isMuted||o.default.warn("silence detected on local audio track"),this.emit(s.TrackEvent.AudioSilenceDetected))}))}}t.default=LocalAudioTrack},5728:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=a(i(2662)),s=a(i(1480)),c=i(7650),u=i(8911),l=i(1981),p=i(410);class LocalTrack extends p.Track{constructor(e,t,i){super(e,t),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this.emit(u.TrackEvent.Ended,this)},this.mediaStreamTrack.addEventListener("ended",this.handleEnded),this.constraints=null!=i?i:e.getConstraints(),this.reacquireTrack=!1,this.wasMuted=!1}get id(){return this.mediaStreamTrack.id}get dimensions(){if(this.kind!==p.Track.Kind.Video)return;const{width:e,height:t}=this.mediaStreamTrack.getSettings();return e&&t?{width:e,height:t}:void 0}getDeviceId(){return n(this,void 0,void 0,(function*(){if(this.source===p.Track.Source.ScreenShare)return;const{deviceId:e,groupId:t}=this.mediaStreamTrack.getSettings(),i=this.kind===p.Track.Kind.Audio?"audioinput":"videoinput";return s.default.getInstance().normalizeDeviceId(i,e,t)}))}mute(){return n(this,void 0,void 0,(function*(){return this.setTrackMuted(!0),this}))}unmute(){return n(this,void 0,void 0,(function*(){return this.setTrackMuted(!1),this}))}restart(e){return n(this,void 0,void 0,(function*(){if(!this.sender)throw new c.TrackInvalidError("unable to restart an unpublished track");e||(e=this.constraints),o.default.debug("restarting track with constraints",e);const t={audio:!1,video:!1};this.kind===p.Track.Kind.Video?t.video=e:t.audio=e,this.attachedElements.forEach((e=>{p.detachTrack(this.mediaStreamTrack,e)})),this.mediaStreamTrack.removeEventListener("ended",this.handleEnded),this.mediaStreamTrack.stop();const i=yield navigator.mediaDevices.getUserMedia(t),n=i.getTracks()[0];return n.addEventListener("ended",this.handleEnded),o.default.debug("re-acquired MediaStreamTrack"),yield this.sender.replaceTrack(n),this.mediaStreamTrack=n,this.attachedElements.forEach((e=>{p.attachToElement(n,e)})),this.mediaStream=i,this.constraints=e,this}))}setTrackMuted(e){this.isMuted!==e&&(this.isMuted=e,this.mediaStreamTrack.enabled=!e,this.emit(e?u.TrackEvent.Muted:u.TrackEvent.Unmuted,this))}get needsReAcquisition(){return"live"!==this.mediaStreamTrack.readyState||this.mediaStreamTrack.muted||!this.mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return n(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),l.isMobile()&&(o.default.debug("visibility changed, is in Background: ",this.isInBackground),!this.isInBackground&&this.needsReAcquisition&&(o.default.debug("track needs to be reaquired, restarting",this.source),yield this.restart(),this.reacquireTrack=!1,this.setTrackMuted(this.wasMuted)),this.isInBackground&&(this.wasMuted=this.isMuted))}))}}t.default=LocalTrack},170:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=i(8911),o=i(2184);class LocalTrackPublication extends o.TrackPublication{constructor(e,t,i){super(e,t.sid,t.name),this.handleTrackEnded=e=>{this.emit(a.TrackEvent.Ended,e)},this.updateInfo(t),this.setTrack(i)}setTrack(e){this.track&&this.track.off(a.TrackEvent.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(a.TrackEvent.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return n(this,void 0,void 0,(function*(){return null===(e=this.track)||void 0===e?void 0:e.mute()}))}unmute(){var e;return n(this,void 0,void 0,(function*(){return null===(e=this.track)||void 0===e?void 0:e.unmute()}))}}t.default=LocalTrackPublication},6887:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.videoLayersFromEncodings=t.videoQualityForRid=void 0;const o=a(i(2662)),s=i(8983),c=i(4448),u=i(1981),l=a(i(5728)),p=i(410),h=i(9565);class LocalVideoTrack extends l.default{constructor(e,t){super(e,p.Track.Kind.Video,t),this.monitorSender=()=>n(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(e){return void o.default.error("could not get audio sender stats",e)}const t=new Map(e.map((e=>[e.rid,e])));if(this.prevStats){let e=0;t.forEach(((t,i)=>{var n;const a=null===(n=this.prevStats)||void 0===n?void 0:n.get(i);e+=c.computeBitrate(t,a)})),this._currentBitrate=e}this.prevStats=t,setTimeout((()=>{this.monitorSender()}),c.monitorFrequency)}))}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;this.signalClient=e;const i=null===(t=this.sender)||void 0===t?void 0:t.getParameters();i&&(this.encodings=i.encodings),setTimeout((()=>{this.monitorSender()}),c.monitorFrequency)}stop(){this.sender=void 0,this.mediaStreamTrack.getConstraints(),super.stop()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return n(this,void 0,void 0,(function*(){return this.source===p.Track.Source.Camera&&(o.default.debug("stopping camera track"),this.mediaStreamTrack.stop()),yield e.mute.call(this),this}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return n(this,void 0,void 0,(function*(){return this.source===p.Track.Source.Camera&&(o.default.debug("reacquiring camera track"),yield this.restartTrack()),yield e.unmute.call(this),this}))}getSenderStats(){return n(this,void 0,void 0,(function*(){if(!this.sender)return[];const e=[],t=yield this.sender.getStats();return t.forEach((i=>{var n;if("outbound-rtp"===i.type){const a={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:null!==(n=i.rid)&&void 0!==n?n:"",retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},o=t.get(i.remoteId);o&&(a.jitter=o.jitter,a.packetsLost=o.packetsLost,a.roundTripTime=o.roundTripTime),e.push(a)}})),e}))}setPublishingQuality(e){const t=[];for(let i=s.VideoQuality.LOW;i<=s.VideoQuality.HIGH;i+=1)t.push({quality:i,enabled:i<=e});o.default.debug("setting publishing quality. max quality",e),this.setPublishingLayers(t)}setDeviceId(e){return n(this,void 0,void 0,(function*(){this.constraints.deviceId!==e&&(this.constraints.deviceId=e,this.isMuted||(yield this.restartTrack()))}))}restartTrack(e){return n(this,void 0,void 0,(function*(){let t;if(e){const i=h.constraintsForOptions({video:e});"boolean"!=typeof i.video&&(t=i.video)}yield this.restart(t)}))}setPublishingLayers(e){return n(this,void 0,void 0,(function*(){if(o.default.debug("setting publishing layers",e),!this.sender||!this.encodings)return;const t=this.sender.getParameters(),{encodings:i}=t;if(!i)return;if(i.length!==this.encodings.length)return void o.default.warn("cannot set publishing layers, encodings mismatch");let n=!1;i.forEach(((t,i)=>{var a;let s=null!==(a=t.rid)&&void 0!==a?a:"";""===s&&(s="q");const c=videoQualityForRid(s),l=e.find((e=>e.quality===c));l&&t.active!==l.enabled&&(n=!0,t.active=l.enabled,o.default.debug(`setting layer ${l.quality} to ${t.active?"enabled":"disabled"}`),u.isFireFox()&&(l.enabled?(t.scaleResolutionDownBy=this.encodings[i].scaleResolutionDownBy,t.maxBitrate=this.encodings[i].maxBitrate,t.maxFrameRate=this.encodings[i].maxFrameRate):(t.scaleResolutionDownBy=4,t.maxBitrate=10,t.maxFrameRate=2)))})),n&&(t.encodings=i,yield this.sender.setParameters(t))}))}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return n(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),u.isMobile()&&this.isInBackground&&this.source===p.Track.Source.Camera&&(this.mediaStreamTrack.enabled=!1)}))}}function videoQualityForRid(e){switch(e){case"f":return s.VideoQuality.HIGH;case"h":return s.VideoQuality.MEDIUM;case"q":return s.VideoQuality.LOW;default:return s.VideoQuality.UNRECOGNIZED}}t.default=LocalVideoTrack,t.videoQualityForRid=videoQualityForRid,t.videoLayersFromEncodings=function videoLayersFromEncodings(e,t,i){return i?i.map((n=>{var a,o,c;const u=null!==(a=n.scaleResolutionDownBy)&&void 0!==a?a:1;let l=videoQualityForRid(null!==(o=n.rid)&&void 0!==o?o:"");return l===s.VideoQuality.UNRECOGNIZED&&1===i.length&&(l=s.VideoQuality.HIGH),{quality:l,width:e/u,height:t/u,bitrate:null!==(c=n.maxBitrate)&&void 0!==c?c:0,ssrc:0}})):[{quality:s.VideoQuality.HIGH,width:e,height:t,bitrate:0,ssrc:0}]}},5941:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(4448),s=a(i(5785)),c=i(410);class RemoteAudioTrack extends s.default{constructor(e,t,i){super(e,t,c.Track.Kind.Audio,i),this.monitorReceiver=()=>n(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=o.computeBitrate(e,this.prevStats)),this.prevStats=e,setTimeout((()=>{this.monitorReceiver()}),o.monitorFrequency)}))}getReceiverStats(){return n(this,void 0,void 0,(function*(){if(!this.receiver)return;let e;return(yield this.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(e={type:"audio",timestamp:t.timestamp,jitter:t.jitter,bytesReceived:t.bytesReceived,concealedSamples:t.concealedSamples,concealmentEvents:t.concealmentEvents,silentConcealedSamples:t.silentConcealedSamples,silentConcealmentEvents:t.silentConcealmentEvents,totalAudioEnergy:t.totalAudioEnergy,totalSamplesDuration:t.totalSamplesDuration})})),e}))}}t.default=RemoteAudioTrack},5785:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(8911),a=i(4448),o=i(410);class RemoteTrack extends o.Track{constructor(e,t,i,n){super(e,i),this.streamState=o.Track.StreamState.Active,this.sid=t,this.receiver=n}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this.emit(e?n.TrackEvent.Muted:n.TrackEvent.Unmuted,this))}setMediaStream(e){this.mediaStream=e,e.onremovetrack=()=>{this.receiver=void 0,this._currentBitrate=0,this.emit(n.TrackEvent.Ended,this)}}start(){this.startMonitor(),super.enable()}stop(){super.disable()}startMonitor(){setTimeout((()=>{this.monitorReceiver()}),a.monitorFrequency)}}t.default=RemoteTrack},297:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(i(2662)),o=i(8983),s=i(4658),c=i(8911),u=n(i(466)),l=i(2184);class RemoteTrackPublication extends l.TrackPublication{constructor(){super(...arguments),this._allowed=!0,this.disabled=!1,this.currentVideoQuality=o.VideoQuality.HIGH,this.handleEnded=e=>{this.emit(c.TrackEvent.Ended,e)},this.handleVisibilityChange=e=>{a.default.debug("adaptivestream video visibility",this.trackSid,`visible=${e}`),this.disabled=!e,this.emitTrackUpdate()},this.handleVideoDimensionsChange=e=>{a.default.debug("adaptivestream video dimensions",this.trackSid,`${e.width}x${e.height}`),this.videoDimensions=e,this.emitTrackUpdate()}}setSubscribed(e){this.subscribed=e;const t={trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[{participantSid:"",trackSids:[this.trackSid]}]};this.emit(c.TrackEvent.UpdateSubscription,t)}get subscriptionStatus(){return!1!==this.subscribed&&super.isSubscribed?this._allowed?l.TrackPublication.SubscriptionStatus.Subscribed:l.TrackPublication.SubscriptionStatus.NotAllowed:l.TrackPublication.SubscriptionStatus.Unsubscribed}get isSubscribed(){return!1!==this.subscribed&&(!!this._allowed&&super.isSubscribed)}get isEnabled(){return!this.disabled}setEnabled(e){this.isManualOperationAllowed()&&this.disabled!==!e&&(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){this.isManualOperationAllowed()&&this.currentVideoQuality!==e&&(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,i;this.isManualOperationAllowed()&&((null===(t=this.videoDimensions)||void 0===t?void 0:t.width)===e.width&&(null===(i=this.videoDimensions)||void 0===i?void 0:i.height)===e.height||(this.track instanceof u.default&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}get videoQuality(){return this.currentVideoQuality}setTrack(e){this.track&&(this.track.off(c.TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),this.track.off(c.TrackEvent.VisibilityChanged,this.handleVisibilityChange),this.track.off(c.TrackEvent.Ended,this.handleEnded)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(c.TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(c.TrackEvent.VisibilityChanged,this.handleVisibilityChange),e.on(c.TrackEvent.Ended,this.handleEnded))}updateInfo(e){var t;super.updateInfo(e),this.metadataMuted=e.muted,null===(t=this.track)||void 0===t||t.setMuted(e.muted)}isManualOperationAllowed(){return this.isAdaptiveStream?(a.default.warn("adaptive stream is enabled, cannot change track settings",this.trackSid),!1):!!this.isSubscribed||(a.default.warn("cannot update track settings when not subscribed",this.trackSid),!1)}get isAdaptiveStream(){return this.track instanceof u.default&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=s.UpdateTrackSettings.fromPartial({trackSids:[this.trackSid],disabled:this.disabled});this.videoDimensions?(e.width=this.videoDimensions.width,e.height=this.videoDimensions.height):void 0!==this.currentVideoQuality?e.quality=this.currentVideoQuality:e.quality=o.VideoQuality.HIGH,this.emit(c.TrackEvent.UpdateSettings,e)}}t.default=RemoteTrackPublication},466:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(2938),s=i(8911),c=i(4448),u=i(1981),l=a(i(5785)),p=i(410);class RemoteVideoTrack extends l.default{constructor(e,t,i,a){super(e,t,p.Track.Kind.Video,i),this.elementInfos=[],this.monitorReceiver=()=>n(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=c.computeBitrate(e,this.prevStats)),this.prevStats=e,setTimeout((()=>{this.monitorReceiver()}),c.monitorFrequency)})),this.handleVisibilityChanged=e=>{const{target:t,isIntersecting:i}=e,n=this.elementInfos.find((e=>e.element===t));n&&(n.visible=i,n.visibilityChangedAt=Date.now()),this.updateVisibility()},this.debouncedHandleResize=o.debounce((()=>{this.updateDimensions()}),100),this.adaptiveStreamSettings=a}get isAdaptiveStream(){return void 0!==this.adaptiveStreamSettings}setMuted(e){super.setMuted(e),this.attachedElements.forEach((t=>{e?p.detachTrack(this.mediaStreamTrack,t):p.attachToElement(this.mediaStreamTrack,t)}))}attach(e){return e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&void 0===this.elementInfos.find((t=>t.element===e))&&(this.elementInfos.push({element:e,visible:!0}),e.handleResize=this.debouncedHandleResize,e.handleVisibilityChanged=this.handleVisibilityChanged,u.getIntersectionObserver().observe(e),u.getResizeObserver().observe(e),this.debouncedHandleResize()),e}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const e of t)this.stopObservingElement(e);return t}getReceiverStats(){return n(this,void 0,void 0,(function*(){if(!this.receiver)return;let e;return(yield this.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(e={type:"video",framesDecoded:t.framesDecoded,framesDropped:t.framesDropped,framesReceived:t.framesReceived,packetsReceived:t.packetsReceived,packetsLost:t.packetsLost,frameWidth:t.frameWidth,frameHeight:t.frameHeight,pliCount:t.pliCount,firCount:t.firCount,nackCount:t.nackCount,jitter:t.jitter,timestamp:t.timestamp,bytesReceived:t.bytesReceived})})),e}))}stopObservingElement(e){var t,i;null===(t=u.getIntersectionObserver())||void 0===t||t.unobserve(e),null===(i=u.getResizeObserver())||void 0===i||i.unobserve(e),this.elementInfos=this.elementInfos.filter((t=>t.element!==e))}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return n(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&u.isMobile()&&this.updateVisibility()}))}updateVisibility(){const e=this.elementInfos.reduce(((e,t)=>Math.max(e,t.visibilityChangedAt||0)),0),t=this.elementInfos.some((e=>e.visible))&&!this.isInBackground;this.lastVisible!==t&&(!t&&Date.now()-e<100?setTimeout((()=>{this.updateVisibility()}),100):(this.lastVisible=t,this.emit(s.TrackEvent.VisibilityChanged,t,this)))}updateDimensions(){var e,t,i,n;let a=0,o=0;for(const i of this.elementInfos){const n=null!==(t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pixelDensity)&&void 0!==t?t:1,s="screen"===n?window.devicePixelRatio:n,c=i.element.clientWidth*s,u=i.element.clientHeight*s;c+u>a+o&&(a=c,o=u)}(null===(i=this.lastDimensions)||void 0===i?void 0:i.width)===a&&(null===(n=this.lastDimensions)||void 0===n?void 0:n.height)===o||(this.lastDimensions={width:a,height:o},this.emit(s.TrackEvent.VideoDimensionsChanged,this.lastDimensions,this))}}t.default=RemoteVideoTrack},410:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.detachTrack=t.attachToElement=t.Track=void 0;const a=i(7187),o=i(8983),s=i(4658),c=i(8911),u=i(1981),l=[];class Track extends a.EventEmitter{constructor(e,t){super(),this.attachedElements=[],this.isMuted=!1,this._currentBitrate=0,this.appVisibilityChangedListener=()=>{this.handleAppVisibilityChanged()},this.kind=t,this.mediaStreamTrack=e,this.source=Track.Source.Unknown,this.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",this.appVisibilityChangedListener)}get currentBitrate(){return this._currentBitrate}attach(e){let t="audio";return this.kind===Track.Kind.Video&&(t="video"),e||("audio"===t&&(l.forEach((t=>{null!==t.parentElement||e||(e=t)})),e&&l.splice(l.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),attachToElement(this.mediaStreamTrack,e),e instanceof HTMLAudioElement&&e.play().then((()=>{this.emit(c.TrackEvent.AudioPlaybackStarted)})).catch((e=>{this.emit(c.TrackEvent.AudioPlaybackFailed,e)})),e}detach(e){if(e){detachTrack(this.mediaStreamTrack,e);const t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e)),e}const t=[];return this.attachedElements.forEach((e=>{detachTrack(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e)})),this.attachedElements=[],t}stop(){this.mediaStreamTrack.stop(),document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}enable(){this.mediaStreamTrack.enabled=!0}disable(){this.mediaStreamTrack.enabled=!1}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),l.forEach((e=>{e.parentElement||(t=!1)})),t&&l.push(e)}}handleAppVisibilityChanged(){return n(this,void 0,void 0,(function*(){this.isInBackground="hidden"===document.visibilityState}))}}function attachToElement(e,t){let i,n;i=t.srcObject instanceof MediaStream?t.srcObject:new MediaStream,n="audio"===e.kind?i.getAudioTracks():i.getVideoTracks(),n.includes(e)||(n.forEach((e=>{i.removeTrack(e)})),i.addTrack(e)),t.srcObject!==i&&(t.srcObject=i,(u.isSafari()||u.isFireFox())&&t instanceof HTMLVideoElement&&setTimeout((()=>{t.srcObject=i}),0)),t.autoplay=!0,t instanceof HTMLVideoElement&&(t.playsInline=!0)}function detachTrack(e,t){if(t.srcObject instanceof MediaStream){t.srcObject.removeTrack(e),t.srcObject=null}}t.Track=Track,t.attachToElement=attachToElement,t.detachTrack=detachTrack,function(e){let t,i,n;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(i=e.Source||(e.Source={})),function(e){e.Active="active",e.Paused="paused",e.Unknown="unknown"}(n=e.StreamState||(e.StreamState={})),e.kindToProto=function kindToProto(e){switch(e){case t.Audio:return o.TrackType.AUDIO;case t.Video:return o.TrackType.VIDEO;default:return o.TrackType.UNRECOGNIZED}},e.kindFromProto=function kindFromProto(e){switch(e){case o.TrackType.AUDIO:return t.Audio;case o.TrackType.VIDEO:return t.Video;default:return t.Unknown}},e.sourceToProto=function sourceToProto(e){switch(e){case i.Camera:return o.TrackSource.CAMERA;case i.Microphone:return o.TrackSource.MICROPHONE;case i.ScreenShare:return o.TrackSource.SCREEN_SHARE;case i.ScreenShareAudio:return o.TrackSource.SCREEN_SHARE_AUDIO;default:return o.TrackSource.UNRECOGNIZED}},e.sourceFromProto=function sourceFromProto(e){switch(e){case o.TrackSource.CAMERA:return i.Camera;case o.TrackSource.MICROPHONE:return i.Microphone;case o.TrackSource.SCREEN_SHARE:return i.ScreenShare;case o.TrackSource.SCREEN_SHARE_AUDIO:return i.ScreenShareAudio;default:return i.Unknown}},e.streamStateFromProto=function streamStateFromProto(e){switch(e){case s.StreamState.ACTIVE:return n.Active;case s.StreamState.PAUSED:return n.Paused;default:return n.Unknown}}}(Track=t.Track||(t.Track={}))},2184:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TrackPublication=void 0;const a=i(7187),o=i(8911),s=n(i(8669)),c=n(i(6887)),u=n(i(5941)),l=n(i(466)),p=i(410);class TrackPublication extends a.EventEmitter{constructor(e,t,i){super(),this.metadataMuted=!1,this.handleMuted=()=>{this.emit(o.TrackEvent.Muted)},this.handleUnmuted=()=>{this.emit(o.TrackEvent.Unmuted)},this.kind=e,this.trackSid=t,this.trackName=i,this.source=p.Track.Source.Unknown}setTrack(e){this.track&&(this.track.off(o.TrackEvent.Muted,this.handleMuted),this.track.off(o.TrackEvent.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(o.TrackEvent.Muted,this.handleMuted),e.on(o.TrackEvent.Unmuted,this.handleUnmuted))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get audioTrack(){if(this.track instanceof s.default||this.track instanceof u.default)return this.track}get videoTrack(){if(this.track instanceof c.default||this.track instanceof l.default)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=p.Track.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===p.Track.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.trackInfo=e}}t.TrackPublication=TrackPublication,function(e){let t;!function(e){e.Subscribed="subscribed",e.NotAllowed="not_allowed",e.Unsubscribed="unsubscribed"}(t=e.SubscriptionStatus||(e.SubscriptionStatus={}))}(TrackPublication=t.TrackPublication||(t.TrackPublication={}))},119:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createLocalScreenTracks=t.createLocalAudioTrack=t.createLocalVideoTrack=t.createLocalTracks=void 0;const o=i(7650),s=i(5482),c=i(1442),u=a(i(8669)),l=a(i(6887)),p=i(6669),h=i(410),m=i(9565);function createLocalTracks(e){var t,i;return n(this,void 0,void 0,(function*(){null!=e||(e={}),null!==(t=e.audio)&&void 0!==t||(e.audio=!0),null!==(i=e.video)&&void 0!==i||(e.video=!0);const n=m.mergeDefaultOptions(e,c.audioDefaults,c.videoDefaults),a=m.constraintsForOptions(n),o=yield navigator.mediaDevices.getUserMedia(a);return o.getTracks().map((t=>{const i="audio"===t.kind;let n,c=i?e.audio:e.video;"boolean"!=typeof c&&c||(c={});const u=i?a.audio:a.video;"boolean"!=typeof u&&(n=u);const l=s.mediaTrackToLocalTrack(t,n);return l.kind===h.Track.Kind.Video?l.source=h.Track.Source.Camera:l.kind===h.Track.Kind.Audio&&(l.source=h.Track.Source.Microphone),l.mediaStream=o,l}))}))}t.createLocalTracks=createLocalTracks,t.createLocalVideoTrack=function createLocalVideoTrack(e){return n(this,void 0,void 0,(function*(){return(yield createLocalTracks({audio:!1,video:e}))[0]}))},t.createLocalAudioTrack=function createLocalAudioTrack(e){return n(this,void 0,void 0,(function*(){return(yield createLocalTracks({audio:e,video:!1}))[0]}))},t.createLocalScreenTracks=function createLocalScreenTracks(e){var t;return n(this,void 0,void 0,(function*(){void 0===e&&(e={}),void 0===e.resolution&&(e.resolution=p.VideoPresets.fhd.resolution);let i=!0;e.resolution&&(i={width:e.resolution.width,height:e.resolution.height});const n=yield navigator.mediaDevices.getDisplayMedia({audio:null!==(t=e.audio)&&void 0!==t&&t,video:i}),a=n.getVideoTracks();if(0===a.length)throw new o.TrackInvalidError("no video track found");const s=new l.default(a[0]);s.source=h.Track.Source.ScreenShare;const c=[s];if(n.getAudioTracks().length>0){const e=new u.default(n.getAudioTracks()[0]);e.source=h.Track.Source.ScreenShareAudio,c.push(e)}return c}))}},1442:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.videoDefaults=t.audioDefaults=t.publishDefaults=void 0;const n=i(6669);t.publishDefaults={audioBitrate:n.AudioPresets.speech.maxBitrate,dtx:!0,simulcast:!0,screenShareEncoding:n.ScreenSharePresets.h1080fps15.encoding,stopMicTrackOnMute:!1},t.audioDefaults={autoGainControl:!0,channelCount:1,echoCancellation:!0,noiseSuppression:!0},t.videoDefaults={resolution:n.VideoPresets.h540.resolution}},6669:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenSharePresets=t.VideoPresets43=t.VideoPresets=t.AudioPresets=t.VideoPreset=void 0;class VideoPreset{constructor(e,t,i,n){this.width=e,this.height=t,this.encoding={maxBitrate:i,maxFramerate:n}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}t.VideoPreset=VideoPreset,function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:2e4},e.music={maxBitrate:32e3}}(t.AudioPresets||(t.AudioPresets={})),t.VideoPresets={h90:new VideoPreset(160,90,6e4,15),h180:new VideoPreset(320,180,12e4,15),h216:new VideoPreset(384,216,18e4,15),h360:new VideoPreset(640,360,3e5,20),h540:new VideoPreset(960,540,6e5,25),h720:new VideoPreset(1280,720,2e6,30),h1080:new VideoPreset(1920,1080,3e6,30),h1440:new VideoPreset(2560,1440,5e6,30),h2160:new VideoPreset(3840,2160,8e6,30),qvga:new VideoPreset(320,180,12e4,10),vga:new VideoPreset(640,360,3e5,20),qhd:new VideoPreset(960,540,6e5,25),hd:new VideoPreset(1280,720,2e6,30),fhd:new VideoPreset(1920,1080,3e6,30)},t.VideoPresets43={h120:new VideoPreset(160,120,8e4,15),h180:new VideoPreset(240,180,1e5,15),h240:new VideoPreset(320,240,15e4,15),h360:new VideoPreset(480,360,225e3,20),h480:new VideoPreset(640,480,3e5,20),h540:new VideoPreset(720,540,45e4,25),h720:new VideoPreset(960,720,15e5,30),h1080:new VideoPreset(1440,1080,25e5,30),h1440:new VideoPreset(1920,1440,35e5,30),qvga:new VideoPreset(240,180,9e4,10),vga:new VideoPreset(480,360,225e3,20),qhd:new VideoPreset(720,540,45e4,25),hd:new VideoPreset(960,720,15e5,30),fhd:new VideoPreset(1440,1080,28e5,30)},t.ScreenSharePresets={h360fps3:new VideoPreset(640,360,2e5,3),h720fps5:new VideoPreset(1280,720,4e5,5),h720fps15:new VideoPreset(1280,720,1e6,15),h1080fps15:new VideoPreset(1920,1080,15e5,15),h1080fps30:new VideoPreset(1920,1080,3e6,30),vga:new VideoPreset(640,360,2e5,3),hd_8:new VideoPreset(1280,720,4e5,5),hd_15:new VideoPreset(1280,720,1e6,15),fhd_15:new VideoPreset(1920,1080,15e5,15),fhd_30:new VideoPreset(1920,1080,3e6,30)}},5884:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9565:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getNewAudioContext=t.detectSilence=t.constraintsForOptions=t.mergeDefaultOptions=void 0;const a=i(1981);function mergeObjectWithoutOverwriting(e,t){return Object.keys(t).forEach((i=>{void 0===e[i]&&(e[i]=t[i])})),e}function getNewAudioContext(){const e=window.AudioContext||window.webkitAudioContext;if(e)return new e}t.mergeDefaultOptions=function mergeDefaultOptions(e,t,i){const n=Object.assign({},e);return!0===n.audio&&(n.audio={}),!0===n.video&&(n.video={}),n.audio&&mergeObjectWithoutOverwriting(n.audio,t),n.video&&mergeObjectWithoutOverwriting(n.video,i),n},t.constraintsForOptions=function constraintsForOptions(e){const t={};if(e.video)if("object"==typeof e.video){const i={},n=i,a=e.video;Object.keys(a).forEach((e=>{if("resolution"===e)mergeObjectWithoutOverwriting(n,a.resolution);else n[e]=a[e]})),t.video=i}else t.video=e.video;else t.video=!1;return e.audio?"object"==typeof e.audio?t.audio=e.audio:t.audio=!0:t.audio=!1,t},t.detectSilence=function detectSilence(e,t=200){return n(this,void 0,void 0,(function*(){const i=getNewAudioContext();if(i){const n=i.createAnalyser();n.fftSize=2048;const o=n.frequencyBinCount,s=new Uint8Array(o);i.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(n),yield a.sleep(t),n.getByteTimeDomainData(s);const c=s.some((e=>128!==e&&0!==e));return i.close(),!c}return!1}))},t.getNewAudioContext=getNewAudioContext},1981:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(a,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n.throw(e))}catch(e){o(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getClientInfo=t.getIntersectionObserver=t.getResizeObserver=t.isWeb=t.isMobile=t.isSafari=t.isFireFox=t.sleep=t.unpackStreamId=void 0;const a=i(8983),o=i(6942);function roDispatchCallback(e){for(const t of e)t.target.handleResize(t)}function ioDispatchCallback(e){for(const t of e)t.target.handleVisibilityChanged(t)}t.unpackStreamId=function unpackStreamId(e){const t=e.split("|");return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]},t.sleep=function sleep(e){return n(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))},t.isFireFox=function isFireFox(){return-1!==navigator.userAgent.indexOf("Firefox")},t.isSafari=function isSafari(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},t.isMobile=function isMobile(){return/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent)},t.isWeb=function isWeb(){return"undefined"!=typeof document};let s=null;t.getResizeObserver=()=>(s||(s=new ResizeObserver(roDispatchCallback)),s);let c=null;t.getIntersectionObserver=()=>(c||(c=new IntersectionObserver(ioDispatchCallback)),c),t.getClientInfo=function getClientInfo(){return a.ClientInfo.fromPartial({sdk:a.ClientInfo_SDK.JS,protocol:o.protocolVersion,version:o.version})}},6942:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.protocolVersion=t.version=void 0,t.version="0.17.3",t.protocolVersion=7},2043:function(e,t,i){var n,a;!function(o,s){"use strict";n=function(){var noop=function(){},e="undefined",t=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function bindMethod(e,t){var i=e[t];if("function"==typeof i.bind)return i.bind(e);try{return Function.prototype.bind.call(i,e)}catch(t){return function(){return Function.prototype.apply.apply(i,[e,arguments])}}}function traceForIE(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function realMethod(i){return"debug"===i&&(i="log"),typeof console!==e&&("trace"===i&&t?traceForIE:void 0!==console[i]?bindMethod(console,i):void 0!==console.log?bindMethod(console,"log"):noop)}function replaceLoggingMethods(e,t){for(var n=0;n<i.length;n++){var a=i[n];this[a]=n<e?noop:this.methodFactory(a,e,t)}this.log=this.debug}function enableLoggingWhenConsoleArrives(t,i,n){return function(){typeof console!==e&&(replaceLoggingMethods.call(this,i,n),this[t].apply(this,arguments))}}function defaultMethodFactory(e,t,i){return realMethod(e)||enableLoggingWhenConsoleArrives.apply(this,arguments)}function Logger(t,n,a){var o,s=this;n=null==n?"WARN":n;var c="loglevel";function persistLevelIfPossible(t){var n=(i[t]||"silent").toUpperCase();if(typeof window!==e&&c){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}function getPersistedLevel(){var t;if(typeof window!==e&&c){try{t=window.localStorage[c]}catch(e){}if(typeof t===e)try{var i=window.document.cookie,n=i.indexOf(encodeURIComponent(c)+"=");-1!==n&&(t=/^([^;]+)/.exec(i.slice(n))[1])}catch(e){}return void 0===s.levels[t]&&(t=void 0),t}}function clearPersistedLevel(){if(typeof window!==e&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"==typeof t?c+=":"+t:"symbol"==typeof t&&(c=void 0),s.name=t,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=a||defaultMethodFactory,s.getLevel=function(){return o},s.setLevel=function(i,n){if("string"==typeof i&&void 0!==s.levels[i.toUpperCase()]&&(i=s.levels[i.toUpperCase()]),!("number"==typeof i&&i>=0&&i<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+i;if(o=i,!1!==n&&persistLevelIfPossible(i),replaceLoggingMethods.call(s,i,t),typeof console===e&&i<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){n=e,getPersistedLevel()||s.setLevel(e,!1)},s.resetLevel=function(){s.setLevel(n,!1),clearPersistedLevel()},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var u=getPersistedLevel();null==u&&(u=n),s.setLevel(u,!1)}var n=new Logger,a={};n.getLogger=function getLogger(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=a[e];return t||(t=a[e]=new Logger(e,n.getLevel(),n.methodFactory)),t};var o=typeof window!==e?window.log:void 0;return n.noConflict=function(){return typeof window!==e&&window.log===n&&(window.log=o),n},n.getLoggers=function getLoggers(){return a},n.default=n,n},void 0===(a="function"==typeof n?n.call(t,i,t,e):n)||(e.exports=a)}()},3720:function(e){e.exports=Long;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Long(e,t,i){this.low=0|e,this.high=0|t,this.unsigned=!!i}function isLong(e){return!0===(e&&e.__isLong__)}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var i={},n={};function fromInt(e,t){var a,o,s;return t?(s=0<=(e>>>=0)&&e<256)&&(o=n[e])?o:(a=fromBits(e,(0|e)<0?-1:0,!0),s&&(n[e]=a),a):(s=-128<=(e|=0)&&e<128)&&(o=i[e])?o:(a=fromBits(e,e<0?-1:0,!1),s&&(i[e]=a),a)}function fromNumber(e,t){if(isNaN(e))return t?p:l;if(t){if(e<0)return p;if(e>=s)return b}else{if(e<=-c)return k;if(e+1>=c)return g}return e<0?fromNumber(-e,t).neg():fromBits(e%o|0,e/o|0,t)}function fromBits(e,t,i){return new Long(e,t,i)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var a=Math.pow;function fromString(e,t,i){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return l;if("number"==typeof t?(i=t,t=!1):t=!!t,(i=i||10)<2||36<i)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return fromString(e.substring(1),t,i).neg();for(var o=fromNumber(a(i,8)),s=l,c=0;c<e.length;c+=8){var u=Math.min(8,e.length-c),p=parseInt(e.substring(c,c+u),i);if(u<8){var h=fromNumber(a(i,u));s=s.mul(h).add(fromNumber(p))}else s=(s=s.mul(o)).add(fromNumber(p))}return s.unsigned=t,s}function fromValue(e,t){return"number"==typeof e?fromNumber(e,t):"string"==typeof e?fromString(e,t):fromBits(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}Long.fromString=fromString,Long.fromValue=fromValue;var o=4294967296,s=o*o,c=s/2,u=fromInt(1<<24),l=fromInt(0);Long.ZERO=l;var p=fromInt(0,!0);Long.UZERO=p;var h=fromInt(1);Long.ONE=h;var m=fromInt(1,!0);Long.UONE=m;var v=fromInt(-1);Long.NEG_ONE=v;var g=fromBits(-1,2147483647,!1);Long.MAX_VALUE=g;var b=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=b;var k=fromBits(0,-2147483648,!1);Long.MIN_VALUE=k;var S=Long.prototype;S.toInt=function toInt(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function toNumber(){return this.unsigned?(this.high>>>0)*o+(this.low>>>0):this.high*o+(this.low>>>0)},S.toString=function toString(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(k)){var t=fromNumber(e),i=this.div(t),n=i.mul(t).sub(this);return i.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=fromNumber(a(e,6),this.unsigned),s=this,c="";;){var u=s.div(o),l=(s.sub(u.mul(o)).toInt()>>>0).toString(e);if((s=u).isZero())return l+c;for(;l.length<6;)l="0"+l;c=""+l+c}},S.getHighBits=function getHighBits(){return this.high},S.getHighBitsUnsigned=function getHighBitsUnsigned(){return this.high>>>0},S.getLowBits=function getLowBits(){return this.low},S.getLowBitsUnsigned=function getLowBitsUnsigned(){return this.low>>>0},S.getNumBitsAbs=function getNumBitsAbs(){if(this.isNegative())return this.eq(k)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},S.isZero=function isZero(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function isNegative(){return!this.unsigned&&this.high<0},S.isPositive=function isPositive(){return this.unsigned||this.high>=0},S.isOdd=function isOdd(){return 1==(1&this.low)},S.isEven=function isEven(){return 0==(1&this.low)},S.equals=function equals(e){return isLong(e)||(e=fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},S.eq=S.equals,S.notEquals=function notEquals(e){return!this.eq(e)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function lessThan(e){return this.comp(e)<0},S.lt=S.lessThan,S.lessThanOrEqual=function lessThanOrEqual(e){return this.comp(e)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function greaterThan(e){return this.comp(e)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function greaterThanOrEqual(e){return this.comp(e)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function compare(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},S.comp=S.compare,S.negate=function negate(){return!this.unsigned&&this.eq(k)?k:this.not().add(h)},S.neg=S.negate,S.add=function add(e){isLong(e)||(e=fromValue(e));var t=this.high>>>16,i=65535&this.high,n=this.low>>>16,a=65535&this.low,o=e.high>>>16,s=65535&e.high,c=e.low>>>16,u=0,l=0,p=0,h=0;return p+=(h+=a+(65535&e.low))>>>16,l+=(p+=n+c)>>>16,u+=(l+=i+s)>>>16,u+=t+o,fromBits((p&=65535)<<16|(h&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},S.subtract=function subtract(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())},S.sub=S.subtract,S.multiply=function multiply(e){if(this.isZero())return l;if(isLong(e)||(e=fromValue(e)),t)return fromBits(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return l;if(this.eq(k))return e.isOdd()?k:l;if(e.eq(k))return this.isOdd()?k:l;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(u)&&e.lt(u))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,n=65535&this.high,a=this.low>>>16,o=65535&this.low,s=e.high>>>16,c=65535&e.high,p=e.low>>>16,h=65535&e.low,m=0,v=0,g=0,b=0;return g+=(b+=o*h)>>>16,v+=(g+=a*h)>>>16,g&=65535,v+=(g+=o*p)>>>16,m+=(v+=n*h)>>>16,v&=65535,m+=(v+=a*p)>>>16,v&=65535,m+=(v+=o*c)>>>16,m+=i*h+n*p+a*c+o*s,fromBits((g&=65535)<<16|(b&=65535),(m&=65535)<<16|(v&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function divide(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");var i,n,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?fromBits((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?p:l;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return p;if(e.gt(this.shru(1)))return m;o=p}else{if(this.eq(k))return e.eq(h)||e.eq(v)?k:e.eq(k)?h:(i=this.shr(1).div(e).shl(1)).eq(l)?e.isNegative()?h:v:(n=this.sub(e.mul(i)),o=i.add(n.div(e)));if(e.eq(k))return this.unsigned?p:l;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=l}for(n=this;n.gte(e);){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(i)/Math.LN2),c=s<=48?1:a(2,s-48),u=fromNumber(i),g=u.mul(e);g.isNegative()||g.gt(n);)g=(u=fromNumber(i-=c,this.unsigned)).mul(e);u.isZero()&&(u=h),o=o.add(u),n=n.sub(g)}return o},S.div=S.divide,S.modulo=function modulo(e){return isLong(e)||(e=fromValue(e)),t?fromBits((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},S.mod=S.modulo,S.rem=S.modulo,S.not=function not(){return fromBits(~this.low,~this.high,this.unsigned)},S.and=function and(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)},S.or=function or(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)},S.xor=function xor(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)},S.shiftLeft=function shiftLeft(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function shiftRight(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function shiftRightUnsigned(e){if(isLong(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?fromBits(this.low>>>e|t<<32-e,t>>>e,this.unsigned):fromBits(32===e?t:t>>>e-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function toSigned(){return this.unsigned?fromBits(this.low,this.high,!1):this},S.toUnsigned=function toUnsigned(){return this.unsigned?this:fromBits(this.low,this.high,!0)},S.toBytes=function toBytes(e){return e?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function toBytesLE(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},S.toBytesBE=function toBytesBE(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Long.fromBytes=function fromBytes(e,t,i){return i?Long.fromBytesLE(e,t):Long.fromBytesBE(e,t)},Long.fromBytesLE=function fromBytesLE(e,t){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Long.fromBytesBE=function fromBytesBE(e,t){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},2100:function(e,t,i){"use strict";e.exports=i(9482)},9482:function(e,t,i){"use strict";var n=t;function configure(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=i(1173),n.BufferWriter=i(3155),n.Reader=i(1408),n.BufferReader=i(593),n.util=i(9693),n.rpc=i(5994),n.roots=i(5054),n.configure=configure,configure()},1408:function(e,t,i){"use strict";e.exports=Reader;var n,a=i(9693),o=a.LongBits,s=a.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader(e){this.buf=e,this.pos=0,this.len=e.length}var c="undefined"!=typeof Uint8Array?function create_typed_array(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader(e);throw Error("illegal buffer")}:function create_array(e){if(Array.isArray(e))return new Reader(e);throw Error("illegal buffer")},u=function create(){return a.Buffer?function create_buffer_setup(e){return(Reader.create=function create_buffer(e){return a.Buffer.isBuffer(e)?new n(e):c(e)})(e)}:c};function readLongVarint(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new o(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=u(),Reader.prototype._slice=a.Array.prototype.subarray||a.Array.prototype.slice,Reader.prototype.uint32=function read_uint32_setup(){var e=4294967295;return function read_uint32(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return e}}(),Reader.prototype.int32=function read_int32(){return 0|this.uint32()},Reader.prototype.sint32=function read_sint32(){var e=this.uint32();return e>>>1^-(1&e)|0},Reader.prototype.bool=function read_bool(){return 0!==this.uint32()},Reader.prototype.fixed32=function read_fixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function read_sfixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function read_float(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=a.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader.prototype.double=function read_double(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=a.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader.prototype.bytes=function read_bytes(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)},Reader.prototype.string=function read_string(){var e=this.bytes();return s.read(e,0,e.length)},Reader.prototype.skip=function skip(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader._configure=function(e){n=e,Reader.create=u(),n._configure();var t=a.Long?"toLong":"toNumber";a.merge(Reader.prototype,{int64:function read_int64(){return readLongVarint.call(this)[t](!1)},uint64:function read_uint64(){return readLongVarint.call(this)[t](!0)},sint64:function read_sint64(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function read_fixed64(){return readFixed64.call(this)[t](!0)},sfixed64:function read_sfixed64(){return readFixed64.call(this)[t](!1)}})}},593:function(e,t,i){"use strict";e.exports=BufferReader;var n=i(1408);(BufferReader.prototype=Object.create(n.prototype)).constructor=BufferReader;var a=i(9693);function BufferReader(e){n.call(this,e)}BufferReader._configure=function(){a.Buffer&&(BufferReader.prototype._slice=a.Buffer.prototype.slice)},BufferReader.prototype.string=function read_string_buffer(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},BufferReader._configure()},5054:function(e){"use strict";e.exports={}},5994:function(e,t,i){"use strict";t.Service=i(7948)},7948:function(e,t,i){"use strict";e.exports=Service;var n=i(9693);function Service(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(i)}(Service.prototype=Object.create(n.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function rpcCall(e,t,i,a,o){if(!a)throw TypeError("request must be specified");var s=this;if(!o)return n.asPromise(rpcCall,s,e,t,i,a);if(s.rpcImpl)try{return s.rpcImpl(e,t[s.requestDelimited?"encodeDelimited":"encode"](a).finish(),(function rpcCallback(t,n){if(t)return s.emit("error",t,e),o(t);if(null!==n){if(!(n instanceof i))try{n=i[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(t){return s.emit("error",t,e),o(t)}return s.emit("data",n,e),o(null,n)}s.end(!0)}))}catch(t){return s.emit("error",t,e),void setTimeout((function(){o(t)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},Service.prototype.end=function end(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:function(e,t,i){"use strict";e.exports=LongBits;var n=i(9693);function LongBits(e,t){this.lo=e>>>0,this.hi=t>>>0}var a=LongBits.zero=new LongBits(0,0);a.toNumber=function(){return 0},a.zzEncode=a.zzDecode=function(){return this},a.length=function(){return 1};var o=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function fromNumber(e){if(0===e)return a;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new LongBits(i,n)},LongBits.from=function from(e){if("number"==typeof e)return LongBits.fromNumber(e);if(n.isString(e)){if(!n.Long)return LongBits.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new LongBits(e.low>>>0,e.high>>>0):a},LongBits.prototype.toNumber=function toNumber(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},LongBits.prototype.toLong=function toLong(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;LongBits.fromHash=function fromHash(e){return e===o?a:new LongBits((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},LongBits.prototype.toHash=function toHash(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits.prototype.zzEncode=function zzEncode(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits.prototype.zzDecode=function zzDecode(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits.prototype.length=function length(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}},9693:function(e,t,i){"use strict";var n=t;function merge(e,t,i){for(var n=Object.keys(t),a=0;a<n.length;++a)void 0!==e[n[a]]&&i||(e[n[a]]=t[n[a]]);return e}function newError(e){function CustomError(e,t){if(!(this instanceof CustomError))return new CustomError(e,t);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,CustomError):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),t&&merge(this,t)}return(CustomError.prototype=Object.create(Error.prototype)).constructor=CustomError,Object.defineProperty(CustomError.prototype,"name",{get:function(){return e}}),CustomError.prototype.toString=function toString(){return this.name+": "+this.message},CustomError}n.asPromise=i(4537),n.base64=i(7419),n.EventEmitter=i(9211),n.float=i(945),n.inquire=i(7199),n.utf8=i(4997),n.pool=i(6662),n.LongBits=i(1945),n.isNode=Boolean(void 0!==i.g&&i.g&&i.g.process&&i.g.process.versions&&i.g.process.versions.node),n.global=n.isNode&&i.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function isInteger(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function isString(e){return"string"==typeof e||e instanceof String},n.isObject=function isObject(e){return e&&"object"==typeof e},n.isset=n.isSet=function isSet(e,t){var i=e[t];return!(null==i||!e.hasOwnProperty(t))&&("object"!=typeof i||(Array.isArray(i)?i.length:Object.keys(i).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function newBuffer(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function longToHash(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function longFromHash(e,t){var i=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))},n.merge=merge,n.lcFirst=function lcFirst(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=newError,n.ProtocolError=newError("ProtocolError"),n.oneOfGetter=function getOneOf(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&void 0!==this[e[i]]&&null!==this[e[i]])return e[i]}},n.oneOfSetter=function setOneOf(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function Buffer_from(t,i){return new e(t,i)},n._Buffer_allocUnsafe=e.allocUnsafe||function Buffer_allocUnsafe(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},1173:function(e,t,i){"use strict";e.exports=Writer;var n,a=i(9693),o=a.LongBits,s=a.base64,c=a.utf8;function Op(e,t,i){this.fn=e,this.len=t,this.next=void 0,this.val=i}function noop(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var u=function create(){return a.Buffer?function create_buffer_setup(){return(Writer.create=function create_buffer(){return new n})()}:function create_array(){return new Writer}};function writeByte(e,t,i){t[i]=255&e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function writeFixed32(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}Writer.create=u(),Writer.alloc=function alloc(e){return new a.Array(e)},a.Array!==Array&&(Writer.alloc=a.pool(Writer.alloc,a.Array.prototype.subarray)),Writer.prototype._push=function push(e,t,i){return this.tail=this.tail.next=new Op(e,t,i),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=function writeVarint32(e,t,i){for(;e>127;)t[i++]=127&e|128,e>>>=7;t[i]=e},Writer.prototype.uint32=function write_uint32(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer.prototype.int32=function write_int32(e){return e<0?this._push(writeVarint64,10,o.fromNumber(e)):this.uint32(e)},Writer.prototype.sint32=function write_sint32(e){return this.uint32((e<<1^e>>31)>>>0)},Writer.prototype.uint64=function write_uint64(e){var t=o.from(e);return this._push(writeVarint64,t.length(),t)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function write_sint64(e){var t=o.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer.prototype.bool=function write_bool(e){return this._push(writeByte,1,e?1:0)},Writer.prototype.fixed32=function write_fixed32(e){return this._push(writeFixed32,4,e>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function write_fixed64(e){var t=o.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function write_float(e){return this._push(a.float.writeFloatLE,4,e)},Writer.prototype.double=function write_double(e){return this._push(a.float.writeDoubleLE,8,e)};var l=a.Array.prototype.set?function writeBytes_set(e,t,i){t.set(e,i)}:function writeBytes_for(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};Writer.prototype.bytes=function write_bytes(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(a.isString(e)){var i=Writer.alloc(t=s.length(e));s.decode(e,i,0),e=i}return this.uint32(t)._push(l,t,e)},Writer.prototype.string=function write_string(e){var t=c.length(e);return t?this.uint32(t)._push(c.write,t,e):this._push(writeByte,1,0)},Writer.prototype.fork=function fork(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer.prototype.reset=function reset(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer.prototype.ldelim=function ldelim(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},Writer.prototype.finish=function finish(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},Writer._configure=function(e){n=e,Writer.create=u(),n._configure()}},3155:function(e,t,i){"use strict";e.exports=BufferWriter;var n=i(1173);(BufferWriter.prototype=Object.create(n.prototype)).constructor=BufferWriter;var a=i(9693);function BufferWriter(){n.call(this)}function writeStringBuffer(e,t,i){e.length<40?a.utf8.write(e,t,i):t.utf8Write?t.utf8Write(e,i):t.write(e,i)}BufferWriter._configure=function(){BufferWriter.alloc=a._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=a.Buffer&&a.Buffer.prototype instanceof Uint8Array&&"set"===a.Buffer.prototype.set.name?function writeBytesBuffer_set(e,t,i){t.set(e,i)}:function writeBytesBuffer_copy(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}},BufferWriter.prototype.bytes=function write_bytes_buffer(e){a.isString(e)&&(e=a._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(BufferWriter.writeBytesBuffer,t,e),this},BufferWriter.prototype.string=function write_string_buffer(e){var t=a.Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this},BufferWriter._configure()},7539:function(e){"use strict";const t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const i=t.splitSections(e);return i&&i[0]},t.getMediaSections=function(e){const i=t.splitSections(e);return i.shift(),i},t.matchPrefix=function(e,i){return t.splitLines(e).filter((e=>0===e.indexOf(i)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const i={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let e=8;e<t.length;e+=2)switch(t[e]){case"raddr":i.relatedAddress=t[e+1];break;case"rport":i.relatedPort=parseInt(t[e+1],10);break;case"tcptype":i.tcpType=t[e+1];break;case"ufrag":i.ufrag=t[e+1],i.usernameFragment=t[e+1];break;default:void 0===i[t[e]]&&(i[t[e]]=t[e+1])}return i},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const i=e.component;"rtp"===i?t.push(1):"rtcp"===i?t.push(2):t.push(i),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){let t=e.substr(9).split(" ");const i={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),i.name=t[0],i.clockRate=parseInt(t[1],10),i.channels=3===t.length?parseInt(t[2],10):1,i.numChannels=i.channels,i},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const i=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==i?"/"+i:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){const t={};let i;const n=e.substr(e.indexOf(" ")+1).split(";");for(let e=0;e<n.length;e++)i=n[e].trim().split("="),t[i[0].trim()]=i[1];return t},t.writeFmtp=function(e){let t="",i=e.payloadType;if(void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const n=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+i+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",i=e.payloadType;return void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+i+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),i={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(i.attribute=e.substr(t+1,n-t-1),i.value=e.substr(n+1)):i.attribute=e.substr(t+1),i},t.parseSsrcGroup=function(e){const t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const i=t.matchPrefix(e,"a=mid:")[0];if(i)return i.substr(6)},t.parseFingerprint=function(e){const t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,i){return{role:"auto",fingerprints:t.matchPrefix(e+i,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let i="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{i+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),i},t.parseCryptoLine=function(e){const t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,i){return t.matchPrefix(e+i,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,i){const n=t.matchPrefix(e+i,"a=ice-ufrag:")[0],a=t.matchPrefix(e+i,"a=ice-pwd:")[0];return n&&a?{usernameFragment:n.substr(12),password:a.substr(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" ");for(let a=3;a<n.length;a++){const o=n[a],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){const n=t.parseRtpMap(s),a=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(n.parameters=a.length?t.parseFmtp(a[0]):{},n.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),i.codecs.push(n),n.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(n.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((e=>{i.headerExtensions.push(t.parseExtmap(e))})),i},t.writeRtpDescription=function(e,i){let n="";n+="m="+e+" ",n+=i.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=i.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",i.codecs.forEach((e=>{n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)}));let a=0;return i.codecs.forEach((e=>{e.maxptime>a&&(a=e.maxptime)})),a>0&&(n+="a=maxptime:"+a+"\r\n"),i.headerExtensions&&i.headerExtensions.forEach((e=>{n+=t.writeExtmap(e)})),n},t.parseRtpEncodingParameters=function(e){const i=[],n=t.parseRtpParameters(e),a=-1!==n.fecMechanisms.indexOf("RED"),o=-1!==n.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),c=s.length>0&&s[0].ssrc;let u;const l=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substr(17).split(" ").map((e=>parseInt(e,10)))));l.length>0&&l[0].length>1&&l[0][0]===c&&(u=l[0][1]),n.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&u&&(t.rtx={ssrc:u}),i.push(t),a&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},i.push(t))}})),0===i.length&&c&&i.push({ssrc:c});let p=t.matchPrefix(e,"b=");return p.length&&(p=0===p[0].indexOf("b=TIAS:")?parseInt(p[0].substr(7),10):0===p[0].indexOf("b=AS:")?1e3*parseInt(p[0].substr(5),10)*.95-16e3:void 0,i.forEach((e=>{e.maxBitrate=p}))),i},t.parseRtcpParameters=function(e){const i={},n=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];n&&(i.cname=n.value,i.ssrc=n.ssrc);const a=t.matchPrefix(e,"a=rtcp-rsize");i.reducedSize=a.length>0,i.compound=0===a.length;const o=t.matchPrefix(e,"a=rtcp-mux");return i.mux=o.length>0,i},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let i;const n=t.matchPrefix(e,"a=msid:");if(1===n.length)return i=n[0].substr(7).split(" "),{stream:i[0],track:i[1]};const a=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return a.length>0?(i=a[0].value.split(" "),{stream:i[0],track:i[1]}):void 0},t.parseSctpDescription=function(e){const i=t.parseMLine(e),n=t.matchPrefix(e,"a=max-message-size:");let a;n.length>0&&(a=parseInt(n[0].substr(19),10)),isNaN(a)&&(a=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:i.fmt,maxMessageSize:a};const s=t.matchPrefix(e,"a=sctpmap:");if(s.length>0){const e=s[0].substr(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:a}}},t.writeSctpDescription=function(e,t){let i=[];return i="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&i.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),i.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,i,n){let a;const o=void 0!==i?i:2;a=e||t.generateSessionId();return"v=0\r\no="+(n||"thisisadapterortc")+" "+a+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,i){const n=t.splitLines(e);for(let e=0;e<n.length;e++)switch(n[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[e].substr(2)}return i?t.getDirection(i):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const i=t.splitLines(e)[0].substr(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},t.parseOLine=function(e){const i=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const i=t.splitLines(e);for(let e=0;e<i.length;e++)if(i[e].length<2||"="!==i[e].charAt(1))return!1;return!0},e.exports=t},2938:function(e,t,i){"use strict";function r(e,t,i){var n,a,o;void 0===t&&(t=50),void 0===i&&(i={});var s=null!=(n=i.isImmediate)&&n,c=null!=(a=i.callback)&&a,u=i.maxWait,l=Date.now(),p=[];function f(){if(void 0!==u){var e=Date.now()-l;if(e+t>=u)return u-e}return t}var d=function(){var t=[].slice.call(arguments),i=this;return new Promise((function(n,a){var u=s&&void 0===o;if(void 0!==o&&clearTimeout(o),o=setTimeout((function(){if(o=void 0,l=Date.now(),!s){var n=e.apply(i,t);c&&c(n),p.forEach((function(e){return(0,e.resolve)(n)})),p=[]}}),f()),u){var h=e.apply(i,t);return c&&c(h),n(h)}p.push({resolve:n,reject:a})}))};return d.cancel=function(e){void 0!==o&&clearTimeout(o),p.forEach((function(t){return(0,t.reject)(e)})),p=[]},d}i.r(t),i.d(t,{debounce:function(){return r}})},835:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return v}});var n={};i.r(n),i.d(n,{fixNegotiationNeeded:function(){return fixNegotiationNeeded},shimAddTrackRemoveTrack:function(){return shimAddTrackRemoveTrack},shimAddTrackRemoveTrackWithNative:function(){return shimAddTrackRemoveTrackWithNative},shimGetDisplayMedia:function(){return shimGetDisplayMedia},shimGetSendersWithDtmf:function(){return shimGetSendersWithDtmf},shimGetStats:function(){return shimGetStats},shimGetUserMedia:function(){return shimGetUserMedia},shimMediaStream:function(){return shimMediaStream},shimOnTrack:function(){return shimOnTrack},shimPeerConnection:function(){return shimPeerConnection},shimSenderReceiverGetStats:function(){return shimSenderReceiverGetStats}});var a={};i.r(a),i.d(a,{shimAddTransceiver:function(){return shimAddTransceiver},shimCreateAnswer:function(){return shimCreateAnswer},shimCreateOffer:function(){return shimCreateOffer},shimGetDisplayMedia:function(){return getdisplaymedia_shimGetDisplayMedia},shimGetParameters:function(){return shimGetParameters},shimGetUserMedia:function(){return getusermedia_shimGetUserMedia},shimOnTrack:function(){return firefox_shim_shimOnTrack},shimPeerConnection:function(){return firefox_shim_shimPeerConnection},shimRTCDataChannel:function(){return shimRTCDataChannel},shimReceiverGetStats:function(){return shimReceiverGetStats},shimRemoveStream:function(){return shimRemoveStream},shimSenderGetStats:function(){return shimSenderGetStats}});var o={};i.r(o),i.d(o,{shimAudioContext:function(){return shimAudioContext},shimCallbacksAPI:function(){return shimCallbacksAPI},shimConstraints:function(){return shimConstraints},shimCreateOfferLegacy:function(){return shimCreateOfferLegacy},shimGetUserMedia:function(){return safari_shim_shimGetUserMedia},shimLocalStreamsAPI:function(){return shimLocalStreamsAPI},shimRTCIceServerUrls:function(){return shimRTCIceServerUrls},shimRemoteStreamsAPI:function(){return shimRemoteStreamsAPI},shimTrackEventTransceiver:function(){return shimTrackEventTransceiver}});var s={};i.r(s),i.d(s,{removeExtmapAllowMixed:function(){return removeExtmapAllowMixed},shimAddIceCandidateNullOrEmpty:function(){return shimAddIceCandidateNullOrEmpty},shimConnectionState:function(){return shimConnectionState},shimMaxMessageSize:function(){return shimMaxMessageSize},shimParameterlessSetLocalDescription:function(){return shimParameterlessSetLocalDescription},shimRTCIceCandidate:function(){return shimRTCIceCandidate},shimSendThrowTypeError:function(){return shimSendThrowTypeError}});let c=!0,u=!0;function extractVersion(e,t,i){const n=e.match(t);return n&&n.length>=i&&parseInt(n[i],10)}function wrapPeerConnectionEvent(e,t,i){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype,a=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return a.apply(this,arguments);const wrappedCallback=e=>{const t=i(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,wrappedCallback),a.apply(this,[e,wrappedCallback])};const o=n.removeEventListener;n.removeEventListener=function(e,i){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(i))return o.apply(this,arguments);const n=this._eventMap[t].get(i);return this._eventMap[t].delete(i),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function disableLog(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(c=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function disableWarnings(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(u=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function log(){if("object"==typeof window){if(c)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function deprecated(e,t){u&&console.warn(e+" is deprecated, please use "+t+" instead.")}function isObject(e){return"[object Object]"===Object.prototype.toString.call(e)}function compactObject(e){return isObject(e)?Object.keys(e).reduce((function(t,i){const n=isObject(e[i]),a=n?compactObject(e[i]):e[i],o=n&&!Object.keys(a).length;return void 0===a||o?t:Object.assign(t,{[i]:a})}),{}):e}function walkStats(e,t,i){t&&!i.has(t.id)&&(i.set(t.id,t),Object.keys(t).forEach((n=>{n.endsWith("Id")?walkStats(e,e.get(t[n]),i):n.endsWith("Ids")&&t[n].forEach((t=>{walkStats(e,e.get(t),i)}))})))}function filterStats(e,t,i){const n=i?"outbound-rtp":"inbound-rtp",a=new Map;if(null===t)return a;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((i=>{i.type===n&&i.trackId===t.id&&walkStats(e,i,a)}))})),a}const l=log;function shimGetUserMedia(e,t){const i=e&&e.navigator;if(!i.mediaDevices)return;const constraintsToChrome_=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((i=>{if("require"===i||"advanced"===i||"mediaSource"===i)return;const n="object"==typeof e[i]?e[i]:{ideal:e[i]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);const oldname_=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];let e={};"number"==typeof n.ideal?(e[oldname_("min",i)]=n.ideal,t.optional.push(e),e={},e[oldname_("max",i)]=n.ideal,t.optional.push(e)):(e[oldname_("",i)]=n.ideal,t.optional.push(e))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[oldname_("",i)]=n.exact):["min","max"].forEach((e=>{void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[oldname_(e,i)]=n[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},shimConstraints_=function(e,n){if(t.version>=61)return n(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const remap=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])};remap((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),remap(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=constraintsToChrome_(e.audio)}if(e&&"object"==typeof e.video){let a=e.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});const o=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!i.mediaDevices.getSupportedConstraints||!i.mediaDevices.getSupportedConstraints().facingMode||o)){let t;if(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?t=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(t=["front"]),t)return i.mediaDevices.enumerateDevices().then((i=>{let o=(i=i.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!o&&i.length&&t.includes("back")&&(o=i[i.length-1]),o&&(e.video.deviceId=a.exact?{exact:o.deviceId}:{ideal:o.deviceId}),e.video=constraintsToChrome_(e.video),l("chrome: "+JSON.stringify(e)),n(e)}))}e.video=constraintsToChrome_(e.video)}return l("chrome: "+JSON.stringify(e)),n(e)},shimError_=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(i.getUserMedia=function(e,t,n){shimConstraints_(e,(e=>{i.webkitGetUserMedia(e,t,(e=>{n&&n(shimError_(e))}))}))}.bind(i),i.mediaDevices.getUserMedia){const e=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(t){return shimConstraints_(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(shimError_(e))))))}}}function shimGetDisplayMedia(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function getDisplayMedia(i){return t(i).then((t=>{const n=i.video&&i.video.width,a=i.video&&i.video.height,o=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(i.video.mandatory.maxWidth=n),a&&(i.video.mandatory.maxHeight=a),e.navigator.mediaDevices.getUserMedia(i)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function shimMediaStream(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function shimOnTrack(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(i=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===i.track.id)):{track:i.track};const a=new Event("track");a.track=i.track,a.receiver=n,a.transceiver={receiver:n},a.streams=[t.stream],this.dispatchEvent(a)})),t.stream.getTracks().forEach((i=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===i.id)):{track:i};const a=new Event("track");a.track=i,a.receiver=n,a.transceiver={receiver:n},a.streams=[t.stream],this.dispatchEvent(a)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else wrapPeerConnectionEvent(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function shimGetSendersWithDtmf(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const shimSenderWithDtmf=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function getSenders(){return this._senders=this._senders||[],this._senders.slice()};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function addTrack(e,i){let n=t.apply(this,arguments);return n||(n=shimSenderWithDtmf(this,e),this._senders.push(n)),n};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function removeTrack(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const t=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function addStream(e){this._senders=this._senders||[],t.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(shimSenderWithDtmf(this,e))}))};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function removeStream(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function getSenders(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function shimGetStats(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function getStats(){const[e,i,n]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const fixChromeStats_=function(e){const t={};return e.result().forEach((e=>{const i={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{i[t]=e.stat(t)})),t[i.id]=i})),t},makeMapStats=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const successCallbackWrapper_=function(e){i(makeMapStats(fixChromeStats_(e)))};return t.apply(this,[successCallbackWrapper_,e])}return new Promise(((e,i)=>{t.apply(this,[function(t){e(makeMapStats(fixChromeStats_(t)))},i])})).then(i,n)}}function shimSenderReceiverGetStats(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function getSenders(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function addTrack(){const e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function getStats(){const e=this;return this._pc.getStats().then((t=>filterStats(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function getReceivers(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),wrapPeerConnectionEvent(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function getStats(){const e=this;return this._pc.getStats().then((t=>filterStats(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function getStats(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,i,n;return this.getSenders().forEach((i=>{i.track===e&&(t?n=!0:t=i)})),this.getReceivers().forEach((t=>(t.track===e&&(i?n=!0:i=t),t.track===e))),n||t&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function shimAddTrackRemoveTrackWithNative(e){e.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function addTrack(e,i){if(!i)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const n=t.apply(this,arguments);return this._shimmedLocalStreams[i.id]?-1===this._shimmedLocalStreams[i.id].indexOf(n)&&this._shimmedLocalStreams[i.id].push(n):this._shimmedLocalStreams[i.id]=[i,n],n};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function addStream(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();i.apply(this,arguments);const n=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(n)};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function removeStream(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};const a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function removeTrack(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const i=this._shimmedLocalStreams[t].indexOf(e);-1!==i&&this._shimmedLocalStreams[t].splice(i,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),a.apply(this,arguments)}}function shimAddTrackRemoveTrack(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return shimAddTrackRemoveTrackWithNative(e);const i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){const e=i.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function addStream(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}n.apply(this,[t])};const a=e.RTCPeerConnection.prototype.removeStream;function replaceInternalStreamId(e,t){let i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],a=e._streams[n.id];i=i.replace(new RegExp(a.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:i})}function replaceExternalStreamId(e,t){let i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],a=e._streams[n.id];i=i.replace(new RegExp(n.id,"g"),a.id)})),new RTCSessionDescription({type:t.type,sdp:i})}e.RTCPeerConnection.prototype.removeStream=function removeStream(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function addTrack(t,i){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const a=this.getSenders().find((e=>e.track===t));if(a)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[i.id];if(o)o.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const n=new e.MediaStream([t]);this._streams[i.id]=n,this._reverseStreams[n.id]=i,this.addStream(n)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?i.apply(this,[t=>{const i=replaceInternalStreamId(this,t);e[0].apply(null,[i])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):i.apply(this,arguments).then((e=>replaceInternalStreamId(this,e)))}};e.RTCPeerConnection.prototype[t]=n[t]}));const o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function setLocalDescription(){return arguments.length&&arguments[0].type?(arguments[0]=replaceExternalStreamId(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:replaceInternalStreamId(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function removeTrack(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((i=>{this._streams[i].getTracks().find((t=>e.track===t))&&(t=this._streams[i])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function shimPeerConnection(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}))}function fixNegotiationNeeded(e,t){wrapPeerConnectionEvent(e,"negotiationneeded",(e=>{const i=e.target;if(!(t.version<72||i.getConfiguration&&"plan-b"===i.getConfiguration().sdpSemantics)||"stable"===i.signalingState)return e}))}function getusermedia_shimGetUserMedia(e,t){const i=e&&e.navigator,n=e&&e.MediaStreamTrack;if(i.getUserMedia=function(e,t,n){deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const remap=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])},e=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(t){return"object"==typeof t&&"object"==typeof t.audio&&(t=JSON.parse(JSON.stringify(t)),remap(t.audio,"autoGainControl","mozAutoGainControl"),remap(t.audio,"noiseSuppression","mozNoiseSuppression")),e(t)},n&&n.prototype.getSettings){const e=n.prototype.getSettings;n.prototype.getSettings=function(){const t=e.apply(this,arguments);return remap(t,"mozAutoGainControl","autoGainControl"),remap(t,"mozNoiseSuppression","noiseSuppression"),t}}if(n&&n.prototype.applyConstraints){const e=n.prototype.applyConstraints;n.prototype.applyConstraints=function(t){return"audio"===this.kind&&"object"==typeof t&&(t=JSON.parse(JSON.stringify(t)),remap(t,"autoGainControl","mozAutoGainControl"),remap(t,"noiseSuppression","mozNoiseSuppression")),e.apply(this,[t])}}}}function getdisplaymedia_shimGetDisplayMedia(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function getDisplayMedia(i){if(!i||!i.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===i.video?i.video={mediaSource:t}:i.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(i)})}function firefox_shim_shimOnTrack(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function firefox_shim_shimPeerConnection(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}));const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function getStats(){const[e,a,o]=arguments;return n.apply(this,[e||null]).then((e=>{if(t.version<53&&!a)try{e.forEach((e=>{e.type=i[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,n)=>{e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(a,o)}}function shimSenderGetStats(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function getSenders(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function addTrack(){const e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function getStats(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function shimReceiverGetStats(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function getReceivers(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),wrapPeerConnectionEvent(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function getStats(){return this._pc.getStats(this.track)}}function shimRemoveStream(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function removeStream(e){deprecated("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function shimRTCDataChannel(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function shimAddTransceiver(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function addTransceiver(){this.setParametersPromises=[];const e=arguments[1],i=e&&"sendEncodings"in e;i&&e.sendEncodings.forEach((e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const n=t.apply(this,arguments);if(i){const{sender:t}=n,i=t.getParameters();(!("encodings"in i)||1===i.encodings.length&&0===Object.keys(i.encodings[0]).length)&&(i.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(i).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return n})}function shimGetParameters(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function getParameters(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function shimCreateOffer(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function createOffer(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function shimCreateAnswer(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function createAnswer(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function shimLocalStreamsAPI(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function addStream(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((i=>t.call(this,i,e))),e.getVideoTracks().forEach((i=>t.call(this,i,e)))},e.RTCPeerConnection.prototype.addTrack=function addTrack(e,...i){return i&&i.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function removeStream(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const i=e.getTracks();this.getSenders().forEach((e=>{i.includes(e.track)&&this.removeTrack(e)}))})}}function shimRemoteStreamsAPI(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function getRemoteStreams(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const i=new Event("addstream");i.stream=t,e.dispatchEvent(i)}))}),t.apply(e,arguments)}}}function shimCallbacksAPI(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,i=t.createOffer,n=t.createAnswer,a=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function createOffer(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],a=i.apply(this,[n]);return t?(a.then(e,t),Promise.resolve()):a},t.createAnswer=function createAnswer(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],a=n.apply(this,[i]);return t?(a.then(e,t),Promise.resolve()):a};let withCallback=function(e,t,i){const n=a.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n};t.setLocalDescription=withCallback,withCallback=function(e,t,i){const n=o.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.setRemoteDescription=withCallback,withCallback=function(e,t,i){const n=s.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.addIceCandidate=withCallback}function safari_shim_shimGetUserMedia(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,i=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>i(shimConstraints(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function getUserMedia(e,i,n){t.mediaDevices.getUserMedia(e).then(i,n)}.bind(t))}function shimConstraints(e){return e&&void 0!==e.video?Object.assign({},e,{video:compactObject(e.video)}):e}function shimRTCIceServerUrls(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function RTCPeerConnection(e,i){if(e&&e.iceServers){const t=[];for(let i=0;i<e.iceServers.length;i++){let n=e.iceServers[i];!n.hasOwnProperty("urls")&&n.hasOwnProperty("url")?(deprecated("RTCIceServer.url","RTCIceServer.urls"),n=JSON.parse(JSON.stringify(n)),n.urls=n.url,delete n.url,t.push(n)):t.push(e.iceServers[i])}e.iceServers=t}return new t(e,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function shimTrackEventTransceiver(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimCreateOfferLegacy(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function createOffer(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const i=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function shimAudioContext(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var p=i(7539),h=i.n(p);function shimRTCIceCandidate(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function RTCIceCandidate(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const i=new t(e),n=h().parseCandidate(e.candidate),a=Object.assign(i,n);return a.toJSON=function toJSON(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,wrapPeerConnectionEvent(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function shimMaxMessageSize(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const sctpInDescription=function(e){if(!e||!e.sdp)return!1;const t=h().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=h().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},getRemoteFirefoxVersion=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const i=parseInt(t[1],10);return i!=i?-1:i},getCanSendMaxMessageSize=function(e){let i=65536;return"firefox"===t.browser&&(i=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),i},getMaxMessageSize=function(e,i){let n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);const a=h().matchPrefix(e.sdp,"a=max-message-size:");return a.length>0?n=parseInt(a[0].substr(19),10):"firefox"===t.browser&&-1!==i&&(n=2147483637),n},i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(sctpInDescription(arguments[0])){const e=getRemoteFirefoxVersion(arguments[0]),t=getCanSendMaxMessageSize(e),i=getMaxMessageSize(arguments[0],e);let n;n=0===t&&0===i?Number.POSITIVE_INFINITY:0===t||0===i?Math.max(t,i):Math.min(t,i);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>n}),this._sctp=a}return i.apply(this,arguments)}}function shimSendThrowTypeError(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function wrapDcSend(e,t){const i=e.send;e.send=function send(){const n=arguments[0],a=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&a>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return i.apply(e,arguments)}}const t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function createDataChannel(){const e=t.apply(this,arguments);return wrapDcSend(e,this),e},wrapPeerConnectionEvent(e,"datachannel",(e=>(wrapDcSend(e.channel,e.target),e)))}function shimConnectionState(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const i=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const i=new Event("connectionstatechange",e);t.dispatchEvent(i)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}}))}function removeExtmapAllowMixed(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const i=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:i}):t.sdp=i}return i.apply(this,arguments)}}function shimAddIceCandidateNullOrEmpty(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const i=e.RTCPeerConnection.prototype.addIceCandidate;i&&0!==i.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function addIceCandidate(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function shimParameterlessSetLocalDescription(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const i=e.RTCPeerConnection.prototype.setLocalDescription;i&&0!==i.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function setLocalDescription(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return i.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}if(e.sdp||"offer"!==e.type&&"answer"!==e.type)return i.apply(this,[e]);const t="offer"===e.type?this.createOffer:this.createAnswer;return t.apply(this).then((e=>i.apply(this,[e])))})}const m=function adapterFactory({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const i=log,c=function detectBrowser(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:i}=e;if(i.mozGetUserMedia)t.browser="firefox",t.version=extractVersion(i.userAgent,/Firefox\/(\d+)\./,1);else if(i.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=extractVersion(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!i.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=extractVersion(i.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),u={browserDetails:c,commonShim:s,extractVersion:extractVersion,disableLog:disableLog,disableWarnings:disableWarnings,sdp:p};switch(c.browser){case"chrome":if(!n||!shimPeerConnection||!t.shimChrome)return i("Chrome shim is not included in this adapter release."),u;if(null===c.version)return i("Chrome shim can not determine version, not shimming."),u;i("adapter.js shimming chrome."),u.browserShim=n,shimAddIceCandidateNullOrEmpty(e,c),shimParameterlessSetLocalDescription(e),shimGetUserMedia(e,c),shimMediaStream(e),shimPeerConnection(e,c),shimOnTrack(e),shimAddTrackRemoveTrack(e,c),shimGetSendersWithDtmf(e),shimGetStats(e),shimSenderReceiverGetStats(e),fixNegotiationNeeded(e,c),shimRTCIceCandidate(e),shimConnectionState(e),shimMaxMessageSize(e,c),shimSendThrowTypeError(e),removeExtmapAllowMixed(e,c);break;case"firefox":if(!a||!firefox_shim_shimPeerConnection||!t.shimFirefox)return i("Firefox shim is not included in this adapter release."),u;i("adapter.js shimming firefox."),u.browserShim=a,shimAddIceCandidateNullOrEmpty(e,c),shimParameterlessSetLocalDescription(e),getusermedia_shimGetUserMedia(e,c),firefox_shim_shimPeerConnection(e,c),firefox_shim_shimOnTrack(e),shimRemoveStream(e),shimSenderGetStats(e),shimReceiverGetStats(e),shimRTCDataChannel(e),shimAddTransceiver(e),shimGetParameters(e),shimCreateOffer(e),shimCreateAnswer(e),shimRTCIceCandidate(e),shimConnectionState(e),shimMaxMessageSize(e,c),shimSendThrowTypeError(e);break;case"safari":if(!o||!t.shimSafari)return i("Safari shim is not included in this adapter release."),u;i("adapter.js shimming safari."),u.browserShim=o,shimAddIceCandidateNullOrEmpty(e,c),shimParameterlessSetLocalDescription(e),shimRTCIceServerUrls(e),shimCreateOfferLegacy(e),shimCallbacksAPI(e),shimLocalStreamsAPI(e),shimRemoteStreamsAPI(e),shimTrackEventTransceiver(e),safari_shim_shimGetUserMedia(e),shimAudioContext(e),shimRTCIceCandidate(e),shimMaxMessageSize(e,c),shimSendThrowTypeError(e),removeExtmapAllowMixed(e,c);break;default:i("Unsupported browser!")}return u}({window:"undefined"==typeof window?void 0:window});var v=m}},__webpack_module_cache__={},deferred;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=function(e,t,i,n){if(!t){var a=1/0;for(u=0;u<deferred.length;u++){t=deferred[u][0],i=deferred[u][1],n=deferred[u][2];for(var o=!0,s=0;s<t.length;s++)(!1&n||a>=n)&&Object.keys(__webpack_require__.O).every((function(e){return __webpack_require__.O[e](t[s])}))?t.splice(s--,1):(o=!1,n<a&&(a=n));if(o){deferred.splice(u--,1);var c=i();void 0!==c&&(e=c)}}return e}n=n||0;for(var u=deferred.length;u>0&&deferred[u-1][2]>n;u--)deferred[u]=deferred[u-1];deferred[u]=[t,i,n]},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e={588:0};__webpack_require__.O.j=function(t){return 0===e[t]};var webpackJsonpCallback=function(t,i){var n,a,o=i[0],s=i[1],c=i[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(n in s)__webpack_require__.o(s,n)&&(__webpack_require__.m[n]=s[n]);if(c)var l=c(__webpack_require__)}for(t&&t(i);u<o.length;u++)a=o[u],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return __webpack_require__.O(l)},t=this.webpackChunk_name_=this.webpackChunk_name_||[];t.forEach(webpackJsonpCallback.bind(null,0)),t.push=webpackJsonpCallback.bind(null,t.push.bind(t))}();var __webpack_exports__=__webpack_require__(8219);__webpack_exports__=__webpack_require__.O(__webpack_exports__),window.livekit=__webpack_exports__})();